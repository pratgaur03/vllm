INFO 07-09 12:42:31 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=40.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='chunked_prefill-qps-40-input-len-512-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=512, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I\'ll try to break it down and provide some insights.\n\n**Observations:**\n\n1. **Mixed programming languages**: The text contains code snippets and keywords from various programming languages, including Java, Python, C++, and JavaScript.\n2. **Domain-specific terminology**: There are terms and phrases related to specific domains, such as:\n\t* Finance (e.g., "UMAN_PAYMENT", "stock extractor")\n\t* Computer science (e.g., "DataLoader", "GPIO", "Parcelable")\n\t* Biology (e.g., "lipid", "protein")\n\t* Geography (e.g., "Latitude", "Longitude")\n\t* Marketing (e.g., "shaders", "marketing standings")\n3. **Code snippets and frameworks**: The text includes code snippets and references to various frameworks and libraries, such as:\n\t* Android development (e.g., "OnClickListener", "Parcelable")\n\t* Web development (e.g., "Redux", "React")\n\t* Data science (e.g., "Pandas", " NumPy")\n4. **Error messages and warnings**: There are some error messages', success=True, latency=3.610787277109921, output_tokens=256, ttft=0.09854748006910086, itl=[3.6990735679864883e-05, 0.013639212120324373, 0.013566846959292889, 0.013686745893210173, 0.013669823296368122, 0.013722328934818506, 0.01372052589431405, 0.013777771033346653, 0.013790049124509096, 0.013600554782897234, 0.013766377232968807, 0.013692888896912336, 0.013797517865896225, 0.013588408008217812, 0.013813178054988384, 0.0137412678450346, 0.013656480237841606, 0.01374974474310875, 0.013642991427332163, 0.013821728993207216, 0.013515690807253122, 0.013790266122668982, 0.013749081641435623, 0.013847056310623884, 0.01372598297894001, 0.013693564105778933, 0.013645806815475225, 0.013737256173044443, 0.013941688928753138, 0.013420459814369678, 0.01365660596638918, 0.013841754291206598, 0.01366810780018568, 0.013696074951440096, 0.013718937058001757, 0.013680284842848778, 0.013823441229760647, 0.013726782985031605, 0.014144340064376593, 0.01358807971701026, 0.01376075204461813, 0.013739623129367828, 0.013719404116272926, 0.014014070853590965, 0.013641300145536661, 0.013718683738261461, 0.013699494302272797, 0.013698281720280647, 0.013753490056842566, 0.013752250000834465, 0.013839860912412405, 0.013681283220648766, 0.01373627781867981, 0.01383137609809637, 0.013778711203485727, 0.013654433656483889, 0.013871608301997185, 0.013693203683942556, 0.013913327362388372, 0.014192965812981129, 0.01379795977845788, 0.013738565146923065, 0.013677642215043306, 0.013746385928243399, 0.013848401140421629, 0.013852343894541264, 0.013688018079847097, 0.013775283005088568, 0.013860194012522697, 0.013689013663679361, 0.013724757358431816, 0.013725615572184324, 0.013809739146381617, 0.013740207068622112, 0.01375779090449214, 0.013854723889380693, 0.01397597324103117, 0.013625619001686573, 0.013676465023308992, 0.014019704889506102, 0.013573206961154938, 0.013794075231999159, 0.01375686563551426, 0.013784392271190882, 0.013844307977706194, 0.013655564747750759, 0.013703805394470692, 0.013773020822554827, 0.013834184966981411, 0.013830787967890501, 0.013737943023443222, 0.01374613307416439, 0.01378520717844367, 0.01364603079855442, 0.013878643047064543, 0.013721040915697813, 0.013841181993484497, 0.013746337965130806, 0.01381031097844243, 0.013666184153407812, 0.013701248914003372, 0.013816297054290771, 0.013748342171311378, 0.013798019848763943, 0.013825689908117056, 0.013719561975449324, 0.013756966218352318, 0.013749090023338795, 0.01374190766364336, 0.013793373014777899, 0.013718638103455305, 0.013772240839898586, 0.013797702267765999, 0.013674399815499783, 0.013742783106863499, 0.013901769183576107, 0.013696350622922182, 0.013717698398977518, 0.013817280996590853, 0.013818299863487482, 0.013753665145486593, 0.013732971623539925, 0.013701401185244322, 0.013815150130540133, 0.013806373812258244, 0.013796658255159855, 0.013816974591463804, 0.013711833395063877, 0.013865243643522263, 0.013772337231785059, 0.014000663068145514, 0.013379777781665325, 0.01382075296714902, 0.013717043213546276, 0.013628548011183739, 0.013844603672623634, 0.013692755252122879, 0.013732013758271933, 0.013949749059975147, 0.013786503113806248, 0.013750610873103142, 0.01376824826002121, 0.013777121901512146, 0.01372787682339549, 0.013732875231653452, 0.013943038880825043, 0.013799114152789116, 0.01381165673956275, 0.013719859067350626, 0.013833489269018173, 0.013744208961725235, 0.013740784954279661, 0.013840817846357822, 0.01377945626154542, 0.013849180657416582, 0.013841554056853056, 0.013757388107478619, 0.013842486776411533, 0.01375124929472804, 0.013755148742347956, 0.013828185386955738, 0.013794287573546171, 0.013875590171664953, 0.013630703091621399, 0.013753979001194239, 0.013723297975957394, 0.013831559102982283, 0.013825963716953993, 0.013753251172602177, 0.013748782221227884, 0.013820568565279245, 0.013794232159852982, 0.013784253038465977, 0.013739487156271935, 0.013835022691637278, 0.01374493120238185, 0.01375609589740634, 0.01377784414216876, 0.013911307789385319, 0.013654941227287054, 0.013720943126827478, 0.014093134552240372, 0.013636669144034386, 0.014193558134138584, 0.01375427097082138, 0.01380503410473466, 0.013752571772783995, 0.013976796995848417, 0.013744524214416742, 0.013667135033756495, 0.013798136729747057, 0.013768130913376808, 0.013762664049863815, 0.013795063365250826, 0.01374026294797659, 0.013606398832052946, 0.013949908781796694, 0.013721989002078772, 0.013787186238914728, 0.013732874765992165, 0.013685531448572874, 0.013810121919959784, 0.013756589964032173, 0.013883513864129782, 0.013742004986852407, 0.013733615167438984, 0.013875271659344435, 0.013713843189179897, 0.013709623832255602, 0.013825156260281801, 0.013820230029523373, 0.013816436752676964, 0.013873997144401073, 0.01372678205370903, 0.013728193007409573, 0.013711987063288689, 0.013720148708671331, 0.013754030223935843, 0.013964557088911533, 0.013604027684777975, 0.014086203183978796, 0.01374533399939537, 0.013798049185425043, 0.013884715735912323, 0.01365840807557106, 0.013820058200508356, 0.013769292738288641, 0.013795709237456322, 0.013787257950752974, 0.013924818020313978, 0.013647808693349361, 0.01371820829808712, 0.014047147706151009, 0.013774627353996038, 0.013810458593070507, 0.013838142156600952, 0.013743606861680746, 0.013776982203125954, 0.013781867921352386, 0.013958574272692204, 0.013861334882676601, 0.013699816074222326, 0.013725456781685352, 0.01369103416800499, 0.013830244075506926, 0.013756414875388145, 0.013647541869431734, 0.01386175025254488, 0.01379346800968051, 0.013842616695910692, 0.013791854958981276, 0.013851282186806202, 0.013721989002078772, 0.013693211134523153, 0.013810032978653908, 0.01434021582826972], tpot=0.0, prompt_len=512, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 40.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  52.78     
Total input tokens:                      524288    
Total generated tokens:                  231335    
Request throughput (req/s):              19.40     
Output token throughput (tok/s):         4383.06   
Total Token throughput (tok/s):          14316.63  
---------------Time to First Token----------------
Mean TTFT (ms):                          6595.89   
Median TTFT (ms):                        2438.80   
P99 TTFT (ms):                           15100.23  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          94.48     
Median TPOT (ms):                        103.31    
P99 TPOT (ms):                           181.69    
---------------Inter-token Latency----------------
Mean ITL (ms):                           91.57     
Median ITL (ms):                         51.02     
P99 ITL (ms):                            211.85    
==================================================
