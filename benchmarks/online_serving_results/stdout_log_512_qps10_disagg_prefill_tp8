INFO 07-10 01:27:11 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=10.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-10-input-len-512-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=512, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and contexts. I'll try to break it down and provide some insights.\n\n**Observations:**\n\n1. **Mixed languages**: The text contains code snippets and keywords from multiple programming languages, including Java, Python, C++, and JavaScript.\n2. **Technical terms**: There are many technical terms and concepts mentioned, such as machine learning, data loading, GPIO, sensors, and more.\n3. **Company and product names**: Some company and product names are mentioned, like Volvo, Xiaomi, and macOS.\n4. **Geographic locations**: Several geographic locations are mentioned, including Brazil, Omaha, and Prague.\n5. **Random words and phrases**: The text also contains random words and phrases that don't seem to be related to any specific topic or context.\n\n**Possible explanations:**\n\n1. **Code dump**: It's possible that someone has dumped a large amount of code and text into a single block, without any organization or context.\n2. **Automated text generation**: The text might have been generated automatically using a tool or algorithm that combines different sources of text and code.\n3. **Error or glitch**:", success=True, latency=4.935205509886146, output_tokens=256, ttft=4.932570039760321, itl=[6.640609353780746e-05, 4.216190427541733e-05, 1.4896038919687271e-05, 1.1480879038572311e-05, 1.0394025593996048e-05, 1.0671094059944153e-05, 9.97120514512062e-06, 9.990762919187546e-06, 9.614042937755585e-06, 9.600073099136353e-06, 9.804964065551758e-06, 9.81893390417099e-06, 9.811948984861374e-06, 9.539071470499039e-06, 9.555835276842117e-06, 9.523238986730576e-06, 9.453855454921722e-06, 1.0083895176649094e-05, 9.929295629262924e-06, 1.0279007256031036e-05, 9.628012776374817e-06, 9.454786777496338e-06, 1.0333023965358734e-05, 1.006806269288063e-05, 9.679235517978668e-06, 1.0453630238771439e-05, 9.768176823854446e-06, 9.799841791391373e-06, 9.797979146242142e-06, 9.718351066112518e-06, 1.0725576430559158e-05, 8.069444447755814e-06, 9.321607649326324e-06, 1.0541174560785294e-05, 9.460840374231339e-06, 9.457115083932877e-06, 9.458046406507492e-06, 1.4098826795816422e-05, 9.502284228801727e-06, 9.306706488132477e-06, 9.173993021249771e-06, 1.0180287063121796e-05, 9.350012987852097e-06, 9.22568142414093e-06, 9.59029421210289e-06, 9.024981409311295e-06, 1.0038726031780243e-05, 9.481329470872879e-06, 9.476672857999802e-06, 9.306240826845169e-06, 9.54512506723404e-06, 1.0109972208738327e-05, 9.278766810894012e-06, 1.0319985449314117e-05, 9.435229003429413e-06, 9.488780051469803e-06, 9.852927178144455e-06, 9.580980986356735e-06, 9.362120181322098e-06, 1.0535120964050293e-05, 9.526964277029037e-06, 1.0387971997261047e-05, 9.472016245126724e-06, 9.33278352022171e-06, 9.753275662660599e-06, 1.0021030902862549e-05, 1.0571908205747604e-05, 1.0061077773571014e-05, 9.374693036079407e-06, 9.6932053565979e-06, 9.43988561630249e-06, 9.456183761358261e-06, 9.479932487010956e-06, 1.0774005204439163e-05, 9.487848728895187e-06, 9.396113455295563e-06, 9.331852197647095e-06, 1.1187978088855743e-05, 1.007039099931717e-05, 9.567942470312119e-06, 9.449664503335953e-06, 9.76119190454483e-06, 9.599141776561737e-06, 1.032976433634758e-05, 9.540002793073654e-06, 1.0093208402395248e-05, 9.499024599790573e-06, 9.377952665090561e-06, 1.0422896593809128e-05, 9.490177035331726e-06, 9.622890502214432e-06, 9.655021131038666e-06, 9.743031114339828e-06, 1.1458061635494232e-05, 1.0727904736995697e-05, 1.0002870112657547e-05, 9.17026773095131e-06, 9.473878890275955e-06, 9.730923920869827e-06, 9.342096745967865e-06, 9.366776794195175e-06, 9.389128535985947e-06, 9.881798177957535e-06, 9.523238986730576e-06, 9.33092087507248e-06, 9.64989885687828e-06, 1.0126270353794098e-05, 9.324867278337479e-06, 9.469222277402878e-06, 1.2123025953769684e-05, 9.754672646522522e-06, 9.512994438409805e-06, 9.384937584400177e-06, 9.431038051843643e-06, 9.40496101975441e-06, 9.682029485702515e-06, 9.440351277589798e-06, 9.940005838871002e-06, 9.350012987852097e-06, 9.689945727586746e-06, 9.795650839805603e-06, 9.514391422271729e-06, 9.567011147737503e-06, 9.441748261451721e-06, 1.041823998093605e-05, 9.334646165370941e-06, 9.395182132720947e-06, 9.484123438596725e-06, 9.26479697227478e-06, 1.3947021216154099e-05, 9.843148291110992e-06, 9.567942470312119e-06, 9.279698133468628e-06, 1.6532372683286667e-05, 9.901821613311768e-06, 9.74489375948906e-06, 9.485986083745956e-06, 9.387265890836716e-06, 9.404029697179794e-06, 9.63965430855751e-06, 9.332317858934402e-06, 1.0565854609012604e-05, 1.0746065527200699e-05, 9.345822036266327e-06, 9.59029421210289e-06, 1.0635703802108765e-05, 9.700190275907516e-06, 1.0381918400526047e-05, 9.459909051656723e-06, 1.1927913874387741e-05, 1.0579358786344528e-05, 9.709037840366364e-06, 9.446870535612106e-06, 9.43988561630249e-06, 9.633135050535202e-06, 9.362120181322098e-06, 9.415671229362488e-06, 9.59029421210289e-06, 9.547919034957886e-06, 1.040799543261528e-05, 9.50787216424942e-06, 9.558163583278656e-06, 9.40077006816864e-06, 1.0384246706962585e-05, 9.193085134029388e-06, 9.319745004177094e-06, 9.733252227306366e-06, 9.363982826471329e-06, 1.0813586413860321e-05, 9.410083293914795e-06, 9.472016245126724e-06, 1.0634306818246841e-05, 9.84175130724907e-06, 1.1991243809461594e-05, 9.730923920869827e-06, 9.434763342142105e-06, 9.34302806854248e-06, 9.404029697179794e-06, 1.0704156011343002e-05, 9.560026228427887e-06, 9.515788406133652e-06, 1.1008232831954956e-05, 9.465962648391724e-06, 9.37189906835556e-06, 1.0239891707897186e-05, 1.0235235095024109e-05, 9.618699550628662e-06, 1.0291114449501038e-05, 9.368173778057098e-06, 9.778887033462524e-06, 9.33697447180748e-06, 9.40496101975441e-06, 1.1428259313106537e-05, 9.386800229549408e-06, 9.443145245313644e-06, 9.331852197647095e-06, 1.057889312505722e-05, 9.641051292419434e-06, 9.47713851928711e-06, 1.0087154805660248e-05, 9.50787216424942e-06, 1.1358875781297684e-05, 1.0988209396600723e-05, 9.653624147176743e-06, 9.403098374605179e-06, 1.0384246706962585e-05, 9.399838745594025e-06, 9.329989552497864e-06, 9.528826922178268e-06, 1.0582152754068375e-05, 9.752810001373291e-06, 9.37003642320633e-06, 1.0219402611255646e-05, 1.0203570127487183e-05, 9.476207196712494e-06, 1.0357238352298737e-05, 9.583774954080582e-06, 1.048203557729721e-05, 9.663868695497513e-06, 9.45432111620903e-06, 9.929761290550232e-06, 1.0292977094650269e-05, 9.416136890649796e-06, 9.442679584026337e-06, 9.607989341020584e-06, 9.230338037014008e-06, 1.0625924915075302e-05, 9.685754776000977e-06, 1.0335352271795273e-05, 9.515788406133652e-06, 9.472016245126724e-06, 9.324867278337479e-06, 9.471084922552109e-06, 1.1733267456293106e-05, 1.1509750038385391e-05, 1.0365154594182968e-05, 9.616836905479431e-06, 9.321141988039017e-06, 9.228009730577469e-06, 1.1424999684095383e-05, 9.603798389434814e-06, 9.78400930762291e-06, 9.620096534490585e-06, 1.1535827070474625e-05, 9.52230766415596e-06, 9.465962648391724e-06, 1.1384021490812302e-05, 9.495764970779419e-06, 9.384006261825562e-06, 9.492039680480957e-06, 9.692274034023285e-06, 1.0794959962368011e-05, 9.616836905479431e-06, 9.44826751947403e-06, 9.413808584213257e-06, 1.1052936315536499e-05], tpot=0.0, prompt_len=512, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 10.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     929       
Benchmark duration (s):                  109.01    
Total input tokens:                      475648    
Total generated tokens:                  148085    
Request throughput (req/s):              8.52      
Output token throughput (tok/s):         1358.48   
Total Token throughput (tok/s):          5721.92   
---------------Time to First Token----------------
Mean TTFT (ms):                          23626.49  
Median TTFT (ms):                        28819.70  
P99 TTFT (ms):                           33117.75  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
