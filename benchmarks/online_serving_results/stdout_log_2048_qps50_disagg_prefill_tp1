INFO 07-08 00:28:07 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=100, logprobs=None, request_rate=50.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-50-input-len-2048-tp-1.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=2048, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large amount of text that seems to be a mix of code snippets, error messages, and random text. I\'ll do my best to help you make sense of it.\n\n**Code Snippets:**\n\nThe text contains snippets of code in various programming languages, including:\n\n1. Java: There are several Java code snippets, including Android-related code, Java Servlet code, and JavaFX code.\n2. Python: There are a few Python code snippets, including some related to machine learning and data science.\n3. C++: There is a small C++ code snippet.\n4. JavaScript: There are some JavaScript code snippets, including some related to web development.\n\n**Error Messages:**\n\nThe text also contains several error messages, including:\n\n1. Java errors: There are several Java error messages, including "java.lang.NullPointerException" and "java.lang.ClassNotFoundException".\n2. Python errors: There is a Python error message "TypeError: \'NoneType\' object is not iterable".\n3. C++ errors: There is a C++ error message "undefined reference to `std::cout\'".\n\n**Random Text:**\n\nThe text also contains a large amount of random text, including:\n\n1. Names: There are several names mentioned, including "', success=True, latency=7.610948167275637, output_tokens=256, ttft=7.609583239071071, itl=[4.486227408051491e-05, 1.5584751963615417e-05, 9.221024811267853e-06, 6.266869604587555e-06, 5.412381142377853e-06, 5.685724318027496e-06, 5.452893674373627e-06, 4.975125193595886e-06, 4.943925887346268e-06, 4.9602240324020386e-06, 4.975125193595886e-06, 4.91878017783165e-06, 5.077105015516281e-06, 4.860106855630875e-06, 5.012843757867813e-06, 5.1781535148620605e-06, 4.966743290424347e-06, 5.1069073379039764e-06, 4.958361387252808e-06, 4.9066729843616486e-06, 4.942063242197037e-06, 5.294103175401688e-06, 4.956964403390884e-06, 4.895031452178955e-06, 5.077105015516281e-06, 5.276873707771301e-06, 5.024950951337814e-06, 4.766974598169327e-06, 5.0961971282958984e-06, 4.971865564584732e-06, 5.587004125118256e-06, 5.2209943532943726e-06, 4.9960799515247345e-06, 5.407724529504776e-06, 4.961155354976654e-06, 5.0798989832401276e-06, 4.682224243879318e-06, 4.79305163025856e-06, 4.882924258708954e-06, 4.7818757593631744e-06, 4.854053258895874e-06, 5.912035703659058e-06, 4.825182259082794e-06, 4.909001290798187e-06, 4.958827048540115e-06, 4.9211084842681885e-06, 5.082692950963974e-06, 5.131121724843979e-06, 4.82192263007164e-06, 4.796311259269714e-06, 4.910863935947418e-06, 5.1800161600112915e-06, 4.976056516170502e-06, 5.335081368684769e-06, 4.84660267829895e-06, 5.229376256465912e-06, 5.486886948347092e-06, 5.470123142004013e-06, 5.0049275159835815e-06, 5.148816853761673e-06, 5.024019628763199e-06, 4.749279469251633e-06, 4.800967872142792e-06, 4.8889778554439545e-06, 4.919711500406265e-06, 5.17209991812706e-06, 4.859175533056259e-06, 5.102716386318207e-06, 5.058012902736664e-06, 5.217269062995911e-06, 4.915054887533188e-06, 4.887580871582031e-06, 5.111098289489746e-06, 4.938337951898575e-06, 4.862900823354721e-06, 4.8317015171051025e-06, 4.87128272652626e-06, 5.045905709266663e-06, 5.039852112531662e-06, 4.704110324382782e-06, 4.904810339212418e-06, 5.1460228860378265e-06, 4.8209913074970245e-06, 4.869420081377029e-06, 4.761852324008942e-06, 5.368143320083618e-06, 4.8335641622543335e-06, 4.8782676458358765e-06, 4.874076694250107e-06, 4.696659743785858e-06, 5.185138434171677e-06, 4.798173904418945e-06, 4.9960799515247345e-06, 6.259884685277939e-06, 5.959998816251755e-06, 4.659872502088547e-06, 4.818197339773178e-06, 5.570705980062485e-06, 4.9853697419166565e-06, 4.7655776143074036e-06, 4.982110112905502e-06, 5.042180418968201e-06, 4.935078322887421e-06, 5.88688999414444e-06, 4.842877388000488e-06, 4.99701127409935e-06, 5.5050477385520935e-06, 5.077105015516281e-06, 4.949979484081268e-06, 5.952082574367523e-06, 4.967674612998962e-06, 4.702247679233551e-06, 4.81773167848587e-06, 4.9602240324020386e-06, 4.75812703371048e-06, 4.7497451305389404e-06, 4.649162292480469e-06, 5.470123142004013e-06, 4.98676672577858e-06, 4.851259291172028e-06, 4.987698048353195e-06, 5.648937076330185e-06, 4.8442743718624115e-06, 5.037989467382431e-06, 4.868023097515106e-06, 4.7977082431316376e-06, 5.348119884729385e-06, 4.970002919435501e-06, 4.96814027428627e-06, 5.691777914762497e-06, 4.986301064491272e-06, 5.063600838184357e-06, 5.5301934480667114e-06, 6.511807441711426e-06, 4.975125193595886e-06, 4.7762878239154816e-06, 5.522742867469788e-06, 5.145091563463211e-06, 5.108769983053207e-06, 4.895031452178955e-06, 4.807952791452408e-06, 4.883389919996262e-06, 5.134847015142441e-06, 4.8889778554439545e-06, 4.99282032251358e-06, 4.777219146490097e-06, 4.807952791452408e-06, 4.805158823728561e-06, 5.498062819242477e-06, 6.285961717367172e-06, 4.79305163025856e-06, 5.076639354228973e-06, 5.146954208612442e-06, 5.885027348995209e-06, 7.482245564460754e-06, 5.065929144620895e-06, 4.86103817820549e-06, 4.807021468877792e-06, 5.81890344619751e-06, 5.112960934638977e-06, 4.9122609198093414e-06, 4.967674612998962e-06, 5.531124770641327e-06, 5.086883902549744e-06, 4.8102810978889465e-06, 4.903879016637802e-06, 4.875939339399338e-06, 5.71180135011673e-06, 4.965346306562424e-06, 4.858709871768951e-06, 4.852190613746643e-06, 4.877801984548569e-06, 5.498062819242477e-06, 6.302259862422943e-06, 5.136709660291672e-06, 4.963018000125885e-06, 4.936940968036652e-06, 4.761386662721634e-06, 4.8317015171051025e-06, 5.302019417285919e-06, 5.125068128108978e-06, 6.576068699359894e-06, 4.759058356285095e-06, 4.720874130725861e-06, 4.869885742664337e-06, 5.0049275159835815e-06, 4.830304533243179e-06, 4.8656947910785675e-06, 5.091074854135513e-06, 5.9069134294986725e-06, 4.918314516544342e-06, 5.242880433797836e-06, 5.0710514187812805e-06, 5.010049790143967e-06, 4.858709871768951e-06, 4.97838482260704e-06, 4.7227367758750916e-06, 4.738103598356247e-06, 4.934147000312805e-06, 4.963018000125885e-06, 5.470588803291321e-06, 5.5283308029174805e-06, 5.013775080442429e-06, 5.660112947225571e-06, 4.98676672577858e-06, 4.9192458391189575e-06, 4.904810339212418e-06, 4.688277840614319e-06, 4.8871152102947235e-06, 4.919711500406265e-06, 5.16185536980629e-06, 4.7050416469573975e-06, 4.667323082685471e-06, 4.862900823354721e-06, 4.753004759550095e-06, 4.793982952833176e-06, 4.9620866775512695e-06, 5.033798515796661e-06, 6.183050572872162e-06, 5.767215043306351e-06, 5.0407834351062775e-06, 4.833098500967026e-06, 4.75393608212471e-06, 4.923902451992035e-06, 4.923902451992035e-06, 5.258247256278992e-06, 5.323905497789383e-06, 4.815869033336639e-06, 4.999339580535889e-06, 5.475711077451706e-06, 4.804227501153946e-06, 4.776753485202789e-06, 4.9532391130924225e-06, 5.769077688455582e-06, 6.430782377719879e-06, 5.052890628576279e-06, 4.873145371675491e-06, 5.218200385570526e-06, 4.887580871582031e-06, 4.759058356285095e-06, 5.6140124797821045e-06, 4.954170435667038e-06, 4.956033080816269e-06, 5.049165338277817e-06, 5.170702934265137e-06, 4.932284355163574e-06, 4.8335641622543335e-06, 4.973262548446655e-06, 5.058944225311279e-06, 4.8959627747535706e-06, 4.985835403203964e-06, 5.487352609634399e-06, 4.950910806655884e-06, 5.2871182560920715e-06, 4.848930984735489e-06, 5.54276630282402e-06], tpot=0.0, prompt_len=2048, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 50.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     100       
Benchmark duration (s):                  10.84     
Total input tokens:                      204800    
Total generated tokens:                  0         
Request throughput (req/s):              9.22      
Output token throughput (tok/s):         0.00      
Total Token throughput (tok/s):          18888.16  
---------------Time to First Token----------------
Mean TTFT (ms):                          963.03    
Median TTFT (ms):                        0.00      
P99 TTFT (ms):                           10813.47  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.00      
Median TPOT (ms):                        0.00      
P99 TPOT (ms):                           0.00      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.01      
P99 ITL (ms):                            0.02      
==================================================
