INFO 07-07 21:02:59 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=100, logprobs=None, request_rate=5.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-5-input-len-128-tp-1.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=128, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a jumbled collection of words and phrases, possibly from a technical or programming context. I'll try to break it down and provide some insights:\n\n1. **Newsletter waiter inquire**: This phrase seems out of place among the other technical terms. It's possible that it's a misplaced or unrelated phrase.\n2. **__togIENTATION companyId Basics**: This appears to be a variable or function name, possibly related to a programming project. The `__` prefix suggests it might be a private or internal variable.\n3. **macOS Mats_tel-prefix mutate**: This phrase seems to be related to macOS and possibly a mutation or transformation of some kind. The `Mats_tel-prefix` part is unclear, but it might be a custom prefix or namespace.\n4. **DataLoader.GPIO Levy sneakers crédawnerxia/simpleCHR**: This line appears to be a mix of unrelated terms. `DataLoader` might be a class or function related to data loading, while `GPIO` is a term commonly used in electronics and robotics. `Levy sneakers` seems out of place, and `crédawnerxia/simpleCHR` is unclear.\n5. **flotation.sensorBrazil Seasons Speak-ball Mutationukkan Omaha’on Cuomo Judicial checkpoints**: This phrase is a jumbled", success=True, latency=7.116660994943231, output_tokens=256, ttft=7.115269124973565, itl=[4.081381484866142e-05, 1.6200821846723557e-05, 9.763054549694061e-06, 8.098315447568893e-06, 6.521586328744888e-06, 6.316229701042175e-06, 6.1141327023506165e-06, 5.6480057537555695e-06, 5.183741450309753e-06, 5.782116204500198e-06, 5.433801561594009e-06, 5.230307579040527e-06, 5.302019417285919e-06, 4.9639493227005005e-06, 5.055684596300125e-06, 5.4934062063694e-06, 5.121808499097824e-06, 5.505979061126709e-06, 5.141831934452057e-06, 5.216337740421295e-06, 5.046837031841278e-06, 4.970002919435501e-06, 4.920177161693573e-06, 5.058944225311279e-06, 4.956964403390884e-06, 4.923902451992035e-06, 4.862900823354721e-06, 4.891306161880493e-06, 5.150679498910904e-06, 4.777219146490097e-06, 5.411915481090546e-06, 5.154870450496674e-06, 4.840083420276642e-06, 5.336944013834e-06, 4.974193871021271e-06, 5.493871867656708e-06, 4.831235855817795e-06, 4.708766937255859e-06, 4.976987838745117e-06, 4.909001290798187e-06, 4.829838871955872e-06, 5.2424147725105286e-06, 4.92902472615242e-06, 4.789792001247406e-06, 4.92483377456665e-06, 4.716217517852783e-06, 4.902016371488571e-06, 4.837755113840103e-06, 4.83216717839241e-06, 4.886183887720108e-06, 4.789792001247406e-06, 4.808884114027023e-06, 5.023088306188583e-06, 5.225185304880142e-06, 4.864763468503952e-06, 4.6798959374427795e-06, 4.915986210107803e-06, 4.903413355350494e-06, 4.943925887346268e-06, 5.445908755064011e-06, 4.759058356285095e-06, 4.7157518565654755e-06, 4.90434467792511e-06, 4.827976226806641e-06, 4.791654646396637e-06, 5.130190402269363e-06, 4.970002919435501e-06, 4.7869980335235596e-06, 4.787929356098175e-06, 4.656147211790085e-06, 4.525762051343918e-06, 4.785135388374329e-06, 5.672220140695572e-06, 4.956033080816269e-06, 4.851724952459335e-06, 4.724133759737015e-06, 4.910863935947418e-06, 5.565118044614792e-06, 4.945788532495499e-06, 5.1781535148620605e-06, 4.911795258522034e-06, 9.24430787563324e-06, 4.783738404512405e-06, 5.270354449748993e-06, 4.828907549381256e-06, 4.7567300498485565e-06, 5.346257239580154e-06, 4.759058356285095e-06, 5.521811544895172e-06, 4.7031790018081665e-06, 4.99701127409935e-06, 4.9639493227005005e-06, 5.13298436999321e-06, 5.732756108045578e-06, 5.06499782204628e-06, 5.0361268222332e-06, 5.16790896654129e-06, 5.919951945543289e-06, 4.8461370170116425e-06, 4.786066710948944e-06, 5.565118044614792e-06, 5.078967660665512e-06, 4.809815436601639e-06, 4.862900823354721e-06, 4.8442743718624115e-06, 4.896894097328186e-06, 5.223788321018219e-06, 5.260109901428223e-06, 4.839152097702026e-06, 5.725771188735962e-06, 5.173962563276291e-06, 4.819128662347794e-06, 6.299931555986404e-06, 4.875939339399338e-06, 4.704110324382782e-06, 5.329027771949768e-06, 4.922039806842804e-06, 4.689209163188934e-06, 4.6407803893089294e-06, 4.868954420089722e-06, 4.888046532869339e-06, 4.725996404886246e-06, 5.170237272977829e-06, 5.388632416725159e-06, 4.829373210668564e-06, 5.965586751699448e-06, 5.130190402269363e-06, 5.110166966915131e-06, 4.830770194530487e-06, 5.891080945730209e-06, 2.3072119802236557e-05, 5.868729203939438e-06, 5.375128239393234e-06, 5.085952579975128e-06, 4.976056516170502e-06, 4.881992936134338e-06, 5.005858838558197e-06, 4.698056727647781e-06, 4.816334694623947e-06, 4.78280708193779e-06, 4.841014742851257e-06, 5.053821951150894e-06, 4.766043275594711e-06, 4.732981324195862e-06, 4.860106855630875e-06, 5.208887159824371e-06, 4.90015372633934e-06, 4.687812179327011e-06, 4.7371722757816315e-06, 6.1639584600925446e-06, 5.5800192058086395e-06, 4.882924258708954e-06, 4.698988050222397e-06, 5.313195288181305e-06, 4.942063242197037e-06, 4.707835614681244e-06, 5.174893885850906e-06, 4.964880645275116e-06, 4.902016371488571e-06, 4.720408469438553e-06, 4.71901148557663e-06, 5.4389238357543945e-06, 4.959758371114731e-06, 4.723202437162399e-06, 6.784684956073761e-06, 8.055008947849274e-06, 5.330424755811691e-06, 5.364883691072464e-06, 4.99701127409935e-06, 4.779081791639328e-06, 4.755798727273941e-06, 4.6570785343647e-06, 4.741828888654709e-06, 5.398876965045929e-06, 5.837995558977127e-06, 4.893168807029724e-06, 4.775822162628174e-06, 4.789326339960098e-06, 4.769768565893173e-06, 5.341134965419769e-06, 4.794914275407791e-06, 4.906207323074341e-06, 4.9336813390254974e-06, 4.838220775127411e-06, 4.791188985109329e-06, 4.862900823354721e-06, 5.88688999414444e-06, 4.934147000312805e-06, 4.9299560487270355e-06, 4.787929356098175e-06, 5.1711685955524445e-06, 5.129724740982056e-06, 4.881992936134338e-06, 5.043111741542816e-06, 4.835892468690872e-06, 5.2480027079582214e-06, 5.012843757867813e-06, 4.794448614120483e-06, 4.813540726900101e-06, 4.70038503408432e-06, 4.888046532869339e-06, 5.165580660104752e-06, 4.976056516170502e-06, 4.730187356472015e-06, 5.105976015329361e-06, 4.8121437430381775e-06, 4.773959517478943e-06, 4.789792001247406e-06, 4.873145371675491e-06, 5.4067932069301605e-06, 5.000270903110504e-06, 4.834029823541641e-06, 4.644040018320084e-06, 4.635658115148544e-06, 5.7462602853775024e-06, 4.8568472266197205e-06, 4.88990917801857e-06, 4.7693029046058655e-06, 4.9979425966739655e-06, 5.005858838558197e-06, 5.144160240888596e-06, 4.891771823167801e-06, 4.857312887907028e-06, 5.900859832763672e-06, 6.143003702163696e-06, 4.8461370170116425e-06, 4.664994776248932e-06, 5.217734724283218e-06, 4.868023097515106e-06, 4.824250936508179e-06, 4.7460198402404785e-06, 6.273854523897171e-06, 5.152076482772827e-06, 4.987698048353195e-06, 4.9853697419166565e-06, 4.847999662160873e-06, 4.740897566080093e-06, 5.535781383514404e-06, 4.930887371301651e-06, 4.601199179887772e-06, 6.091780960559845e-06, 4.9532391130924225e-06, 4.773028194904327e-06, 4.902947694063187e-06, 4.877801984548569e-06, 7.4873678386211395e-06, 1.1650845408439636e-05, 5.815178155899048e-06, 5.3998082876205444e-06, 5.087815225124359e-06, 5.136243999004364e-06, 4.735775291919708e-06, 4.8102810978889465e-06, 5.02169132232666e-06, 4.9280934035778046e-06, 6.474088877439499e-06], tpot=0.0, prompt_len=128, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 5.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     34        
Benchmark duration (s):                  968.31    
Total input tokens:                      4352      
Total generated tokens:                  7396      
Request throughput (req/s):              0.04      
Output token throughput (tok/s):         7.64      
Total Token throughput (tok/s):          12.13     
---------------Time to First Token----------------
Mean TTFT (ms):                          9064.39   
Median TTFT (ms):                        10461.61  
P99 TTFT (ms):                           11434.40  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
