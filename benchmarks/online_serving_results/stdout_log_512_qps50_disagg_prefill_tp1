INFO 07-08 01:18:27 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=100, logprobs=None, request_rate=50.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-50-input-len-512-tp-1.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=512, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I\'ll try to break it down and provide some insights.\n\n**Observations:**\n\n1. **Mixed languages**: The text contains code snippets and keywords from multiple programming languages, including Java, Python, C++, and JavaScript.\n2. **Domain-specific terminology**: There are terms and phrases related to various domains, such as:\n\t* Finance (e.g., "UMAN_PAYMENT", "stock", "trading")\n\t* Technology (e.g., "GPIO", "SENSOR_BUSY", "Parcelable")\n\t* Science (e.g., "flotation", "sensor", "mutation")\n\t* Geography (e.g., "Omaha", "Brazil", "Prague")\n3. **Code fragments**: The text includes short code snippets, such as method calls, variable declarations, and data structures (e.g., "ArrayList", "KeyValuePair").\n4. **Error messages and warnings**: There are some error messages and warnings, like "NotFound", "Debugger", and "Cleanup.structureÎº".\n\n**Possible explanations:**\n\n1. **Code dump**: This text might be a result of a code dump or a paste', success=True, latency=8.94332759687677, output_tokens=256, ttft=8.941964760888368, itl=[4.472117871046066e-05, 1.631956547498703e-05, 9.758397936820984e-06, 6.6999346017837524e-06, 5.787704139947891e-06, 5.90737909078598e-06, 5.259644240140915e-06, 5.197245627641678e-06, 4.991888999938965e-06, 5.078036338090897e-06, 5.044043064117432e-06, 4.976987838745117e-06, 5.0067901611328125e-06, 4.9299560487270355e-06, 4.903413355350494e-06, 4.917848855257034e-06, 4.876870661973953e-06, 5.275942385196686e-06, 5.217269062995911e-06, 4.950910806655884e-06, 4.773959517478943e-06, 4.760921001434326e-06, 5.144160240888596e-06, 4.909932613372803e-06, 4.828907549381256e-06, 5.227047950029373e-06, 4.767905920743942e-06, 5.067326128482819e-06, 4.99701127409935e-06, 5.1138922572135925e-06, 5.8389268815517426e-06, 5.173962563276291e-06, 4.8871152102947235e-06, 5.339737981557846e-06, 4.70038503408432e-06, 4.7888606786727905e-06, 4.735775291919708e-06, 4.845205694437027e-06, 4.7441571950912476e-06, 4.78280708193779e-06, 4.720874130725861e-06, 5.187001079320908e-06, 4.7869980335235596e-06, 4.805158823728561e-06, 4.7869980335235596e-06, 4.761852324008942e-06, 5.8710575103759766e-06, 4.896894097328186e-06, 4.9280934035778046e-06, 4.634261131286621e-06, 4.860572516918182e-06, 5.024019628763199e-06, 4.759989678859711e-06, 5.2531249821186066e-06, 4.71901148557663e-06, 4.753004759550095e-06, 4.969071596860886e-06, 4.847999662160873e-06, 4.904810339212418e-06, 5.381181836128235e-06, 4.731118679046631e-06, 4.874076694250107e-06, 4.963018000125885e-06, 4.75393608212471e-06, 5.085952579975128e-06, 5.203764885663986e-06, 5.262903869152069e-06, 4.837289452552795e-06, 4.9211084842681885e-06, 4.980713129043579e-06, 4.934147000312805e-06, 5.070120096206665e-06, 4.956964403390884e-06, 4.9727968871593475e-06, 4.819128662347794e-06, 4.728790372610092e-06, 4.785135388374329e-06, 5.606096237897873e-06, 5.2461400628089905e-06, 4.95370477437973e-06, 4.72506508231163e-06, 4.827044904232025e-06, 4.698056727647781e-06, 5.160924047231674e-06, 4.873145371675491e-06, 5.272682756185532e-06, 4.834961146116257e-06, 5.153007805347443e-06, 4.681292921304703e-06, 4.949979484081268e-06, 4.943925887346268e-06, 4.719942808151245e-06, 5.084089934825897e-06, 6.213784217834473e-06, 5.359295755624771e-06, 5.437992513179779e-06, 4.79305163025856e-06, 4.854053258895874e-06, 5.143694579601288e-06, 4.936940968036652e-06, 4.99701127409935e-06, 4.980247467756271e-06, 4.95370477437973e-06, 4.89410012960434e-06, 4.862900823354721e-06, 4.795379936695099e-06, 4.919711500406265e-06, 5.003064870834351e-06, 4.732981324195862e-06, 6.610993295907974e-06, 5.194917321205139e-06, 4.755333065986633e-06, 4.766974598169327e-06, 6.039626896381378e-06, 4.862435162067413e-06, 4.815869033336639e-06, 4.654750227928162e-06, 4.924368113279343e-06, 4.892703145742416e-06, 4.827976226806641e-06, 5.624257028102875e-06, 5.268026143312454e-06, 4.8656947910785675e-06, 5.245208740234375e-06, 4.987698048353195e-06, 4.811212420463562e-06, 4.709232598543167e-06, 4.773959517478943e-06, 5.034729838371277e-06, 6.731133908033371e-06, 5.182810127735138e-06, 4.8549845814704895e-06, 4.884321242570877e-06, 6.081070750951767e-06, 5.187932401895523e-06, 4.801899194717407e-06, 4.780944436788559e-06, 5.125999450683594e-06, 4.882924258708954e-06, 4.7138892114162445e-06, 5.003064870834351e-06, 4.7693029046058655e-06, 4.8978254199028015e-06, 4.726927727460861e-06, 5.914829671382904e-06, 4.837289452552795e-06, 4.6510249376297e-06, 4.719942808151245e-06, 4.684086889028549e-06, 6.205867975950241e-06, 5.098059773445129e-06, 4.979781806468964e-06, 4.8959627747535706e-06, 4.860106855630875e-06, 4.920177161693573e-06, 4.573725163936615e-06, 4.860106855630875e-06, 4.7869980335235596e-06, 4.750210791826248e-06, 5.095731467008591e-06, 4.8531219363212585e-06, 4.670117050409317e-06, 4.9639493227005005e-06, 4.741828888654709e-06, 4.716217517852783e-06, 5.057081580162048e-06, 4.900619387626648e-06, 4.586298018693924e-06, 4.82611358165741e-06, 4.771631211042404e-06, 4.89410012960434e-06, 4.784204065799713e-06, 5.344860255718231e-06, 5.919951945543289e-06, 5.045905709266663e-06, 5.301088094711304e-06, 4.913192242383957e-06, 4.682689905166626e-06, 5.268026143312454e-06, 4.949979484081268e-06, 4.69014048576355e-06, 4.736240953207016e-06, 4.655681550502777e-06, 4.79724258184433e-06, 5.207955837249756e-06, 4.82611358165741e-06, 4.8317015171051025e-06, 4.629138857126236e-06, 4.809815436601639e-06, 5.271285772323608e-06, 5.134847015142441e-06, 4.800036549568176e-06, 4.719942808151245e-06, 4.982110112905502e-06, 4.6459026634693146e-06, 4.841946065425873e-06, 4.8102810978889465e-06, 4.881992936134338e-06, 4.7888606786727905e-06, 9.702984243631363e-06, 5.06080687046051e-06, 7.34301283955574e-06, 5.0640664994716644e-06, 5.227979272603989e-06, 4.597008228302002e-06, 4.910863935947418e-06, 4.711095243692398e-06, 4.677101969718933e-06, 5.526002496480942e-06, 4.956964403390884e-06, 5.316920578479767e-06, 4.90434467792511e-06, 4.721805453300476e-06, 4.61796298623085e-06, 5.186069756746292e-06, 4.6817585825920105e-06, 4.698988050222397e-06, 4.730187356472015e-06, 4.698988050222397e-06, 4.644040018320084e-06, 5.61913475394249e-06, 4.930887371301651e-06, 4.636123776435852e-06, 4.990957677364349e-06, 5.244743078947067e-06, 4.712957888841629e-06, 4.798173904418945e-06, 4.631001502275467e-06, 4.7050416469573975e-06, 4.686880856752396e-06, 8.008908480405807e-06, 1.2767966836690903e-05, 6.7213550209999084e-06, 6.091780960559845e-06, 5.407258868217468e-06, 5.659647285938263e-06, 5.410052835941315e-06, 5.145091563463211e-06, 4.9872323870658875e-06, 4.769768565893173e-06, 4.765111953020096e-06, 4.796776920557022e-06, 4.866160452365875e-06, 5.1157549023628235e-06, 4.667323082685471e-06, 4.883855581283569e-06, 4.752073436975479e-06, 4.861969500780106e-06, 4.875008016824722e-06, 4.769768565893173e-06, 5.21121546626091e-06, 4.930887371301651e-06, 4.875008016824722e-06, 5.091074854135513e-06, 4.990026354789734e-06, 6.556045264005661e-06], tpot=0.0, prompt_len=512, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 50.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     100       
Benchmark duration (s):                  61.14     
Total input tokens:                      51200     
Total generated tokens:                  21548     
Request throughput (req/s):              1.64      
Output token throughput (tok/s):         352.45    
Total Token throughput (tok/s):          1189.89   
---------------Time to First Token----------------
Mean TTFT (ms):                          48170.89  
Median TTFT (ms):                        49771.37  
P99 TTFT (ms):                           59089.45  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
