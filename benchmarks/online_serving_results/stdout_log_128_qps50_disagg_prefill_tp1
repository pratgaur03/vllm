INFO 07-08 01:16:11 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=100, logprobs=None, request_rate=50.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-50-input-len-128-tp-1.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=128, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a jumbled collection of words and phrases, possibly from a technical or programming context. I'll try to break it down and provide some insights:\n\n1. **Newsletter waiter inquire**: This phrase seems out of place among the other technical terms. It's possible that it's a misplaced or unrelated phrase.\n2. **__togIENTATION companyId Basics**: This appears to be a variable or function name, possibly related to a programming project. The `__` prefix suggests it might be a private or internal variable.\n3. **macOS Mats_tel-prefix mutate**: This phrase seems to be related to macOS and possibly a mutation or transformation of some kind. The `Mats_tel-prefix` part is unclear, but it might be a custom prefix or namespace.\n4. **DataLoader.GPIO Levy sneakers crédawnerxia/simpleCHR**: This phrase appears to be a mix of technical terms:\n\t* `DataLoader` might be a class or function related to data loading.\n\t* `GPIO` (General Purpose Input/Output) is a term commonly used in electronics and programming.\n\t* `Levy` is unclear, but it might be a surname or a term related to a specific project.\n\t* `crédawnerxia` seems to be a", success=True, latency=8.927544217091054, output_tokens=256, ttft=8.926175876054913, itl=[4.680361598730087e-05, 1.653609797358513e-05, 1.0362360626459122e-05, 7.1516260504722595e-06, 6.258022040128708e-06, 6.8461522459983826e-06, 5.510170012712479e-06, 5.2480027079582214e-06, 4.878733307123184e-06, 5.275942385196686e-06, 5.089212208986282e-06, 4.915986210107803e-06, 5.217734724283218e-06, 4.824250936508179e-06, 4.923902451992035e-06, 5.51808625459671e-06, 5.138106644153595e-06, 5.187001079320908e-06, 4.92483377456665e-06, 4.9229711294174194e-06, 4.915986210107803e-06, 5.00120222568512e-06, 4.944857209920883e-06, 4.976987838745117e-06, 4.99701127409935e-06, 5.255918949842453e-06, 4.749279469251633e-06, 4.784669727087021e-06, 5.166977643966675e-06, 4.911329597234726e-06, 5.271751433610916e-06, 5.02588227391243e-06, 4.710163921117783e-06, 5.4319389164447784e-06, 4.860106855630875e-06, 5.492940545082092e-06, 5.018897354602814e-06, 4.837289452552795e-06, 4.841946065425873e-06, 4.78280708193779e-06, 4.93926927447319e-06, 5.326699465513229e-06, 4.969071596860886e-06, 4.752073436975479e-06, 4.915986210107803e-06, 4.792120307683945e-06, 4.950910806655884e-06, 4.834961146116257e-06, 4.852190613746643e-06, 4.769768565893173e-06, 4.9578957259655e-06, 4.6282075345516205e-06, 4.909932613372803e-06, 5.219131708145142e-06, 4.7567300498485565e-06, 4.931353032588959e-06, 4.937872290611267e-06, 4.916917532682419e-06, 4.717148840427399e-06, 5.364883691072464e-06, 4.818197339773178e-06, 4.631001502275467e-06, 5.230773240327835e-06, 4.766974598169327e-06, 4.652887582778931e-06, 5.525071173906326e-06, 4.8102810978889465e-06, 4.949979484081268e-06, 4.902016371488571e-06, 5.0156377255916595e-06, 4.673376679420471e-06, 4.869885742664337e-06, 5.1390379667282104e-06, 4.768837243318558e-06, 4.785135388374329e-06, 4.71482053399086e-06, 5.642883479595184e-06, 5.545094609260559e-06, 4.751142114400864e-06, 5.0067901611328125e-06, 4.7460198402404785e-06, 4.655215889215469e-06, 4.769768565893173e-06, 5.00120222568512e-06, 4.978850483894348e-06, 4.8461370170116425e-06, 5.180947482585907e-06, 4.811212420463562e-06, 5.248934030532837e-06, 4.737637937068939e-06, 4.7674402594566345e-06, 4.91458922624588e-06, 5.076173692941666e-06, 5.931127816438675e-06, 5.108769983053207e-06, 4.935078322887421e-06, 5.09386882185936e-06, 6.013084203004837e-06, 4.947185516357422e-06, 4.932750016450882e-06, 5.492940545082092e-06, 5.04637137055397e-06, 4.746951162815094e-06, 4.7869980335235596e-06, 4.869885742664337e-06, 4.733912646770477e-06, 5.369074642658234e-06, 5.296897143125534e-06, 4.644040018320084e-06, 5.998183041810989e-06, 4.973728209733963e-06, 4.782341420650482e-06, 5.663838237524033e-06, 4.836823791265488e-06, 5.286186933517456e-06, 5.6889839470386505e-06, 5.0691887736320496e-06, 4.845671355724335e-06, 4.830304533243179e-06, 4.770699888467789e-06, 4.804227501153946e-06, 4.75812703371048e-06, 1.4177989214658737e-05, 5.641952157020569e-06, 4.85079362988472e-06, 5.723908543586731e-06, 4.940200597047806e-06, 4.9979425966739655e-06, 5.1157549023628235e-06, 6.1783939599990845e-06, 4.9336813390254974e-06, 6.000977009534836e-06, 5.348119884729385e-06, 5.071982741355896e-06, 5.015172064304352e-06, 4.8638321459293365e-06, 4.79305163025856e-06, 4.618894308805466e-06, 4.950910806655884e-06, 4.839152097702026e-06, 4.706904292106628e-06, 5.116220563650131e-06, 4.805158823728561e-06, 4.601664841175079e-06, 4.843343049287796e-06, 5.325768142938614e-06, 4.9602240324020386e-06, 4.577916115522385e-06, 4.734843969345093e-06, 5.7551078498363495e-06, 5.871988832950592e-06, 4.943925887346268e-06, 4.698056727647781e-06, 5.296897143125534e-06, 4.785135388374329e-06, 4.777684807777405e-06, 5.0193630158901215e-06, 4.966743290424347e-06, 4.774890840053558e-06, 4.7674402594566345e-06, 4.739966243505478e-06, 5.141831934452057e-06, 4.798173904418945e-06, 4.673842340707779e-06, 6.215181201696396e-06, 7.948838174343109e-06, 5.078036338090897e-06, 4.827976226806641e-06, 4.736706614494324e-06, 4.718080163002014e-06, 4.687346518039703e-06, 5.327630788087845e-06, 4.610046744346619e-06, 6.290152668952942e-06, 5.088746547698975e-06, 4.709232598543167e-06, 4.591885954141617e-06, 4.725996404886246e-06, 6.176996976137161e-06, 4.731118679046631e-06, 5.442183464765549e-06, 4.917848855257034e-06, 5.3620897233486176e-06, 4.855915904045105e-06, 4.667788743972778e-06, 4.736240953207016e-06, 5.776062607765198e-06, 4.760921001434326e-06, 4.688743501901627e-06, 4.627276211977005e-06, 4.769768565893173e-06, 5.320180207490921e-06, 5.043111741542816e-06, 4.628673195838928e-06, 4.799105226993561e-06, 4.752073436975479e-06, 4.5727938413619995e-06, 4.8782676458358765e-06, 4.810746759176254e-06, 4.809349775314331e-06, 4.720874130725861e-06, 4.951842129230499e-06, 4.752073436975479e-06, 4.727859050035477e-06, 4.652421921491623e-06, 4.659872502088547e-06, 4.8978254199028015e-06, 4.766043275594711e-06, 4.806090146303177e-06, 5.057081580162048e-06, 5.069654434919357e-06, 4.713423550128937e-06, 4.656612873077393e-06, 4.600267857313156e-06, 5.743000656366348e-06, 4.9727968871593475e-06, 4.687346518039703e-06, 5.475711077451706e-06, 4.792120307683945e-06, 5.044043064117432e-06, 5.2978284657001495e-06, 4.849862307310104e-06, 4.773028194904327e-06, 4.849396646022797e-06, 4.64683398604393e-06, 5.412846803665161e-06, 4.683155566453934e-06, 4.674773663282394e-06, 4.705972969532013e-06, 4.909001290798187e-06, 5.643349140882492e-06, 4.767905920743942e-06, 4.699919372797012e-06, 4.69619408249855e-06, 6.400980055332184e-06, 4.882924258708954e-06, 4.755798727273941e-06, 4.72506508231163e-06, 5.115289241075516e-06, 4.904810339212418e-06, 4.767905920743942e-06, 4.779081791639328e-06, 5.532056093215942e-06, 4.884786903858185e-06, 4.950910806655884e-06, 4.839152097702026e-06, 4.722271114587784e-06, 4.802830517292023e-06, 5.057081580162048e-06, 5.980953574180603e-06, 8.602160960435867e-06, 6.279908120632172e-06, 5.127862095832825e-06, 4.8568472266197205e-06, 4.749279469251633e-06, 5.492009222507477e-06], tpot=0.0, prompt_len=128, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 50.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     100       
Benchmark duration (s):                  39.01     
Total input tokens:                      12800     
Total generated tokens:                  23705     
Request throughput (req/s):              2.56      
Output token throughput (tok/s):         607.70    
Total Token throughput (tok/s):          935.85    
---------------Time to First Token----------------
Mean TTFT (ms):                          29500.99  
Median TTFT (ms):                        28172.63  
P99 TTFT (ms):                           37190.65  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
