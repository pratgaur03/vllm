INFO 07-10 22:42:46 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=50.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-50-input-len-256-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=256, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I\'ll try to break it down and provide some insights:\n\n**Programming languages and frameworks:**\n\n* Java (e.g., `@NoArgsConstructor`, `Parcelable`)\n* Python (e.g., `pd`, `numpy`)\n* JavaScript (e.g., `OnClickListener`, `Component`)\n* C++ (e.g., `GPIO`)\n* Kotlin (e.g., `data class`)\n\n**Domains and topics:**\n\n* Machine learning (e.g., `DataLoader`, `estimator`)\n* Android development (e.g., `OnClickListener`, `Parcelable`)\n* Web development (e.g., `Component`, `React`)\n* IoT (e.g., `GPIO`)\n* Finance (e.g., `NYSE`, `profit`)\n* Geography (e.g., `Latitude`, `Longitude`)\n* Politics (e.g., `Cuomo`, `Judicial`)\n\n**Other observations:**\n\n* There are many typos and grammatical errors throughout the text.\n* Some words and phrases appear to be randomly inserted or concatenated (e.g., `cheng Milit"&finding`, `flotation.sensorBrazil`).\n* There', success=True, latency=4.637166349217296, output_tokens=256, ttft=4.635805519297719, itl=[4.778895527124405e-05, 2.041878178715706e-05, 9.514857083559036e-06, 6.85499981045723e-06, 5.645211786031723e-06, 6.250105798244476e-06, 5.671754479408264e-06, 5.204230546951294e-06, 4.937872290611267e-06, 5.131121724843979e-06, 5.300156772136688e-06, 4.930887371301651e-06, 5.484092980623245e-06, 4.875008016824722e-06, 4.812609404325485e-06, 4.9229711294174194e-06, 4.905276000499725e-06, 5.070120096206665e-06, 5.249865353107452e-06, 5.24008646607399e-06, 4.913657903671265e-06, 4.974193871021271e-06, 5.30807301402092e-06, 5.085021257400513e-06, 4.9280934035778046e-06, 5.526933819055557e-06, 5.001667886972427e-06, 5.031004548072815e-06, 5.049165338277817e-06, 5.046837031841278e-06, 5.978159606456757e-06, 5.2228569984436035e-06, 4.8549845814704895e-06, 5.3853727877140045e-06, 4.956964403390884e-06, 4.971865564584732e-06, 4.670117050409317e-06, 4.796776920557022e-06, 4.676170647144318e-06, 4.759058356285095e-06, 4.643108695745468e-06, 5.347654223442078e-06, 4.725996404886246e-06, 4.7800131142139435e-06, 4.90015372633934e-06, 4.83216717839241e-06, 5.538575351238251e-06, 5.198176950216293e-06, 5.1390379667282104e-06, 4.9960799515247345e-06, 5.067791789770126e-06, 4.879198968410492e-06, 4.8871152102947235e-06, 5.900859832763672e-06, 5.12879341840744e-06, 5.417037755250931e-06, 4.8032961785793304e-06, 4.94765117764473e-06, 4.716217517852783e-06, 5.1050446927547455e-06, 4.9318186938762665e-06, 4.7869980335235596e-06, 5.241017788648605e-06, 4.743225872516632e-06, 9.277835488319397e-06, 5.887821316719055e-06, 5.050096660852432e-06, 4.920177161693573e-06, 5.23589551448822e-06, 4.6459026634693146e-06, 4.61796298623085e-06, 4.641246050596237e-06, 4.686880856752396e-06, 4.665926098823547e-06, 4.685018211603165e-06, 4.989095032215118e-06, 4.841014742851257e-06, 5.797017365694046e-06, 4.852190613746643e-06, 5.209818482398987e-06, 4.9211084842681885e-06, 4.882924258708954e-06, 4.902016371488571e-06, 4.729721695184708e-06, 4.637986421585083e-06, 5.668029189109802e-06, 4.860106855630875e-06, 5.206093192100525e-06, 4.69619408249855e-06, 4.907604306936264e-06, 4.76418063044548e-06, 5.223788321018219e-06, 4.9122609198093414e-06, 5.509704351425171e-06, 4.909001290798187e-06, 4.686415195465088e-06, 4.746951162815094e-06, 4.774890840053558e-06, 4.780944436788559e-06, 5.2158720791339874e-06, 4.861969500780106e-06, 4.861969500780106e-06, 4.757195711135864e-06, 4.743225872516632e-06, 4.731584340333939e-06, 5.526002496480942e-06, 4.745088517665863e-06, 4.6300701797008514e-06, 4.827044904232025e-06, 6.481073796749115e-06, 5.681067705154419e-06, 4.917848855257034e-06, 4.598870873451233e-06, 4.864297807216644e-06, 5.29363751411438e-06, 4.969071596860886e-06, 6.430316716432571e-06, 4.881992936134338e-06, 4.893634468317032e-06, 4.845205694437027e-06, 5.463138222694397e-06, 5.003996193408966e-06, 4.764646291732788e-06, 5.029141902923584e-06, 4.834029823541641e-06, 4.75812703371048e-06, 4.874076694250107e-06, 4.771631211042404e-06, 4.62215393781662e-06, 5.775131285190582e-06, 5.567912012338638e-06, 5.094800144433975e-06, 4.798173904418945e-06, 4.906207323074341e-06, 5.3336843848228455e-06, 4.901085048913956e-06, 5.5050477385520935e-06, 5.177222192287445e-06, 4.8317015171051025e-06, 5.009118467569351e-06, 4.7478824853897095e-06, 4.773028194904327e-06, 4.7888606786727905e-06, 4.867091774940491e-06, 5.1371753215789795e-06, 5.349051207304001e-06, 4.818663001060486e-06, 4.8442743718624115e-06, 6.295740604400635e-06, 6.678048521280289e-06, 4.934147000312805e-06, 4.68594953417778e-06, 4.790257662534714e-06, 5.242880433797836e-06, 4.828907549381256e-06, 4.823785275220871e-06, 4.833098500967026e-06, 5.010981112718582e-06, 4.8121437430381775e-06, 4.739966243505478e-06, 4.732050001621246e-06, 4.725996404886246e-06, 4.793982952833176e-06, 5.209818482398987e-06, 5.002133548259735e-06, 4.801899194717407e-06, 4.819128662347794e-06, 4.819128662347794e-06, 4.818663001060486e-06, 4.847068339586258e-06, 4.7371722757816315e-06, 4.874076694250107e-06, 4.612840712070465e-06, 7.202848792076111e-06, 5.0282105803489685e-06, 5.0370581448078156e-06, 5.019828677177429e-06, 4.6263448894023895e-06, 4.6459026634693146e-06, 4.725996404886246e-06, 4.644971340894699e-06, 5.1157549023628235e-06, 4.90434467792511e-06, 4.733912646770477e-06, 4.718080163002014e-06, 5.1460228860378265e-06, 5.027744919061661e-06, 4.783272743225098e-06, 4.843808710575104e-06, 4.82611358165741e-06, 5.044974386692047e-06, 4.942994564771652e-06, 4.644040018320084e-06, 5.067791789770126e-06, 5.166977643966675e-06, 4.807952791452408e-06, 4.705972969532013e-06, 4.746951162815094e-06, 4.686415195465088e-06, 4.7977082431316376e-06, 4.711095243692398e-06, 6.067100912332535e-06, 5.152076482772827e-06, 4.870817065238953e-06, 4.658009856939316e-06, 4.869885742664337e-06, 5.696900188922882e-06, 4.989095032215118e-06, 4.704110324382782e-06, 4.915054887533188e-06, 4.7888606786727905e-06, 4.9122609198093414e-06, 4.783738404512405e-06, 5.276873707771301e-06, 4.773028194904327e-06, 4.717148840427399e-06, 4.658009856939316e-06, 6.040092557668686e-06, 4.693865776062012e-06, 4.590954631567001e-06, 5.374196916818619e-06, 4.9388036131858826e-06, 5.091074854135513e-06, 5.03193587064743e-06, 4.800967872142792e-06, 4.915054887533188e-06, 4.849862307310104e-06, 4.856381565332413e-06, 4.802830517292023e-06, 4.760921001434326e-06, 4.784204065799713e-06, 4.94765117764473e-06, 5.193985998630524e-06, 6.6943466663360596e-06, 4.971865564584732e-06, 4.682224243879318e-06, 4.989560693502426e-06, 5.5800192058086395e-06, 4.925299435853958e-06, 4.776753485202789e-06, 4.719942808151245e-06, 4.698056727647781e-06, 4.786066710948944e-06, 5.363021045923233e-06, 4.7031790018081665e-06, 4.837755113840103e-06, 4.916917532682419e-06, 4.930421710014343e-06, 4.697591066360474e-06, 4.732981324195862e-06, 4.9551017582416534e-06, 4.736240953207016e-06, 4.7977082431316376e-06, 4.70038503408432e-06, 5.896668881177902e-06, 6.44708052277565e-06], tpot=0.0, prompt_len=256, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 50.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  63.91     
Total input tokens:                      262144    
Total generated tokens:                  121191    
Request throughput (req/s):              16.02     
Output token throughput (tok/s):         1896.30   
Total Token throughput (tok/s):          5998.12   
---------------Time to First Token----------------
Mean TTFT (ms):                          25718.91  
Median TTFT (ms):                        25435.03  
P99 TTFT (ms):                           52671.82  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
