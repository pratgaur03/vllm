INFO 07-08 03:08:09 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=45.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='chunked_prefill-qps-45-input-len-256-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=256, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I'll try to break it down and provide some insights:\n\n**Programming languages and frameworks:**\n\n* Java (e.g., `@NoArgsConstructor`, `Parcelable`)\n* Python (e.g., `pd`, `testProfit`)\n* JavaScript (e.g., `OnClickListener`, `Component`)\n* C# (e.g., `Cleanup.structure`)\n* Kotlin (e.g., `lateinit`)\n\n**Domains and topics:**\n\n* Android development (e.g., `OnClickListener`, `Parcelable`)\n* Data science and machine learning (e.g., `testProfit`, `estimator`)\n* Web development (e.g., `Component`, `Cleanup.structure`)\n* IoT and sensor-related topics (e.g., `SENSOR_BUSY`, `wifi`)\n* Finance and economics (e.g., `NYSE`, `profit`)\n* Geography and location-based services (e.g., `Latitude`, `Prague`)\n\n**Other observations:**\n\n* There are many typos and non-English words/phrases, which might indicate that the text is a result of a machine translation or a text generation algorithm.\n* Some parts of the", success=True, latency=3.8023666199296713, output_tokens=256, ttft=0.08414903096854687, itl=[3.671599552035332e-05, 0.014774840790778399, 0.014422016218304634, 0.01443930296227336, 0.014470168855041265, 0.014489663299173117, 0.014563048724085093, 0.014448519330471754, 0.014479361940175295, 0.014484249986708164, 0.014442710671573877, 0.014522013254463673, 0.014503126963973045, 0.014610582031309605, 0.01445377292111516, 0.014435458928346634, 0.014569724909961224, 0.014421244151890278, 0.014544412028044462, 0.014618101995438337, 0.014454104006290436, 0.014452361036092043, 0.014578178059309721, 0.014508408028632402, 0.014485202729701996, 0.014549599029123783, 0.014694937970489264, 0.014377806335687637, 0.01451477175578475, 0.014517329167574644, 0.014488964807242155, 0.01458612410351634, 0.014627097174525261, 0.014618660788983107, 0.01451594103127718, 0.014500698074698448, 0.014600066002458334, 0.014662581030279398, 0.014670507051050663, 0.0145461349748075, 0.014635498635470867, 0.014480352401733398, 0.014587055891752243, 0.01449397811666131, 0.014634144026786089, 0.014473842922598124, 0.01453265082091093, 0.014652861282229424, 0.014483236707746983, 0.014477586839348078, 0.014530378393828869, 0.014541033655405045, 0.014532939996570349, 0.014495036099106073, 0.014678472187370062, 0.014487073756754398, 0.014489713124930859, 0.01459962222725153, 0.014546154998242855, 0.014496003743261099, 0.014596294146031141, 0.014639028813689947, 0.014499192126095295, 0.014605422969907522, 0.014498379081487656, 0.014520205091685057, 0.014548846986144781, 0.015136912930756807, 0.014988394919782877, 0.014527460094541311, 0.014465803746134043, 0.014548392035067081, 0.015202811919152737, 0.015743413008749485, 0.015494784340262413, 0.014447114896029234, 0.014531620778143406, 0.014498834032565355, 0.014606995042413473, 0.014492177870124578, 0.014519507996737957, 0.014619825407862663, 0.01452418090775609, 0.014560258015990257, 0.014565478079020977, 0.014580705668777227, 0.014601197093725204, 0.01453034020960331, 0.01458782097324729, 0.014542409684509039, 0.014492137357592583, 0.01451340364292264, 0.014549351297318935, 0.014528419822454453, 0.01453720685094595, 0.014639163389801979, 0.014468978624790907, 0.014438588172197342, 0.014574094209820032, 0.01450738962739706, 0.014515855349600315, 0.014543887693434954, 0.014649073127657175, 0.014571778941899538, 0.01451139384880662, 0.014561387244611979, 0.014541928190737963, 0.014539807569235563, 0.01450983202084899, 0.014569533988833427, 0.014535245019942522, 0.014572936110198498, 0.014524673111736774, 0.014523779042065144, 0.014553673099726439, 0.014548004604876041, 0.014598207082599401, 0.014535232912749052, 0.0146238524466753, 0.014608964789658785, 0.014514239970594645, 0.014583136886358261, 0.014577744994312525, 0.014577527064830065, 0.014473530929535627, 0.01454980531707406, 0.014562705997377634, 0.014507942833006382, 0.014579079113900661, 0.014561670832335949, 0.014583173207938671, 0.014483056031167507, 0.014548434875905514, 0.014549477957189083, 0.014685310889035463, 0.014547554310411215, 0.014874477870762348, 0.014364283997565508, 0.014509564731270075, 0.01456237630918622, 0.014534026850014925, 0.016206401865929365, 0.014661210123449564, 0.014727270230650902, 0.014571052975952625, 0.014551936648786068, 0.01458695437759161, 0.014607053715735674, 0.014572883024811745, 0.014544463250786066, 0.014628652017563581, 0.014467950910329819, 0.014512849040329456, 0.014646986965090036, 0.014564241748303175, 0.014515146147459745, 0.014848959166556597, 0.014635138679295778, 0.01455679489299655, 0.014483538456261158, 0.014540087897330523, 0.014580308925360441, 0.014598678797483444, 0.014586856123059988, 0.01457844814285636, 0.014516533818095922, 0.014524769969284534, 0.014703159220516682, 0.01456370810046792, 0.01460682787001133, 0.014520284719765186, 0.01459969999268651, 0.014511916320770979, 0.014539239928126335, 0.014580187853425741, 0.014559431001543999, 0.014517195988446474, 0.014590298291295767, 0.01462479680776596, 0.01466988306492567, 0.014560353010892868, 0.014607354067265987, 0.014521860983222723, 0.014547362923622131, 0.014911276753991842, 0.014907530043274164, 0.01449354412034154, 0.014575667213648558, 0.01456756005063653, 0.014558662660419941, 0.014634761027991772, 0.014667592942714691, 0.014600703027099371, 0.014518448151648045, 0.014593318104743958, 0.014634325634688139, 0.014460652135312557, 0.014566207304596901, 0.014659073669463396, 0.014444126281887293, 0.014588990714401007, 0.014550908003002405, 0.014548038132488728, 0.014571999199688435, 0.014554100576788187, 0.01468709297478199, 0.014558890368789434, 0.01455678604543209, 0.014565893914550543, 0.01462473999708891, 0.014515313785523176, 0.014735556207597256, 0.01463022269308567, 0.014499330427497625, 0.014579396694898605, 0.01456164801493287, 0.014528870116919279, 0.014543550089001656, 0.014611759688705206, 0.014559298288077116, 0.014507008716464043, 0.01453078631311655, 0.014643765985965729, 0.014544117730110884, 0.014567032922059298, 0.014638280030339956, 0.014558254275470972, 0.014565830118954182, 0.014515363611280918, 0.014588911086320877, 0.014479018282145262, 0.01454635662958026, 0.01457174215465784, 0.014615559950470924, 0.014523560181260109, 0.014517407864332199, 0.014591433107852936, 0.014496905729174614, 0.014590294100344181, 0.01454206695780158, 0.014574438333511353, 0.014548373874276876, 0.014547551050782204, 0.014569377060979605, 0.01453123101964593, 0.014555800706148148, 0.014800196047872305, 0.014416005928069353, 0.014506612904369831, 0.014548356179147959, 0.014534065034240484, 0.014464796055108309, 0.014535912778228521, 0.014732810202986002, 0.01453745411708951, 0.014797457959502935], tpot=0.0, prompt_len=256, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 45.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  46.74     
Total input tokens:                      262144    
Total generated tokens:                  239421    
Request throughput (req/s):              21.91     
Output token throughput (tok/s):         5122.59   
Total Token throughput (tok/s):          10731.36  
---------------Time to First Token----------------
Mean TTFT (ms):                          4875.32   
Median TTFT (ms):                        532.97    
P99 TTFT (ms):                           10995.78  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          79.65     
Median TPOT (ms):                        87.72     
P99 TPOT (ms):                           117.32    
---------------Inter-token Latency----------------
Mean ITL (ms):                           78.50     
Median ITL (ms):                         53.83     
P99 ITL (ms):                            191.50    
==================================================
