INFO 07-10 02:29:03 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=20.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-20-input-len-1024-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=1024, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you have provided a large amount of text that seems to be a mix of code snippets, error messages, and random text. It's difficult to make sense of this text without more context.\n\nHowever, I can try to help you identify some patterns or potential issues in the text. Here are a few observations:\n\n1. **Code snippets**: The text contains snippets of code in various programming languages, including Java, Python, and JavaScript. These snippets appear to be incomplete and may be related to different projects or applications.\n2. **Error messages**: There are several error messages and warnings scattered throughout the text. These messages may indicate issues with code compilation, runtime errors, or other problems.\n3. **Random text**: The text also contains random words, phrases, and characters that don't seem to be related to any specific topic or context.\n4. **Formatting issues**: The text has formatting issues, with inconsistent indentation, line breaks, and character encoding.\n\nTo better assist you, could you please provide more context about this text? For example:\n\n* What is the source of this text?\n* What programming languages or technologies are involved?\n* What is the purpose of this text (e.g., debugging, documentation, or something else)?\n* Are there any specific issues", success=True, latency=4.785359640140086, output_tokens=256, ttft=4.7839922602288425, itl=[4.745693877339363e-05, 1.7162878066301346e-05, 9.859912097454071e-06, 7.005408406257629e-06, 5.597714334726334e-06, 6.278045475482941e-06, 5.225185304880142e-06, 4.932750016450882e-06, 4.854053258895874e-06, 5.133915692567825e-06, 4.950910806655884e-06, 4.990026354789734e-06, 5.149282515048981e-06, 4.9280934035778046e-06, 4.659872502088547e-06, 4.868023097515106e-06, 4.766043275594711e-06, 5.112960934638977e-06, 4.708766937255859e-06, 4.7781504690647125e-06, 5.052890628576279e-06, 5.48316165804863e-06, 4.951842129230499e-06, 5.3532421588897705e-06, 5.139969289302826e-06, 5.470123142004013e-06, 5.062669515609741e-06, 4.855915904045105e-06, 5.222391337156296e-06, 4.858709871768951e-06, 5.847308784723282e-06, 5.805864930152893e-06, 4.939734935760498e-06, 5.4263509809970856e-06, 4.668720066547394e-06, 4.7693029046058655e-06, 4.7120265662670135e-06, 4.7907233238220215e-06, 4.734843969345093e-06, 4.707369953393936e-06, 4.9388036131858826e-06, 6.501097232103348e-06, 5.162786692380905e-06, 4.920177161693573e-06, 4.9318186938762665e-06, 4.8140063881874084e-06, 4.7800131142139435e-06, 4.681292921304703e-06, 4.762783646583557e-06, 4.806090146303177e-06, 5.0477683544158936e-06, 4.6282075345516205e-06, 4.7781504690647125e-06, 5.315989255905151e-06, 4.741828888654709e-06, 4.748813807964325e-06, 4.738103598356247e-06, 4.637986421585083e-06, 5.189329385757446e-06, 5.066860467195511e-06, 4.573725163936615e-06, 4.683155566453934e-06, 4.767905920743942e-06, 5.2871182560920715e-06, 4.72506508231163e-06, 5.8300793170928955e-06, 4.99701127409935e-06, 4.862900823354721e-06, 4.733912646770477e-06, 4.670117050409317e-06, 5.260109901428223e-06, 4.902947694063187e-06, 4.644971340894699e-06, 4.787929356098175e-06, 4.7818757593631744e-06, 4.9280934035778046e-06, 4.852190613746643e-06, 5.807727575302124e-06, 4.710163921117783e-06, 5.5888667702674866e-06, 5.366280674934387e-06, 4.927627742290497e-06, 4.891306161880493e-06, 5.30807301402092e-06, 4.71062958240509e-06, 4.6943314373493195e-06, 5.202833563089371e-06, 4.664063453674316e-06, 4.8889778554439545e-06, 5.017966032028198e-06, 4.766974598169327e-06, 4.633795469999313e-06, 4.915986210107803e-06, 5.86826354265213e-06, 5.424022674560547e-06, 4.9620866775512695e-06, 6.320886313915253e-06, 4.7031790018081665e-06, 4.793982952833176e-06, 4.862900823354721e-06, 9.871087968349457e-06, 5.065929144620895e-06, 4.7977082431316376e-06, 4.670117050409317e-06, 4.682224243879318e-06, 5.270820111036301e-06, 5.162786692380905e-06, 4.840083420276642e-06, 4.840083420276642e-06, 6.793998181819916e-06, 5.125068128108978e-06, 5.356967449188232e-06, 4.824250936508179e-06, 4.763714969158173e-06, 4.664994776248932e-06, 4.641246050596237e-06, 4.768837243318558e-06, 5.559064447879791e-06, 5.02588227391243e-06, 6.108079105615616e-06, 5.005858838558197e-06, 5.420297384262085e-06, 4.902947694063187e-06, 4.845671355724335e-06, 5.6819990277290344e-06, 5.1031820476055145e-06, 4.735775291919708e-06, 5.102250725030899e-06, 5.076173692941666e-06, 6.112735718488693e-06, 5.003996193408966e-06, 4.760921001434326e-06, 5.214940756559372e-06, 5.186069756746292e-06, 5.136243999004364e-06, 4.776753485202789e-06, 4.834029823541641e-06, 4.7283247113227844e-06, 5.184672772884369e-06, 5.011912435293198e-06, 4.709232598543167e-06, 4.90015372633934e-06, 5.252659320831299e-06, 5.487352609634399e-06, 4.739966243505478e-06, 4.686880856752396e-06, 5.144160240888596e-06, 5.029607564210892e-06, 4.647299647331238e-06, 6.055925041437149e-06, 6.3818879425525665e-06, 5.066860467195511e-06, 5.010981112718582e-06, 5.0533562898635864e-06, 4.7157518565654755e-06, 4.827044904232025e-06, 5.783047527074814e-06, 4.68594953417778e-06, 4.988163709640503e-06, 4.942063242197037e-06, 4.556030035018921e-06, 4.815869033336639e-06, 6.06197863817215e-06, 4.678033292293549e-06, 4.602130502462387e-06, 4.81773167848587e-06, 5.810055881738663e-06, 5.080830305814743e-06, 4.639383405447006e-06, 4.727859050035477e-06, 4.583969712257385e-06, 4.922039806842804e-06, 5.112960934638977e-06, 6.891787052154541e-06, 4.860106855630875e-06, 4.867091774940491e-06, 5.523208528757095e-06, 4.732981324195862e-06, 4.64264303445816e-06, 5.068257451057434e-06, 5.044974386692047e-06, 4.828907549381256e-06, 4.54392284154892e-06, 4.950910806655884e-06, 4.899222403764725e-06, 5.274079740047455e-06, 4.841014742851257e-06, 4.691071808338165e-06, 4.656612873077393e-06, 4.854053258895874e-06, 4.718080163002014e-06, 4.881992936134338e-06, 4.66126948595047e-06, 4.723668098449707e-06, 4.782341420650482e-06, 5.516689270734787e-06, 4.7390349209308624e-06, 4.62215393781662e-06, 5.5497512221336365e-06, 4.87128272652626e-06, 4.678964614868164e-06, 5.939975380897522e-06, 4.980713129043579e-06, 5.307141691446304e-06, 5.343928933143616e-06, 4.79724258184433e-06, 4.733912646770477e-06, 5.508773028850555e-06, 4.857312887907028e-06, 4.740897566080093e-06, 4.652887582778931e-06, 5.843117833137512e-06, 4.958827048540115e-06, 4.800036549568176e-06, 4.66126948595047e-06, 5.304813385009766e-06, 4.704110324382782e-06, 4.752073436975479e-06, 5.629844963550568e-06, 4.71901148557663e-06, 4.8461370170116425e-06, 4.898756742477417e-06, 4.8461370170116425e-06, 5.1390379667282104e-06, 4.8871152102947235e-06, 6.319023668766022e-06, 4.92902472615242e-06, 5.360692739486694e-06, 4.942994564771652e-06, 5.781184881925583e-06, 4.711095243692398e-06, 4.829838871955872e-06, 4.650093615055084e-06, 6.865710020065308e-06, 4.718080163002014e-06, 4.9602240324020386e-06, 5.034729838371277e-06, 4.55835834145546e-06, 4.628673195838928e-06, 4.731118679046631e-06, 4.807021468877792e-06, 4.61796298623085e-06, 5.928799510002136e-06, 5.516223609447479e-06, 4.990026354789734e-06, 6.008893251419067e-06, 4.860106855630875e-06, 4.874076694250107e-06, 5.8067962527275085e-06, 4.923902451992035e-06, 5.008187144994736e-06, 5.6908465921878815e-06, 4.886183887720108e-06, 4.7460198402404785e-06, 4.6570785343647e-06, 7.1409158408641815e-06], tpot=0.0, prompt_len=1024, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 20.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  86.51     
Total input tokens:                      1048576   
Total generated tokens:                  57449     
Request throughput (req/s):              11.84     
Output token throughput (tok/s):         664.11    
Total Token throughput (tok/s):          12785.66  
---------------Time to First Token----------------
Mean TTFT (ms):                          23486.41  
Median TTFT (ms):                        0.00      
P99 TTFT (ms):                           72468.11  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
