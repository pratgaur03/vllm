INFO 07-09 22:45:43 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=1.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-1-input-len-256-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=256, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I\'ll try to break it down and provide some insights:\n\n**Programming languages and frameworks:**\n\n* Java (e.g., `@NoArgsConstructor`, `Parcelable`)\n* Python (e.g., `pd`, `numpy`)\n* JavaScript (e.g., `OnClickListener`, `Component`)\n* C++ (e.g., `GPIO`)\n* Kotlin (e.g., `data class`)\n\n**Domains and topics:**\n\n* Machine learning (e.g., `DataLoader`, `estimator`)\n* Android development (e.g., `OnClickListener`, `Parcelable`)\n* Web development (e.g., `Component`, `React`)\n* IoT (e.g., `GPIO`)\n* Finance (e.g., `NYSE`, `profit`)\n* Geography (e.g., `Latitude`, `Longitude`)\n* Politics (e.g., `Cuomo`, `Judicial`)\n\n**Other observations:**\n\n* There are many typos and grammatical errors throughout the text.\n* Some words and phrases appear to be randomly inserted or concatenated (e.g., `cheng Milit"&finding`, `flotation.sensorBrazil`).\n* There', success=True, latency=4.624222192913294, output_tokens=256, ttft=4.622893152758479, itl=[3.9182137697935104e-05, 1.7187092453241348e-05, 1.0197050869464874e-05, 7.594004273414612e-06, 6.395857781171799e-06, 6.392132490873337e-06, 5.593989044427872e-06, 5.453824996948242e-06, 5.166046321392059e-06, 4.991888999938965e-06, 4.818197339773178e-06, 4.916917532682419e-06, 5.07524237036705e-06, 4.770699888467789e-06, 4.706904292106628e-06, 4.676170647144318e-06, 4.906207323074341e-06, 5.278736352920532e-06, 5.231238901615143e-06, 4.917848855257034e-06, 4.926230758428574e-06, 4.801899194717407e-06, 5.329027771949768e-06, 5.282927304506302e-06, 4.950910806655884e-06, 5.4407864809036255e-06, 5.022156983613968e-06, 5.0640664994716644e-06, 5.1818788051605225e-06, 5.070120096206665e-06, 5.804002285003662e-06, 5.173962563276291e-06, 4.858244210481644e-06, 5.330890417098999e-06, 4.9727968871593475e-06, 4.966277629137039e-06, 4.795845597982407e-06, 4.956033080816269e-06, 4.988163709640503e-06, 4.7567300498485565e-06, 4.637986421585083e-06, 4.935078322887421e-06, 4.807952791452408e-06, 4.834961146116257e-06, 4.976056516170502e-06, 4.683155566453934e-06, 5.625654011964798e-06, 5.416106432676315e-06, 4.875008016824722e-06, 4.72506508231163e-06, 4.83216717839241e-06, 4.910863935947418e-06, 4.807021468877792e-06, 5.5371783673763275e-06, 4.943925887346268e-06, 5.234964191913605e-06, 4.7120265662670135e-06, 4.967674612998962e-06, 4.813075065612793e-06, 5.024950951337814e-06, 4.685018211603165e-06, 4.697125405073166e-06, 5.1781535148620605e-06, 4.834029823541641e-06, 4.701782017946243e-06, 5.516223609447479e-06, 4.9299560487270355e-06, 4.783738404512405e-06, 5.1371753215789795e-06, 4.757195711135864e-06, 4.837755113840103e-06, 4.636123776435852e-06, 4.603993147611618e-06, 4.752073436975479e-06, 4.624947905540466e-06, 4.813075065612793e-06, 4.61190938949585e-06, 5.379784852266312e-06, 4.684086889028549e-06, 4.746951162815094e-06, 4.730187356472015e-06, 4.5727938413619995e-06, 4.732981324195862e-06, 4.834961146116257e-06, 4.689209163188934e-06, 5.407724529504776e-06, 4.785135388374329e-06, 5.17629086971283e-06, 4.825647920370102e-06, 4.816334694623947e-06, 5.23589551448822e-06, 5.027744919061661e-06, 4.739966243505478e-06, 5.73229044675827e-06, 5.092006176710129e-06, 4.793982952833176e-06, 4.667788743972778e-06, 4.705972969532013e-06, 4.75812703371048e-06, 5.050096660852432e-06, 4.802830517292023e-06, 4.877336323261261e-06, 4.71062958240509e-06, 4.599336534738541e-06, 4.591885954141617e-06, 5.1818788051605225e-06, 4.5979395508766174e-06, 4.777219146490097e-06, 4.732981324195862e-06, 6.003770977258682e-06, 4.990957677364349e-06, 4.773959517478943e-06, 4.608184099197388e-06, 4.686880856752396e-06, 5.1800161600112915e-06, 4.698056727647781e-06, 4.93321567773819e-06, 5.354639142751694e-06, 4.710163921117783e-06, 4.69619408249855e-06, 4.871748387813568e-06, 4.990026354789734e-06, 4.806090146303177e-06, 4.867091774940491e-06, 4.8889778554439545e-06, 4.881992936134338e-06, 4.814937710762024e-06, 5.370937287807465e-06, 4.665926098823547e-06, 5.728099495172501e-06, 5.102250725030899e-06, 4.984904080629349e-06, 4.7977082431316376e-06, 4.615169018507004e-06, 5.014240741729736e-06, 5.022622644901276e-06, 4.814937710762024e-06, 4.8782676458358765e-06, 4.75393608212471e-06, 4.735775291919708e-06, 4.7693029046058655e-06, 4.60771843791008e-06, 5.359295755624771e-06, 4.64683398604393e-06, 4.825182259082794e-06, 5.37605956196785e-06, 4.841946065425873e-06, 4.6477653086185455e-06, 4.875939339399338e-06, 6.224028766155243e-06, 5.078036338090897e-06, 4.733912646770477e-06, 4.618428647518158e-06, 5.670823156833649e-06, 4.830770194530487e-06, 5.256384611129761e-06, 4.877801984548569e-06, 5.152076482772827e-06, 4.816800355911255e-06, 4.717148840427399e-06, 4.676170647144318e-06, 4.639849066734314e-06, 4.7478824853897095e-06, 5.425885319709778e-06, 4.884321242570877e-06, 4.67570498585701e-06, 4.646368324756622e-06, 4.9658119678497314e-06, 4.659872502088547e-06, 4.6943314373493195e-06, 4.731584340333939e-06, 4.522968083620071e-06, 4.717148840427399e-06, 6.151851266622543e-06, 4.825182259082794e-06, 4.847999662160873e-06, 4.9192458391189575e-06, 4.666857421398163e-06, 4.8857182264328e-06, 4.677101969718933e-06, 4.706904292106628e-06, 4.941131919622421e-06, 4.705972969532013e-06, 4.708301275968552e-06, 4.6137720346450806e-06, 5.4640695452690125e-06, 4.908069968223572e-06, 4.631932824850082e-06, 4.698056727647781e-06, 4.792120307683945e-06, 5.8319419622421265e-06, 5.2647665143013e-06, 4.8102810978889465e-06, 5.706679075956345e-06, 5.0389207899570465e-06, 4.655215889215469e-06, 4.8140063881874084e-06, 4.651956260204315e-06, 4.7138892114162445e-06, 5.084089934825897e-06, 4.676170647144318e-06, 6.44288957118988e-06, 4.942063242197037e-06, 4.796776920557022e-06, 4.852190613746643e-06, 4.8959627747535706e-06, 5.261972546577454e-06, 4.719942808151245e-06, 4.724133759737015e-06, 4.701782017946243e-06, 4.807952791452408e-06, 4.802364856004715e-06, 4.5318156480789185e-06, 4.990957677364349e-06, 4.948116838932037e-06, 4.522036761045456e-06, 4.5318156480789185e-06, 5.825888365507126e-06, 4.93926927447319e-06, 4.7050416469573975e-06, 5.478039383888245e-06, 5.1460228860378265e-06, 4.748813807964325e-06, 4.648230969905853e-06, 4.837755113840103e-06, 4.963018000125885e-06, 4.697125405073166e-06, 5.471985787153244e-06, 5.107838660478592e-06, 4.664063453674316e-06, 4.568137228488922e-06, 4.67570498585701e-06, 5.341134965419769e-06, 5.599111318588257e-06, 4.9979425966739655e-06, 4.732050001621246e-06, 4.677101969718933e-06, 5.593989044427872e-06, 4.866626113653183e-06, 4.579313099384308e-06, 4.633795469999313e-06, 4.58909198641777e-06, 4.701782017946243e-06, 5.206093192100525e-06, 4.798173904418945e-06, 5.026813596487045e-06, 4.805158823728561e-06, 4.726927727460861e-06, 4.5280903577804565e-06, 4.557892680168152e-06, 5.0389207899570465e-06, 4.663132131099701e-06, 4.585832357406616e-06, 4.579313099384308e-06, 5.566980689764023e-06, 6.39772042632103e-06], tpot=0.0, prompt_len=256, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 1.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  1086.90   
Total input tokens:                      262144    
Total generated tokens:                  238368    
Request throughput (req/s):              0.94      
Output token throughput (tok/s):         219.31    
Total Token throughput (tok/s):          460.50    
---------------Time to First Token----------------
Mean TTFT (ms):                          4387.35   
Median TTFT (ms):                        4659.68   
P99 TTFT (ms):                           5670.44   
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
