INFO 07-08 06:15:41 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=1.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='chunked_prefill-qps-1-input-len-256-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=256, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I'll try to break it down and provide some insights:\n\n**Programming languages and frameworks:**\n\n* Java (e.g., `@NoArgsConstructor`, `Parcelable`)\n* Python (e.g., `pd`, `testProfit`)\n* JavaScript (e.g., `OnClickListener`, `Component`)\n* C# (e.g., `Cleanup.structure`)\n* Kotlin (e.g., `lateinit`)\n\n**Domains and topics:**\n\n* Android development (e.g., `OnClickListener`, `Parcelable`)\n* Data science and machine learning (e.g., `testProfit`, `estimator`)\n* Web development (e.g., `Component`, `Cleanup.structure`)\n* IoT and sensor-related topics (e.g., `SENSOR_BUSY`, `wifi`)\n* Finance and economics (e.g., `NYSE`, `profit`)\n* Geography and location-based services (e.g., `Latitude`, `Prague`)\n\n**Other observations:**\n\n* There are many typos and non-English words/phrases, which might indicate that the text is a result of a machine translation or a text generation algorithm.\n* Some parts of the", success=True, latency=3.790176022797823, output_tokens=256, ttft=0.0862995176576078, itl=[4.035234451293945e-05, 0.0146535555832088, 0.014449220150709152, 0.014445503242313862, 0.01454974478110671, 0.01445808820426464, 0.014543290715664625, 0.014411136042326689, 0.014505796134471893, 0.014673349913209677, 0.014598551206290722, 0.014425287954509258, 0.01447231788188219, 0.014425139874219894, 0.014459559228271246, 0.014649874996393919, 0.01461212569847703, 0.014420746359974146, 0.014502621721476316, 0.014451733324676752, 0.014468290843069553, 0.014485507737845182, 0.01448709424585104, 0.014602303970605135, 0.014463400933891535, 0.014526332262903452, 0.014435152988880873, 0.014415533747524023, 0.014512625988572836, 0.014529018197208643, 0.014519436750560999, 0.01446080207824707, 0.014460400212556124, 0.01445839274674654, 0.014543818309903145, 0.014478262979537249, 0.014477165881544352, 0.014614352956414223, 0.01444917917251587, 0.014529245905578136, 0.014472128823399544, 0.01453940523788333, 0.014509202912449837, 0.014484719838947058, 0.014611019287258387, 0.014482898637652397, 0.01450246199965477, 0.014457465149462223, 0.014509023167192936, 0.014467918779700994, 0.014484847895801067, 0.014590881299227476, 0.014538001734763384, 0.014504468068480492, 0.014473955146968365, 0.014458137098699808, 0.014505479019135237, 0.014583606738597155, 0.01445322809740901, 0.014498206786811352, 0.01447112811729312, 0.014531475026160479, 0.014522247947752476, 0.014470487833023071, 0.01458706334233284, 0.01448379596695304, 0.014486467000097036, 0.014478011056780815, 0.014495959971100092, 0.014515836723148823, 0.014456636272370815, 0.014631833881139755, 0.014581101015210152, 0.014527852181345224, 0.014515562914311886, 0.014440009836107492, 0.01454650005325675, 0.014462574850767851, 0.014573317021131516, 0.014521562028676271, 0.01449804799631238, 0.014472248032689095, 0.014545942191034555, 0.014457730110734701, 0.014492741785943508, 0.0146897342056036, 0.014530302956700325, 0.014458554796874523, 0.01449703611433506, 0.014411299023777246, 0.014491906855255365, 0.014796785078942776, 0.01468156510964036, 0.014529124833643436, 0.014468385837972164, 0.014453391078859568, 0.014467990957200527, 0.014485991094261408, 0.01453187083825469, 0.014621736016124487, 0.014497753232717514, 0.014444837812334299, 0.014532996341586113, 0.014473696704953909, 0.01451412308961153, 0.014535500202327967, 0.014564402867108583, 0.014473139774054289, 0.014487016014754772, 0.014514598064124584, 0.014507804997265339, 0.014535672031342983, 0.01457988191395998, 0.014558494091033936, 0.01453923899680376, 0.014490199275314808, 0.014504283666610718, 0.014438214246183634, 0.01457852590829134, 0.014527890831232071, 0.014531172346323729, 0.01451060688123107, 0.014578126836568117, 0.014506826177239418, 0.014441793784499168, 0.014536743983626366, 0.014817961025983095, 0.014284010045230389, 0.014517256058752537, 0.014426624868065119, 0.014507987070828676, 0.014524186961352825, 0.0145451370626688, 0.014719133265316486, 0.014538484625518322, 0.014546456281095743, 0.014503822661936283, 0.014473483432084322, 0.014487248845398426, 0.014524808153510094, 0.014647661708295345, 0.014520050957798958, 0.0145366620272398, 0.014515969902276993, 0.014545668382197618, 0.014489909633994102, 0.014481320045888424, 0.014669158961623907, 0.014546283055096865, 0.014518734067678452, 0.014537082053720951, 0.01451445883139968, 0.014556552283465862, 0.014502519741654396, 0.014760606922209263, 0.014471394009888172, 0.014542452059686184, 0.014438169077038765, 0.014500882010906935, 0.014526898972690105, 0.01458575390279293, 0.014608622994273901, 0.01449943007901311, 0.014457601122558117, 0.014575061853975058, 0.014527550898492336, 0.01447893027216196, 0.014527530875056982, 0.014623653143644333, 0.014542303048074245, 0.01453505177050829, 0.014491760171949863, 0.01445138594135642, 0.014476640149950981, 0.014552864711731672, 0.014580922201275826, 0.01451208209618926, 0.014493701048195362, 0.014536515809595585, 0.014455631840974092, 0.014526311308145523, 0.014495851937681437, 0.014657540712505579, 0.014403229113668203, 0.01451581809669733, 0.014467981178313494, 0.014546030666679144, 0.014500340912491083, 0.014562510419636965, 0.014619992580264807, 0.01455466402694583, 0.01444860827177763, 0.014496183954179287, 0.014491647947579622, 0.014609572011977434, 0.014525273814797401, 0.014589263126254082, 0.014535968191921711, 0.014461842831224203, 0.014496587216854095, 0.014499200973659754, 0.014511482790112495, 0.014806513208895922, 0.014297650661319494, 0.014573529362678528, 0.014523897785693407, 0.014507987070828676, 0.014533195178955793, 0.01453242963179946, 0.014737426303327084, 0.014597127679735422, 0.014556465204805136, 0.014570327010005713, 0.014496366959065199, 0.01456077815964818, 0.014532097615301609, 0.014618149027228355, 0.014559707138687372, 0.014508745167404413, 0.01450492674484849, 0.01451637502759695, 0.014551558066159487, 0.014541855081915855, 0.014601435046643019, 0.014522730838507414, 0.014563464093953371, 0.014504833146929741, 0.01442263275384903, 0.014554013963788748, 0.01469540735706687, 0.014614458661526442, 0.014534242916852236, 0.014479044359177351, 0.014405610039830208, 0.014533261768519878, 0.014505574014037848, 0.014543159864842892, 0.014626763295382261, 0.014509733766317368, 0.014540642034262419, 0.01450325595214963, 0.014486395288258791, 0.01454635988920927, 0.014582454692572355, 0.014525879174470901, 0.0144915790297091, 0.01450883224606514, 0.014531706925481558, 0.01453278586268425, 0.014511844143271446, 0.01458914577960968, 0.014601679984480143, 0.014536736998707056, 0.014543717261403799, 0.014469112735241652, 0.014774227980524302], tpot=0.0, prompt_len=256, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 1.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  1085.97   
Total input tokens:                      262144    
Total generated tokens:                  239978    
Request throughput (req/s):              0.94      
Output token throughput (tok/s):         220.98    
Total Token throughput (tok/s):          462.37    
---------------Time to First Token----------------
Mean TTFT (ms):                          89.76     
Median TTFT (ms):                        89.39     
P99 TTFT (ms):                           101.45    
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          15.47     
Median TPOT (ms):                        15.36     
P99 TPOT (ms):                           18.23     
---------------Inter-token Latency----------------
Mean ITL (ms):                           15.41     
Median ITL (ms):                         14.98     
P99 ITL (ms):                            18.09     
==================================================
