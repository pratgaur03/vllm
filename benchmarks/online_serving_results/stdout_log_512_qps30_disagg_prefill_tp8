INFO 07-10 01:10:49 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=30.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-30-input-len-512-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=512, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and contexts. I'll try to break it down and provide some insights.\n\n**Observations:**\n\n1. **Mixed languages**: The text contains code snippets and keywords from multiple programming languages, including Java, Python, C++, and JavaScript.\n2. **Technical terms**: There are many technical terms and concepts mentioned, such as machine learning, data loading, GPIO, sensors, and more.\n3. **Company and product names**: Some company and product names are mentioned, like Volvo, Xiaomi, and macOS.\n4. **Geographic locations**: Several geographic locations are mentioned, including Brazil, Omaha, and Prague.\n5. **Random words and phrases**: The text also contains random words and phrases that don't seem to be related to any specific topic or context.\n\n**Possible explanations:**\n\n1. **Code dump**: It's possible that someone has dumped a large amount of code and text into a single block, without any organization or context.\n2. **Automated text generation**: The text might have been generated automatically using a tool or algorithm that combines different sources of text and code.\n3. **Error or glitch**:", success=True, latency=5.109856612980366, output_tokens=256, ttft=5.108428547158837, itl=[5.145091563463211e-05, 1.906510442495346e-05, 9.697861969470978e-06, 6.651971489191055e-06, 5.866866558790207e-06, 5.7443976402282715e-06, 5.180947482585907e-06, 5.207955837249756e-06, 4.869885742664337e-06, 4.977919161319733e-06, 5.0640664994716644e-06, 4.738103598356247e-06, 5.095731467008591e-06, 4.849396646022797e-06, 4.75393608212471e-06, 4.702713340520859e-06, 5.592126399278641e-06, 7.451046258211136e-06, 5.7658180594444275e-06, 5.159061402082443e-06, 4.932284355163574e-06, 4.776753485202789e-06, 5.361158400774002e-06, 5.237758159637451e-06, 4.943925887346268e-06, 5.976296961307526e-06, 4.869885742664337e-06, 5.707144737243652e-06, 4.970934242010117e-06, 4.979781806468964e-06, 5.775131285190582e-06, 5.152076482772827e-06, 4.7869980335235596e-06, 7.782131433486938e-06, 4.727859050035477e-06, 4.642177373170853e-06, 4.6407803893089294e-06, 4.6691857278347015e-06, 4.703644663095474e-06, 4.640314728021622e-06, 4.665926098823547e-06, 5.71180135011673e-06, 4.733912646770477e-06, 4.702247679233551e-06, 4.808884114027023e-06, 4.575122147798538e-06, 5.277805030345917e-06, 4.763249307870865e-06, 4.599802196025848e-06, 4.569068551063538e-06, 4.956964403390884e-06, 5.023088306188583e-06, 4.838220775127411e-06, 5.499925464391708e-06, 4.733912646770477e-06, 4.688743501901627e-06, 4.861969500780106e-06, 4.795379936695099e-06, 4.676636308431625e-06, 6.683170795440674e-06, 4.75393608212471e-06, 7.203314453363419e-06, 4.658941179513931e-06, 4.68594953417778e-06, 6.6640786826610565e-06, 5.787704139947891e-06, 6.928108632564545e-06, 4.807952791452408e-06, 4.8102810978889465e-06, 4.745554178953171e-06, 4.90434467792511e-06, 4.626810550689697e-06, 4.7120265662670135e-06, 5.635898560285568e-06, 4.631001502275467e-06, 4.742294549942017e-06, 4.593748599290848e-06, 6.376300007104874e-06, 5.9138983488082886e-06, 4.81167808175087e-06, 4.75812703371048e-06, 4.751142114400864e-06, 4.605855792760849e-06, 5.919020622968674e-06, 4.652887582778931e-06, 6.061047315597534e-06, 4.763249307870865e-06, 4.582107067108154e-06, 5.953945219516754e-06, 4.698056727647781e-06, 4.702713340520859e-06, 4.586298018693924e-06, 4.805624485015869e-06, 7.4589625000953674e-06, 9.700190275907516e-06, 4.6729110181331635e-06, 4.7138892114162445e-06, 6.127171218395233e-06, 4.917848855257034e-06, 4.757195711135864e-06, 4.733912646770477e-06, 4.505272954702377e-06, 4.783738404512405e-06, 4.607252776622772e-06, 4.769768565893173e-06, 6.092246621847153e-06, 4.809815436601639e-06, 4.4959597289562225e-06, 5.349982529878616e-06, 7.570255547761917e-06, 5.662906914949417e-06, 4.773959517478943e-06, 4.755798727273941e-06, 4.536937922239304e-06, 5.875248461961746e-06, 5.2209943532943726e-06, 7.967930287122726e-06, 4.762783646583557e-06, 4.571396857500076e-06, 6.068963557481766e-06, 5.357898771762848e-06, 4.656147211790085e-06, 1.0202638804912567e-05, 5.4151751101017e-06, 6.624963134527206e-06, 5.498062819242477e-06, 4.794914275407791e-06, 4.794914275407791e-06, 4.704110324382782e-06, 9.682029485702515e-06, 5.804002285003662e-06, 4.673842340707779e-06, 4.578381776809692e-06, 5.376990884542465e-06, 5.488749593496323e-06, 4.767905920743942e-06, 4.785135388374329e-06, 4.698056727647781e-06, 4.776753485202789e-06, 4.819128662347794e-06, 4.603993147611618e-06, 5.214940756559372e-06, 5.878042429685593e-06, 4.75393608212471e-06, 4.705972969532013e-06, 6.254296749830246e-06, 5.103647708892822e-06, 5.390029400587082e-06, 4.76837158203125e-06, 7.445923984050751e-06, 6.145797669887543e-06, 5.17209991812706e-06, 4.755798727273941e-06, 4.629138857126236e-06, 4.706904292106628e-06, 5.992129445075989e-06, 4.8209913074970245e-06, 4.766043275594711e-06, 4.829838871955872e-06, 5.702953785657883e-06, 5.336012691259384e-06, 4.688277840614319e-06, 4.605855792760849e-06, 4.699919372797012e-06, 4.647299647331238e-06, 4.7120265662670135e-06, 5.8086588978767395e-06, 4.722271114587784e-06, 6.780028343200684e-06, 4.777684807777405e-06, 4.841946065425873e-06, 5.306210368871689e-06, 5.492009222507477e-06, 6.5998174250125885e-06, 4.838220775127411e-06, 4.843808710575104e-06, 4.569999873638153e-06, 4.745088517665863e-06, 5.123205482959747e-06, 4.909001290798187e-06, 4.804693162441254e-06, 4.731118679046631e-06, 4.722271114587784e-06, 4.7478824853897095e-06, 5.486886948347092e-06, 4.979781806468964e-06, 5.0603412091732025e-06, 4.802830517292023e-06, 4.751142114400864e-06, 4.769768565893173e-06, 4.850327968597412e-06, 4.709698259830475e-06, 7.737893611192703e-06, 5.021225661039352e-06, 4.6622008085250854e-06, 4.578847438097e-06, 5.958136171102524e-06, 4.6729110181331635e-06, 4.670117050409317e-06, 5.1888637244701385e-06, 4.7120265662670135e-06, 8.041970431804657e-06, 5.953945219516754e-06, 4.6477653086185455e-06, 4.7031790018081665e-06, 5.8640725910663605e-06, 4.660803824663162e-06, 4.6370550990104675e-06, 4.692003130912781e-06, 6.032176315784454e-06, 4.556961357593536e-06, 4.692934453487396e-06, 5.059875547885895e-06, 5.333218723535538e-06, 4.660803824663162e-06, 6.738118827342987e-06, 4.773028194904327e-06, 6.1891041696071625e-06, 4.732050001621246e-06, 4.692003130912781e-06, 5.0477683544158936e-06, 6.244983524084091e-06, 4.973262548446655e-06, 4.701782017946243e-06, 4.881992936134338e-06, 4.658941179513931e-06, 7.61495903134346e-06, 4.786066710948944e-06, 7.024034857749939e-06, 4.644971340894699e-06, 4.607252776622772e-06, 4.705972969532013e-06, 5.305744707584381e-06, 6.544869393110275e-06, 9.313225746154785e-06, 6.068963557481766e-06, 5.45009970664978e-06, 4.8531219363212585e-06, 4.603993147611618e-06, 7.366761565208435e-06, 4.731118679046631e-06, 7.3998235166072845e-06, 4.93926927447319e-06, 9.036622941493988e-06, 4.725996404886246e-06, 4.789326339960098e-06, 6.632879376411438e-06, 4.892237484455109e-06, 4.697591066360474e-06, 4.7460198402404785e-06, 4.695262759923935e-06, 7.154885679483414e-06, 5.070120096206665e-06, 4.563014954328537e-06, 4.478730261325836e-06, 7.022172212600708e-06], tpot=0.0, prompt_len=512, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 30.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  98.63     
Total input tokens:                      524288    
Total generated tokens:                  148771    
Request throughput (req/s):              10.38     
Output token throughput (tok/s):         1508.36   
Total Token throughput (tok/s):          6823.99   
---------------Time to First Token----------------
Mean TTFT (ms):                          46050.93  
Median TTFT (ms):                        50603.95  
P99 TTFT (ms):                           75777.36  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
