INFO 07-10 01:36:13 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=5.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-5-input-len-512-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=512, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and contexts. I'll try to break it down and provide some insights.\n\n**Observations:**\n\n1. **Mixed languages**: The text contains code snippets and keywords from multiple programming languages, including Java, Python, C++, and JavaScript.\n2. **Technical terms**: There are many technical terms and concepts mentioned, such as machine learning, data loading, GPIO, sensors, and more.\n3. **Company and product names**: Some company and product names are mentioned, like Volvo, Xiaomi, and macOS.\n4. **Geographic locations**: Several geographic locations are mentioned, including Brazil, Omaha, and Prague.\n5. **Random words and phrases**: The text also contains random words and phrases that don't seem to be related to any specific topic or context.\n\n**Possible explanations:**\n\n1. **Code dump**: It's possible that someone has dumped a large amount of code and text into a single block, without any organization or context.\n2. **Automated text generation**: The text might have been generated automatically using a tool or algorithm that combines different sources of text and code.\n3. **Error or glitch**:", success=True, latency=4.750075208954513, output_tokens=256, ttft=4.748674385715276, itl=[5.1524024456739426e-05, 2.1168962121009827e-05, 1.0063406080007553e-05, 7.0217065513134e-06, 5.764886736869812e-06, 6.341375410556793e-06, 5.602836608886719e-06, 5.648937076330185e-06, 5.123205482959747e-06, 5.119014531373978e-06, 5.245674401521683e-06, 4.851259291172028e-06, 5.182810127735138e-06, 4.8782676458358765e-06, 4.766974598169327e-06, 4.872679710388184e-06, 5.084089934825897e-06, 5.226116627454758e-06, 5.456153303384781e-06, 5.2908435463905334e-06, 4.9620866775512695e-06, 4.872679710388184e-06, 5.492009222507477e-06, 5.300156772136688e-06, 4.873145371675491e-06, 5.46872615814209e-06, 4.946254193782806e-06, 4.983041435480118e-06, 5.218666046857834e-06, 5.010049790143967e-06, 6.205402314662933e-06, 5.302950739860535e-06, 4.796776920557022e-06, 5.642883479595184e-06, 4.847999662160873e-06, 4.739966243505478e-06, 4.782341420650482e-06, 4.8857182264328e-06, 4.6622008085250854e-06, 4.687812179327011e-06, 4.898291081190109e-06, 5.8086588978767395e-06, 4.851259291172028e-06, 4.687812179327011e-06, 4.7818757593631744e-06, 4.822388291358948e-06, 5.900859832763672e-06, 4.990957677364349e-06, 4.879198968410492e-06, 4.696659743785858e-06, 4.820059984922409e-06, 5.329027771949768e-06, 4.8568472266197205e-06, 5.713198333978653e-06, 4.974193871021271e-06, 4.883855581283569e-06, 4.909932613372803e-06, 5.03193587064743e-06, 4.7762878239154816e-06, 5.566049367189407e-06, 4.862900823354721e-06, 5.27501106262207e-06, 4.759989678859711e-06, 4.847068339586258e-06, 5.589798092842102e-06, 5.124136805534363e-06, 6.025657057762146e-06, 5.120411515235901e-06, 4.8908405005931854e-06, 4.99701127409935e-06, 4.912726581096649e-06, 4.693400114774704e-06, 4.907604306936264e-06, 5.568377673625946e-06, 4.7800131142139435e-06, 4.851724952459335e-06, 4.807021468877792e-06, 6.327871233224869e-06, 5.443114787340164e-06, 5.098059773445129e-06, 4.791188985109329e-06, 5.028676241636276e-06, 4.789326339960098e-06, 5.398876965045929e-06, 4.833098500967026e-06, 5.41098415851593e-06, 4.932750016450882e-06, 4.7762878239154816e-06, 5.959998816251755e-06, 4.775822162628174e-06, 4.683155566453934e-06, 4.652887582778931e-06, 5.003996193408966e-06, 6.835907697677612e-06, 5.977228283882141e-06, 5.40073961019516e-06, 4.667323082685471e-06, 4.705972969532013e-06, 5.373731255531311e-06, 5.037989467382431e-06, 4.855915904045105e-06, 4.708301275968552e-06, 5.114823579788208e-06, 4.7371722757816315e-06, 4.766974598169327e-06, 4.785135388374329e-06, 5.144625902175903e-06, 4.567205905914307e-06, 4.692003130912781e-06, 7.6158903539180756e-06, 4.935078322887421e-06, 4.908069968223572e-06, 4.776753485202789e-06, 4.658009856939316e-06, 4.777219146490097e-06, 5.309935659170151e-06, 4.698056727647781e-06, 5.255918949842453e-06, 4.689209163188934e-06, 4.71901148557663e-06, 4.932750016450882e-06, 4.90015372633934e-06, 7.139984518289566e-06, 5.6247226893901825e-06, 5.54695725440979e-06, 5.154404789209366e-06, 4.696659743785858e-06, 4.749279469251633e-06, 4.667788743972778e-06, 7.293187081813812e-06, 5.2908435463905334e-06, 4.7460198402404785e-06, 4.704110324382782e-06, 5.454756319522858e-06, 5.061272531747818e-06, 4.946719855070114e-06, 5.098991096019745e-06, 4.7292560338974e-06, 4.9229711294174194e-06, 4.83216717839241e-06, 4.78280708193779e-06, 5.4407864809036255e-06, 5.656387656927109e-06, 4.803761839866638e-06, 4.678964614868164e-06, 5.295034497976303e-06, 5.076173692941666e-06, 5.631707608699799e-06, 4.800036549568176e-06, 6.642192602157593e-06, 5.737878382205963e-06, 5.152076482772827e-06, 4.888046532869339e-06, 4.868023097515106e-06, 4.7907233238220215e-06, 5.003064870834351e-06, 5.022156983613968e-06, 4.783738404512405e-06, 4.895031452178955e-06, 5.315057933330536e-06, 4.909932613372803e-06, 4.688277840614319e-06, 4.739966243505478e-06, 4.661735147237778e-06, 4.738103598356247e-06, 4.712957888841629e-06, 5.583278834819794e-06, 4.618894308805466e-06, 6.597023457288742e-06, 4.807021468877792e-06, 4.802830517292023e-06, 5.539972335100174e-06, 5.207955837249756e-06, 6.3050538301467896e-06, 5.031004548072815e-06, 4.773028194904327e-06, 4.8549845814704895e-06, 4.631001502275467e-06, 5.587004125118256e-06, 4.7371722757816315e-06, 4.854053258895874e-06, 4.733912646770477e-06, 4.983041435480118e-06, 4.656147211790085e-06, 5.820766091346741e-06, 4.998873919248581e-06, 4.86103817820549e-06, 4.906207323074341e-06, 4.750676453113556e-06, 4.982110112905502e-06, 4.706904292106628e-06, 4.708301275968552e-06, 6.681773811578751e-06, 4.731118679046631e-06, 4.624947905540466e-06, 4.773028194904327e-06, 5.587935447692871e-06, 5.0943344831466675e-06, 4.717614501714706e-06, 5.157198756933212e-06, 4.85079362988472e-06, 7.028225809335709e-06, 6.0820020735263824e-06, 4.895031452178955e-06, 4.706904292106628e-06, 5.8659352362155914e-06, 4.785135388374329e-06, 4.721805453300476e-06, 4.948116838932037e-06, 5.7998113334178925e-06, 4.856381565332413e-06, 4.680827260017395e-06, 5.208887159824371e-06, 5.417037755250931e-06, 7.727183401584625e-06, 6.330665200948715e-06, 4.7762878239154816e-06, 6.0908496379852295e-06, 4.82192263007164e-06, 4.631001502275467e-06, 4.948116838932037e-06, 7.377937436103821e-06, 5.055218935012817e-06, 4.860106855630875e-06, 4.694797098636627e-06, 4.814937710762024e-06, 6.313901394605637e-06, 4.854053258895874e-06, 5.9711746871471405e-06, 4.7888606786727905e-06, 4.833098500967026e-06, 4.759058356285095e-06, 4.773959517478943e-06, 7.078051567077637e-06, 7.1818940341472626e-06, 5.81890344619751e-06, 5.031004548072815e-06, 4.718080163002014e-06, 4.6300701797008514e-06, 6.648711860179901e-06, 4.838220775127411e-06, 5.335081368684769e-06, 4.922039806842804e-06, 6.353948265314102e-06, 4.956033080816269e-06, 4.621688276529312e-06, 6.145332008600235e-06, 5.095731467008591e-06, 4.636123776435852e-06, 4.671979695558548e-06, 5.031004548072815e-06, 6.316229701042175e-06, 5.337875336408615e-06, 4.925765097141266e-06, 4.705972969532013e-06, 6.637070327997208e-06], tpot=0.0, prompt_len=512, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 5.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     926       
Benchmark duration (s):                  217.18    
Total input tokens:                      474112    
Total generated tokens:                  198204    
Request throughput (req/s):              4.26      
Output token throughput (tok/s):         912.62    
Total Token throughput (tok/s):          3095.66   
---------------Time to First Token----------------
Mean TTFT (ms):                          7641.17   
Median TTFT (ms):                        8139.65   
P99 TTFT (ms):                           11894.32  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
