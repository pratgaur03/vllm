INFO 07-10 00:50:14 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=50.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-50-input-len-512-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=512, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and contexts. I'll try to break it down and provide some insights.\n\n**Observations:**\n\n1. **Mixed languages**: The text contains code snippets and keywords from multiple programming languages, including Java, Python, C++, and JavaScript.\n2. **Technical terms**: There are many technical terms and concepts mentioned, such as machine learning, data loading, GPIO, sensors, and more.\n3. **Company and product names**: Some company and product names are mentioned, like Volvo, Xiaomi, and macOS.\n4. **Geographic locations**: Several geographic locations are mentioned, including Brazil, Omaha, and Prague.\n5. **Random words and phrases**: The text also contains random words and phrases that don't seem to be related to any specific topic or context.\n\n**Possible explanations:**\n\n1. **Code dump**: It's possible that someone has dumped a large amount of code and text into a single block, without any organization or context.\n2. **Automated text generation**: The text might have been generated automatically using a tool or algorithm that combines different sources of text and code.\n3. **Error or glitch**:", success=True, latency=4.644174552056938, output_tokens=256, ttft=4.642776278778911, itl=[4.8486050218343735e-05, 1.7358921468257904e-05, 9.400304406881332e-06, 6.441958248615265e-06, 5.726702511310577e-06, 5.987007170915604e-06, 5.384441465139389e-06, 5.20097091794014e-06, 5.140900611877441e-06, 5.428679287433624e-06, 4.966277629137039e-06, 5.139969289302826e-06, 5.1781535148620605e-06, 4.875939339399338e-06, 5.123671144247055e-06, 5.117151886224747e-06, 4.973262548446655e-06, 5.405861884355545e-06, 5.300156772136688e-06, 5.273614078760147e-06, 4.966277629137039e-06, 4.958827048540115e-06, 5.633104592561722e-06, 5.293171852827072e-06, 5.160924047231674e-06, 5.337875336408615e-06, 4.949979484081268e-06, 5.193985998630524e-06, 5.311798304319382e-06, 5.18234446644783e-06, 5.879905074834824e-06, 5.193054676055908e-06, 4.804693162441254e-06, 5.552079528570175e-06, 5.115289241075516e-06, 5.166977643966675e-06, 5.046837031841278e-06, 4.904810339212418e-06, 4.866160452365875e-06, 4.944857209920883e-06, 4.959292709827423e-06, 5.458015948534012e-06, 5.183741450309753e-06, 4.834029823541641e-06, 4.982110112905502e-06, 4.858244210481644e-06, 5.6568533182144165e-06, 5.024950951337814e-06, 5.003996193408966e-06, 5.008187144994736e-06, 5.187001079320908e-06, 5.4426491260528564e-06, 4.942063242197037e-06, 5.788169801235199e-06, 5.121808499097824e-06, 4.976987838745117e-06, 5.298294126987457e-06, 4.983041435480118e-06, 5.309935659170151e-06, 5.5157579481601715e-06, 4.9942173063755035e-06, 5.220063030719757e-06, 4.903879016637802e-06, 5.0817616283893585e-06, 5.390029400587082e-06, 5.151145160198212e-06, 5.745794624090195e-06, 5.342066287994385e-06, 4.835892468690872e-06, 5.00120222568512e-06, 4.9658119678497314e-06, 4.925299435853958e-06, 4.8908405005931854e-06, 5.469191819429398e-06, 4.88990917801857e-06, 4.802830517292023e-06, 4.9942173063755035e-06, 6.369780749082565e-06, 5.631241947412491e-06, 5.0747767090797424e-06, 5.0729140639305115e-06, 4.964414983987808e-06, 4.864763468503952e-06, 5.266163498163223e-06, 4.835892468690872e-06, 5.436129868030548e-06, 5.068723112344742e-06, 4.93321567773819e-06, 5.44404610991478e-06, 4.956964403390884e-06, 5.013775080442429e-06, 4.8140063881874084e-06, 4.976987838745117e-06, 6.177928298711777e-06, 6.108079105615616e-06, 5.31412661075592e-06, 5.084089934825897e-06, 4.935078322887421e-06, 5.024950951337814e-06, 5.209818482398987e-06, 4.932284355163574e-06, 5.059875547885895e-06, 5.1907263696193695e-06, 4.9532391130924225e-06, 4.9280934035778046e-06, 4.9229711294174194e-06, 5.103647708892822e-06, 4.790257662534714e-06, 5.073845386505127e-06, 6.441958248615265e-06, 5.0282105803489685e-06, 5.125068128108978e-06, 5.078036338090897e-06, 5.22984191775322e-06, 4.883855581283569e-06, 5.1353126764297485e-06, 5.0389207899570465e-06, 5.0747767090797424e-06, 4.806090146303177e-06, 4.862900823354721e-06, 5.316920578479767e-06, 5.025416612625122e-06, 4.970002919435501e-06, 5.452893674373627e-06, 4.9551017582416534e-06, 5.068723112344742e-06, 4.723202437162399e-06, 5.0300732254981995e-06, 5.035661160945892e-06, 6.3963234424591064e-06, 5.487818270921707e-06, 4.943925887346268e-06, 4.7888606786727905e-06, 4.9551017582416534e-06, 5.282927304506302e-06, 4.986301064491272e-06, 4.983972758054733e-06, 4.944857209920883e-06, 4.881992936134338e-06, 5.262903869152069e-06, 4.974193871021271e-06, 5.022156983613968e-06, 5.596783012151718e-06, 5.502253770828247e-06, 4.917848855257034e-06, 4.993751645088196e-06, 5.292240530252457e-06, 4.9299560487270355e-06, 5.173962563276291e-06, 6.4861960709095e-06, 5.155801773071289e-06, 5.165114998817444e-06, 4.977919161319733e-06, 4.89410012960434e-06, 5.031004548072815e-06, 4.930887371301651e-06, 4.934147000312805e-06, 4.875939339399338e-06, 4.789792001247406e-06, 5.8622099459171295e-06, 4.905741661787033e-06, 4.873145371675491e-06, 4.774890840053558e-06, 5.41098415851593e-06, 5.0389207899570465e-06, 4.860106855630875e-06, 5.0603412091732025e-06, 4.882924258708954e-06, 5.788635462522507e-06, 4.998408257961273e-06, 4.764646291732788e-06, 5.704350769519806e-06, 5.020759999752045e-06, 5.922280251979828e-06, 5.377922207117081e-06, 5.65405935049057e-06, 4.973728209733963e-06, 4.779081791639328e-06, 4.970934242010117e-06, 5.00725582242012e-06, 5.0906091928482056e-06, 4.881992936134338e-06, 4.875008016824722e-06, 4.773028194904327e-06, 5.511101335287094e-06, 5.061272531747818e-06, 4.970934242010117e-06, 5.051027983427048e-06, 4.875008016824722e-06, 5.173031240701675e-06, 4.913657903671265e-06, 4.967208951711655e-06, 1.063477247953415e-05, 4.886183887720108e-06, 4.8568472266197205e-06, 4.705972969532013e-06, 5.673151463270187e-06, 5.135778337717056e-06, 5.236361175775528e-06, 5.3318217396736145e-06, 4.862900823354721e-06, 6.217043846845627e-06, 6.336253136396408e-06, 5.0067901611328125e-06, 4.907138645648956e-06, 5.383975803852081e-06, 4.881992936134338e-06, 4.836823791265488e-06, 4.823319613933563e-06, 5.857553333044052e-06, 4.923436790704727e-06, 4.744622856378555e-06, 5.042180418968201e-06, 5.121808499097824e-06, 4.809349775314331e-06, 5.566049367189407e-06, 5.108769983053207e-06, 6.404239684343338e-06, 4.950910806655884e-06, 4.895031452178955e-06, 5.133915692567825e-06, 5.967915058135986e-06, 5.0282105803489685e-06, 4.925765097141266e-06, 4.90015372633934e-06, 4.661735147237778e-06, 5.5069103837013245e-06, 4.9551017582416534e-06, 6.1802566051483154e-06, 4.971865564584732e-06, 4.759989678859711e-06, 4.687812179327011e-06, 5.061272531747818e-06, 6.597023457288742e-06, 6.833113729953766e-06, 5.929730832576752e-06, 5.2871182560920715e-06, 4.733912646770477e-06, 4.895031452178955e-06, 6.161164492368698e-06, 5.1567330956459045e-06, 5.398876965045929e-06, 4.9532391130924225e-06, 5.519948899745941e-06, 4.841014742851257e-06, 4.949048161506653e-06, 6.1211176216602325e-06, 5.137640982866287e-06, 4.7800131142139435e-06, 4.890374839305878e-06, 4.993751645088196e-06, 4.801899194717407e-06, 4.739966243505478e-06, 4.838220775127411e-06, 4.834961146116257e-06, 6.697140634059906e-06], tpot=0.0, prompt_len=512, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 50.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  97.57     
Total input tokens:                      524288    
Total generated tokens:                  146802    
Request throughput (req/s):              10.50     
Output token throughput (tok/s):         1504.65   
Total Token throughput (tok/s):          6878.35   
---------------Time to First Token----------------
Mean TTFT (ms):                          50941.24  
Median TTFT (ms):                        55824.92  
P99 TTFT (ms):                           83484.85  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.01      
P99 ITL (ms):                            0.01      
==================================================
