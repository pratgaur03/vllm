INFO 07-10 01:03:30 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=40.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-40-input-len-512-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=512, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and contexts. I'll try to break it down and provide some insights.\n\n**Observations:**\n\n1. **Mixed languages**: The text contains code snippets and keywords from multiple programming languages, including Java, Python, C++, and JavaScript.\n2. **Technical terms**: There are many technical terms and concepts mentioned, such as machine learning, data loading, GPIO, sensors, and more.\n3. **Company and product names**: Some company and product names are mentioned, like Volvo, Xiaomi, and macOS.\n4. **Geographic locations**: Several geographic locations are mentioned, including Brazil, Omaha, and Prague.\n5. **Random words and phrases**: The text also contains random words and phrases that don't seem to be related to any specific topic or context.\n\n**Possible explanations:**\n\n1. **Code dump**: It's possible that someone has dumped a large amount of code and text into a single block, without any organization or context.\n2. **Automated text generation**: The text might have been generated automatically using a tool or algorithm that combines different sources of text and code.\n3. **Error or glitch**:", success=True, latency=4.657676933333278, output_tokens=256, ttft=4.6563077149912715, itl=[4.5301392674446106e-05, 1.6259029507637024e-05, 8.771661669015884e-06, 6.3711777329444885e-06, 5.344860255718231e-06, 5.847308784723282e-06, 5.350913852453232e-06, 4.9578957259655e-06, 4.7120265662670135e-06, 4.81773167848587e-06, 4.870351403951645e-06, 4.868954420089722e-06, 5.4710544645786285e-06, 4.7120265662670135e-06, 4.808884114027023e-06, 4.905741661787033e-06, 5.027279257774353e-06, 5.335081368684769e-06, 5.100853741168976e-06, 5.0361268222332e-06, 4.815869033336639e-06, 4.7371722757816315e-06, 5.360692739486694e-06, 5.123205482959747e-06, 4.810746759176254e-06, 5.0282105803489685e-06, 4.911795258522034e-06, 5.073379725217819e-06, 5.066860467195511e-06, 4.88990917801857e-06, 5.811918526887894e-06, 5.043111741542816e-06, 4.847068339586258e-06, 5.356967449188232e-06, 4.871748387813568e-06, 4.886183887720108e-06, 4.914123564958572e-06, 4.870817065238953e-06, 4.7441571950912476e-06, 4.75812703371048e-06, 4.7548674046993256e-06, 5.488749593496323e-06, 4.847068339586258e-06, 4.779081791639328e-06, 4.833098500967026e-06, 4.912726581096649e-06, 5.25033101439476e-06, 4.739966243505478e-06, 4.765111953020096e-06, 4.644971340894699e-06, 4.871748387813568e-06, 5.142297595739365e-06, 5.185604095458984e-06, 5.600973963737488e-06, 4.7674402594566345e-06, 5.0067901611328125e-06, 5.083158612251282e-06, 4.793982952833176e-06, 4.915986210107803e-06, 5.214940756559372e-06, 4.766974598169327e-06, 5.107838660478592e-06, 5.04031777381897e-06, 4.892703145742416e-06, 4.970934242010117e-06, 5.144160240888596e-06, 5.734153091907501e-06, 4.859641194343567e-06, 4.833098500967026e-06, 4.819128662347794e-06, 4.841946065425873e-06, 4.621222615242004e-06, 4.7818757593631744e-06, 5.16790896654129e-06, 4.808884114027023e-06, 4.697125405073166e-06, 4.785135388374329e-06, 5.878042429685593e-06, 5.377922207117081e-06, 7.804017513990402e-06, 4.9336813390254974e-06, 4.999339580535889e-06, 4.94765117764473e-06, 5.38630411028862e-06, 4.862900823354721e-06, 5.105976015329361e-06, 4.881992936134338e-06, 4.816800355911255e-06, 5.331356078386307e-06, 4.770699888467789e-06, 5.0943344831466675e-06, 4.91878017783165e-06, 4.914123564958572e-06, 6.250105798244476e-06, 5.661044269800186e-06, 5.316920578479767e-06, 4.917848855257034e-06, 5.208887159824371e-06, 5.297362804412842e-06, 4.892703145742416e-06, 4.665926098823547e-06, 4.695262759923935e-06, 5.4300762712955475e-06, 4.7800131142139435e-06, 4.7800131142139435e-06, 4.9658119678497314e-06, 5.3979456424713135e-06, 4.862900823354721e-06, 4.751142114400864e-06, 6.559770554304123e-06, 4.958361387252808e-06, 4.893634468317032e-06, 4.9122609198093414e-06, 4.707835614681244e-06, 4.791188985109329e-06, 5.0370581448078156e-06, 4.786066710948944e-06, 5.127862095832825e-06, 4.802830517292023e-06, 4.7693029046058655e-06, 4.893634468317032e-06, 5.325302481651306e-06, 5.0729140639305115e-06, 5.232170224189758e-06, 4.796776920557022e-06, 5.4049305617809296e-06, 4.818197339773178e-06, 4.784669727087021e-06, 4.6030618250370026e-06, 6.023328751325607e-06, 5.071982741355896e-06, 5.0496309995651245e-06, 4.8032961785793304e-06, 4.881992936134338e-06, 4.775822162628174e-06, 4.811212420463562e-06, 4.762783646583557e-06, 4.828907549381256e-06, 5.298294126987457e-06, 5.30807301402092e-06, 4.945788532495499e-06, 5.296897143125534e-06, 5.451962351799011e-06, 4.8531219363212585e-06, 4.7050416469573975e-06, 5.335081368684769e-06, 5.027744919061661e-06, 5.65405935049057e-06, 5.456153303384781e-06, 6.295740604400635e-06, 5.581416189670563e-06, 5.212612450122833e-06, 4.770234227180481e-06, 5.086883902549744e-06, 4.936009645462036e-06, 4.980247467756271e-06, 4.791654646396637e-06, 4.791188985109329e-06, 4.837755113840103e-06, 5.418434739112854e-06, 4.760921001434326e-06, 4.791654646396637e-06, 4.867091774940491e-06, 5.340203642845154e-06, 4.7907233238220215e-06, 4.766974598169327e-06, 4.855450242757797e-06, 5.05475327372551e-06, 6.1960890889167786e-06, 4.840083420276642e-06, 4.891771823167801e-06, 5.4962001740932465e-06, 5.121808499097824e-06, 5.634967237710953e-06, 5.163252353668213e-06, 5.066860467195511e-06, 4.820059984922409e-06, 4.759058356285095e-06, 5.616806447505951e-06, 4.903879016637802e-06, 5.021225661039352e-06, 6.06803223490715e-06, 4.858709871768951e-06, 5.0370581448078156e-06, 5.55114820599556e-06, 5.091074854135513e-06, 4.9639493227005005e-06, 4.9727968871593475e-06, 4.872214049100876e-06, 4.9658119678497314e-06, 4.811212420463562e-06, 4.905741661787033e-06, 6.051268428564072e-06, 4.8121437430381775e-06, 4.774890840053558e-06, 4.736706614494324e-06, 5.547422915697098e-06, 5.009584128856659e-06, 4.875008016824722e-06, 5.177222192287445e-06, 4.795845597982407e-06, 6.549060344696045e-06, 5.781184881925583e-06, 4.978850483894348e-06, 5.06499782204628e-06, 5.375128239393234e-06, 5.078036338090897e-06, 4.727859050035477e-06, 4.800036549568176e-06, 5.485955625772476e-06, 5.031004548072815e-06, 4.859175533056259e-06, 4.843808710575104e-06, 5.275942385196686e-06, 4.793982952833176e-06, 5.194917321205139e-06, 4.83635812997818e-06, 5.61494380235672e-06, 4.800967872142792e-06, 5.007721483707428e-06, 5.3229741752147675e-06, 5.779322236776352e-06, 4.766974598169327e-06, 4.872679710388184e-06, 4.770234227180481e-06, 4.90015372633934e-06, 5.795620381832123e-06, 5.059409886598587e-06, 5.7746656239032745e-06, 4.90434467792511e-06, 4.8978254199028015e-06, 4.855915904045105e-06, 4.936940968036652e-06, 6.5462663769721985e-06, 6.6729262471199036e-06, 5.8640725910663605e-06, 5.065929144620895e-06, 4.912726581096649e-06, 4.852190613746643e-06, 6.0289166867733e-06, 5.0798989832401276e-06, 5.824025720357895e-06, 4.7869980335235596e-06, 6.502959877252579e-06, 4.9872323870658875e-06, 4.7390349209308624e-06, 6.401911377906799e-06, 4.903879016637802e-06, 4.75812703371048e-06, 4.834029823541641e-06, 4.922039806842804e-06, 5.160924047231674e-06, 4.670117050409317e-06, 4.760921001434326e-06, 4.735775291919708e-06, 6.249174475669861e-06], tpot=0.0, prompt_len=512, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 40.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  97.03     
Total input tokens:                      524288    
Total generated tokens:                  146682    
Request throughput (req/s):              10.55     
Output token throughput (tok/s):         1511.79   
Total Token throughput (tok/s):          6915.40   
---------------Time to First Token----------------
Mean TTFT (ms):                          49347.64  
Median TTFT (ms):                        54959.41  
P99 TTFT (ms):                           79619.31  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
