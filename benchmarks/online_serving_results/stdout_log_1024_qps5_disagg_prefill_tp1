INFO 07-08 00:14:14 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=100, logprobs=None, request_rate=5.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-5-input-len-1024-tp-1.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=1024, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages, including Java, Python, and JavaScript. The text also includes fragments of sentences, names, and words from different languages, such as English, Spanish, French, and Portuguese.\n\nAfter analyzing the text, I\'ve identified some common themes and topics that emerge:\n\n1. **Programming and software development**: The text includes code snippets, function names, and technical terms related to programming, such as "DataLoader," "GPIO," "Redux," and "Swagger."\n2. **Artificial intelligence and machine learning**: There are mentions of AI-related concepts, like "neural networks," "deep learning," and "natural language processing."\n3. **Data science and analytics**: The text includes terms like "data visualization," "data mining," and "statistical analysis."\n4. **Computer science and IT**: The text mentions topics like "computer networks," "cybersecurity," and "database management."\n5. **Business and finance**: There are references to business-related concepts, such as "marketing," "finance," and "e-commerce."\n6. **Geography and culture**: The text includes names of cities, countries,', success=True, latency=7.906101785600185, output_tokens=256, ttft=7.904765490908176, itl=[4.458008334040642e-05, 1.8159858882427216e-05, 9.353738278150558e-06, 6.572343409061432e-06, 5.198642611503601e-06, 5.7513825595378876e-06, 5.027744919061661e-06, 5.017966032028198e-06, 4.7292560338974e-06, 4.8317015171051025e-06, 4.827044904232025e-06, 4.847068339586258e-06, 5.1390379667282104e-06, 4.836823791265488e-06, 4.749279469251633e-06, 4.7138892114162445e-06, 4.862900823354721e-06, 5.058012902736664e-06, 4.935078322887421e-06, 5.441252142190933e-06, 4.687812179327011e-06, 4.599802196025848e-06, 5.7872384786605835e-06, 5.119945853948593e-06, 4.801899194717407e-06, 5.078967660665512e-06, 4.882924258708954e-06, 4.805158823728561e-06, 4.833098500967026e-06, 4.8978254199028015e-06, 5.645211786031723e-06, 5.0049275159835815e-06, 4.644040018320084e-06, 5.261041224002838e-06, 4.639849066734314e-06, 4.804227501153946e-06, 4.964880645275116e-06, 4.739966243505478e-06, 4.990957677364349e-06, 4.755798727273941e-06, 4.777219146490097e-06, 5.313195288181305e-06, 4.634726792573929e-06, 4.795845597982407e-06, 4.97838482260704e-06, 4.904810339212418e-06, 4.827976226806641e-06, 4.819128662347794e-06, 4.732981324195862e-06, 4.760921001434326e-06, 4.639849066734314e-06, 4.898291081190109e-06, 4.869885742664337e-06, 5.2531249821186066e-06, 5.06080687046051e-06, 4.860106855630875e-06, 4.673842340707779e-06, 5.197245627641678e-06, 4.6049244701862335e-06, 4.775822162628174e-06, 4.644040018320084e-06, 5.0961971282958984e-06, 4.733912646770477e-06, 4.661735147237778e-06, 5.083158612251282e-06, 5.105976015329361e-06, 4.667323082685471e-06, 5.841720849275589e-06, 4.6459026634693146e-06, 4.956964403390884e-06, 4.915986210107803e-06, 4.736240953207016e-06, 4.573725163936615e-06, 4.748348146677017e-06, 5.465000867843628e-06, 4.777684807777405e-06, 5.1781535148620605e-06, 5.621928721666336e-06, 4.709232598543167e-06, 5.013775080442429e-06, 4.599336534738541e-06, 4.61190938949585e-06, 5.130656063556671e-06, 4.99701127409935e-06, 4.627276211977005e-06, 4.705972969532013e-06, 4.842877388000488e-06, 5.288049578666687e-06, 4.732050001621246e-06, 4.875008016824722e-06, 5.364883691072464e-06, 4.847999662160873e-06, 4.93926927447319e-06, 6.052665412425995e-06, 5.31412661075592e-06, 4.644040018320084e-06, 4.6710483729839325e-06, 4.779081791639328e-06, 5.539972335100174e-06, 4.7120265662670135e-06, 4.81773167848587e-06, 5.7192519307136536e-06, 4.848930984735489e-06, 4.724133759737015e-06, 4.599802196025848e-06, 4.740897566080093e-06, 5.455221980810165e-06, 4.9299560487270355e-06, 4.692003130912781e-06, 5.9050507843494415e-06, 5.065929144620895e-06, 4.760921001434326e-06, 4.6570785343647e-06, 4.891771823167801e-06, 5.204230546951294e-06, 5.033798515796661e-06, 4.7371722757816315e-06, 4.766974598169327e-06, 4.637986421585083e-06, 6.352085620164871e-06, 4.914123564958572e-06, 4.740897566080093e-06, 4.841014742851257e-06, 5.37186861038208e-06, 4.9192458391189575e-06, 4.7585926949977875e-06, 4.590023308992386e-06, 4.588160663843155e-06, 4.658009856939316e-06, 5.972106009721756e-06, 5.254056304693222e-06, 4.706904292106628e-06, 4.847068339586258e-06, 4.61190938949585e-06, 4.75812703371048e-06, 4.893634468317032e-06, 5.258247256278992e-06, 4.7977082431316376e-06, 4.745088517665863e-06, 4.882924258708954e-06, 4.76418063044548e-06, 4.697125405073166e-06, 5.338806658983231e-06, 4.90015372633934e-06, 4.5280903577804565e-06, 4.759989678859711e-06, 5.292706191539764e-06, 4.691071808338165e-06, 4.833098500967026e-06, 6.568152457475662e-06, 5.349051207304001e-06, 5.096662789583206e-06, 4.757195711135864e-06, 4.901085048913956e-06, 4.871748387813568e-06, 4.859175533056259e-06, 5.2801333367824554e-06, 4.942994564771652e-06, 4.753004759550095e-06, 4.7548674046993256e-06, 4.559755325317383e-06, 4.843343049287796e-06, 4.7567300498485565e-06, 4.861969500780106e-06, 4.706904292106628e-06, 4.584435373544693e-06, 6.023794412612915e-06, 4.750210791826248e-06, 5.2568502724170685e-06, 4.839152097702026e-06, 4.643574357032776e-06, 4.650093615055084e-06, 6.569083780050278e-06, 6.00423663854599e-06, 5.484558641910553e-06, 4.7120265662670135e-06, 4.5602209866046906e-06, 4.623085260391235e-06, 5.3998082876205444e-06, 4.625879228115082e-06, 4.683155566453934e-06, 4.686880856752396e-06, 5.28339296579361e-06, 4.917848855257034e-06, 4.923902451992035e-06, 4.667788743972778e-06, 4.699453711509705e-06, 4.766974598169327e-06, 4.663597792387009e-06, 5.740206688642502e-06, 4.83216717839241e-06, 4.631001502275467e-06, 4.595611244440079e-06, 5.5730342864990234e-06, 4.868954420089722e-06, 4.63239848613739e-06, 4.810746759176254e-06, 4.75812703371048e-06, 4.658009856939316e-06, 5.383975803852081e-06, 4.805158823728561e-06, 5.909707397222519e-06, 5.61913475394249e-06, 4.727859050035477e-06, 4.704110324382782e-06, 4.752073436975479e-06, 5.4319389164447784e-06, 4.828907549381256e-06, 4.685018211603165e-06, 4.642177373170853e-06, 5.017966032028198e-06, 5.026813596487045e-06, 4.6370550990104675e-06, 4.756264388561249e-06, 5.851965397596359e-06, 4.7818757593631744e-06, 4.673842340707779e-06, 5.275942385196686e-06, 4.762317985296249e-06, 4.6407803893089294e-06, 5.705282092094421e-06, 4.803761839866638e-06, 5.781184881925583e-06, 4.960689693689346e-06, 5.610287189483643e-06, 4.787929356098175e-06, 4.726927727460861e-06, 4.83216717839241e-06, 4.737637937068939e-06, 4.766043275594711e-06, 4.610978066921234e-06, 5.25033101439476e-06, 4.8996880650520325e-06, 5.6801363825798035e-06, 4.903879016637802e-06, 4.631932824850082e-06, 5.322042852640152e-06, 5.024950951337814e-06, 4.69619408249855e-06, 4.847999662160873e-06, 4.678964614868164e-06, 5.183275789022446e-06, 4.757661372423172e-06, 4.541128873825073e-06, 4.716217517852783e-06, 5.109701305627823e-06, 4.848930984735489e-06, 4.725996404886246e-06, 4.644040018320084e-06, 4.785135388374329e-06, 5.015172064304352e-06, 6.560701876878738e-06, 5.058944225311279e-06, 4.83635812997818e-06, 4.75393608212471e-06, 5.376990884542465e-06], tpot=0.0, prompt_len=1024, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 5.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     100       
Benchmark duration (s):                  55.48     
Total input tokens:                      102400    
Total generated tokens:                  21815     
Request throughput (req/s):              1.80      
Output token throughput (tok/s):         393.23    
Total Token throughput (tok/s):          2239.07   
---------------Time to First Token----------------
Mean TTFT (ms):                          35030.61  
Median TTFT (ms):                        34100.24  
P99 TTFT (ms):                           49665.51  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.00      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
