INFO 07-10 22:58:58 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=20.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-20-input-len-256-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=256, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I\'ll try to break it down and provide some insights:\n\n**Programming languages and frameworks:**\n\n* Java (e.g., `@NoArgsConstructor`, `Parcelable`)\n* Python (e.g., `pd`, `numpy`)\n* JavaScript (e.g., `OnClickListener`, `Component`)\n* C++ (e.g., `GPIO`)\n* Kotlin (e.g., `data class`)\n\n**Domains and topics:**\n\n* Machine learning (e.g., `DataLoader`, `estimator`)\n* Android development (e.g., `OnClickListener`, `Parcelable`)\n* Web development (e.g., `Component`, `React`)\n* IoT (e.g., `GPIO`)\n* Finance (e.g., `NYSE`, `profit`)\n* Geography (e.g., `Latitude`, `Longitude`)\n* Politics (e.g., `Cuomo`, `Judicial`)\n\n**Other observations:**\n\n* There are many typos and grammatical errors throughout the text.\n* Some words and phrases appear to be randomly inserted or concatenated (e.g., `cheng Milit"&finding`, `flotation.sensorBrazil`).\n* There', success=True, latency=4.688675012439489, output_tokens=256, ttft=4.687343442346901, itl=[4.734192043542862e-05, 1.574493944644928e-05, 9.636860340833664e-06, 6.62636011838913e-06, 5.276873707771301e-06, 6.023794412612915e-06, 5.233101546764374e-06, 5.267094820737839e-06, 5.166046321392059e-06, 5.062669515609741e-06, 4.83635812997818e-06, 4.978850483894348e-06, 4.818197339773178e-06, 4.807952791452408e-06, 4.673842340707779e-06, 4.899222403764725e-06, 4.77861613035202e-06, 5.2801333367824554e-06, 5.187932401895523e-06, 5.115289241075516e-06, 4.802830517292023e-06, 4.814937710762024e-06, 5.7569704949855804e-06, 5.1781535148620605e-06, 4.864763468503952e-06, 5.159061402082443e-06, 4.927162081003189e-06, 5.020759999752045e-06, 4.96814027428627e-06, 4.947185516357422e-06, 6.0927122831344604e-06, 5.187932401895523e-06, 4.8442743718624115e-06, 5.582813173532486e-06, 4.915054887533188e-06, 4.692003130912781e-06, 4.7478824853897095e-06, 4.9960799515247345e-06, 4.704110324382782e-06, 4.698988050222397e-06, 4.766974598169327e-06, 5.283858627080917e-06, 4.727393388748169e-06, 4.823785275220871e-06, 4.7869980335235596e-06, 4.687812179327011e-06, 5.812384188175201e-06, 5.195848643779755e-06, 5.056150257587433e-06, 4.98257577419281e-06, 4.893168807029724e-06, 4.926230758428574e-06, 5.007721483707428e-06, 5.6461431086063385e-06, 4.991888999938965e-06, 5.073845386505127e-06, 4.857312887907028e-06, 5.118083208799362e-06, 4.8857182264328e-06, 4.925299435853958e-06, 4.845671355724335e-06, 4.7050416469573975e-06, 5.301088094711304e-06, 4.875008016824722e-06, 4.7711655497550964e-06, 5.955807864665985e-06, 4.793982952833176e-06, 4.732050001621246e-06, 5.055218935012817e-06, 4.771631211042404e-06, 4.743225872516632e-06, 4.704110324382782e-06, 4.635658115148544e-06, 4.7460198402404785e-06, 4.610046744346619e-06, 4.689209163188934e-06, 4.6817585825920105e-06, 5.974899977445602e-06, 4.93321567773819e-06, 4.835892468690872e-06, 4.7818757593631744e-06, 4.773028194904327e-06, 4.695262759923935e-06, 4.7548674046993256e-06, 4.8140063881874084e-06, 5.166977643966675e-06, 4.830304533243179e-06, 4.966743290424347e-06, 4.79305163025856e-06, 4.823785275220871e-06, 4.89410012960434e-06, 5.245208740234375e-06, 4.7869980335235596e-06, 5.817972123622894e-06, 4.861969500780106e-06, 4.644040018320084e-06, 4.557892680168152e-06, 4.734843969345093e-06, 4.602130502462387e-06, 5.1711685955524445e-06, 4.732050001621246e-06, 4.7888606786727905e-06, 4.692003130912781e-06, 4.610978066921234e-06, 4.742760211229324e-06, 5.239155143499374e-06, 4.688277840614319e-06, 4.627741873264313e-06, 4.709232598543167e-06, 6.073620170354843e-06, 5.173031240701675e-06, 4.827976226806641e-06, 4.770234227180481e-06, 4.825182259082794e-06, 5.059875547885895e-06, 4.748813807964325e-06, 5.131121724843979e-06, 5.302950739860535e-06, 4.723202437162399e-06, 4.639849066734314e-06, 4.800036549568176e-06, 5.3551048040390015e-06, 4.631932824850082e-06, 4.912726581096649e-06, 4.746951162815094e-06, 4.945322871208191e-06, 4.7977082431316376e-06, 4.859175533056259e-06, 4.643108695745468e-06, 5.861744284629822e-06, 5.047302693128586e-06, 4.973728209733963e-06, 4.801899194717407e-06, 4.743225872516632e-06, 4.860106855630875e-06, 5.160924047231674e-06, 4.8140063881874084e-06, 5.003064870834351e-06, 4.573725163936615e-06, 4.827976226806641e-06, 4.695262759923935e-06, 4.793982952833176e-06, 5.027744919061661e-06, 4.86522912979126e-06, 4.795845597982407e-06, 5.260109901428223e-06, 4.710163921117783e-06, 4.816800355911255e-06, 4.761852324008942e-06, 6.556045264005661e-06, 4.786066710948944e-06, 4.637986421585083e-06, 4.724133759737015e-06, 5.539972335100174e-06, 4.765111953020096e-06, 4.618894308805466e-06, 4.578847438097e-06, 5.627050995826721e-06, 4.804227501153946e-06, 4.7869980335235596e-06, 4.678964614868164e-06, 4.732050001621246e-06, 4.590023308992386e-06, 5.341600626707077e-06, 4.907138645648956e-06, 4.891306161880493e-06, 4.67570498585701e-06, 4.784204065799713e-06, 4.707835614681244e-06, 4.76418063044548e-06, 4.7390349209308624e-06, 4.624947905540466e-06, 4.6067871153354645e-06, 5.86826354265213e-06, 4.990026354789734e-06, 4.994682967662811e-06, 4.777219146490097e-06, 4.707835614681244e-06, 4.680827260017395e-06, 4.799105226993561e-06, 4.79305163025856e-06, 5.38211315870285e-06, 4.773959517478943e-06, 4.780944436788559e-06, 4.671979695558548e-06, 5.173962563276291e-06, 4.911329597234726e-06, 4.696659743785858e-06, 4.745088517665863e-06, 4.7120265662670135e-06, 5.214940756559372e-06, 4.7441571950912476e-06, 4.796776920557022e-06, 5.088280886411667e-06, 4.861969500780106e-06, 4.705972969532013e-06, 4.7478824853897095e-06, 4.752073436975479e-06, 4.667788743972778e-06, 4.759989678859711e-06, 4.576984792947769e-06, 5.807261914014816e-06, 4.806090146303177e-06, 4.8568472266197205e-06, 4.6137720346450806e-06, 4.761386662721634e-06, 5.19677996635437e-06, 4.948116838932037e-06, 4.881992936134338e-06, 4.815869033336639e-06, 4.649162292480469e-06, 4.796776920557022e-06, 4.717148840427399e-06, 5.233101546764374e-06, 5.087815225124359e-06, 4.895031452178955e-06, 4.736240953207016e-06, 4.725996404886246e-06, 4.527624696493149e-06, 4.6282075345516205e-06, 5.57582825422287e-06, 4.931353032588959e-06, 4.709698259830475e-06, 4.736240953207016e-06, 4.735775291919708e-06, 4.742294549942017e-06, 4.621688276529312e-06, 5.149282515048981e-06, 4.961621016263962e-06, 4.651956260204315e-06, 5.072448402643204e-06, 4.779547452926636e-06, 5.226116627454758e-06, 5.876179784536362e-06, 5.200039595365524e-06, 4.763714969158173e-06, 4.734378308057785e-06, 5.342997610569e-06, 4.71901148557663e-06, 4.6156346797943115e-06, 4.643108695745468e-06, 4.757195711135864e-06, 4.678964614868164e-06, 4.834961146116257e-06, 4.687812179327011e-06, 4.906207323074341e-06, 5.136709660291672e-06, 5.027279257774353e-06, 4.7800131142139435e-06, 4.823785275220871e-06, 5.051959306001663e-06, 5.837995558977127e-06, 4.804227501153946e-06, 4.768837243318558e-06, 5.391892045736313e-06, 6.502028554677963e-06], tpot=0.0, prompt_len=256, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 20.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  69.22     
Total input tokens:                      262144    
Total generated tokens:                  116385    
Request throughput (req/s):              14.79     
Output token throughput (tok/s):         1681.45   
Total Token throughput (tok/s):          5468.72   
---------------Time to First Token----------------
Mean TTFT (ms):                          22187.68  
Median TTFT (ms):                        25266.01  
P99 TTFT (ms):                           43221.98  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
