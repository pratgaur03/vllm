INFO 07-10 23:18:22 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=10.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-10-input-len-256-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=256, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I\'ll try to break it down and provide some insights:\n\n**Programming languages and frameworks:**\n\n* Java (e.g., `@NoArgsConstructor`, `Parcelable`)\n* Python (e.g., `pd`, `numpy`)\n* JavaScript (e.g., `OnClickListener`, `Component`)\n* C++ (e.g., `GPIO`)\n* Kotlin (e.g., `data class`)\n\n**Domains and topics:**\n\n* Machine learning (e.g., `DataLoader`, `estimator`)\n* Android development (e.g., `OnClickListener`, `Parcelable`)\n* Web development (e.g., `Component`, `React`)\n* IoT (e.g., `GPIO`)\n* Finance (e.g., `NYSE`, `profit`)\n* Geography (e.g., `Latitude`, `Longitude`)\n* Politics (e.g., `Cuomo`, `Judicial`)\n\n**Other observations:**\n\n* There are many typos and grammatical errors throughout the text.\n* Some words and phrases appear to be randomly inserted or concatenated (e.g., `cheng Milit"&finding`, `flotation.sensorBrazil`).\n* There', success=True, latency=4.685591193381697, output_tokens=256, ttft=4.684239109046757, itl=[4.699314013123512e-05, 2.6819761842489243e-05, 1.0213349014520645e-05, 6.949063390493393e-06, 5.725771188735962e-06, 6.162095814943314e-06, 5.9730373322963715e-06, 5.3979456424713135e-06, 5.1031820476055145e-06, 5.19677996635437e-06, 4.915054887533188e-06, 4.944857209920883e-06, 5.021225661039352e-06, 4.691071808338165e-06, 4.989560693502426e-06, 4.925299435853958e-06, 4.914123564958572e-06, 5.30388206243515e-06, 4.966743290424347e-06, 5.054287612438202e-06, 4.8209913074970245e-06, 4.81773167848587e-06, 5.527399480342865e-06, 5.176756531000137e-06, 4.9229711294174194e-06, 5.459878593683243e-06, 4.851259291172028e-06, 5.120877176523209e-06, 4.991888999938965e-06, 5.241949111223221e-06, 5.795154720544815e-06, 4.855915904045105e-06, 4.731118679046631e-06, 5.311798304319382e-06, 4.998408257961273e-06, 4.775822162628174e-06, 4.785135388374329e-06, 4.876870661973953e-06, 4.976056516170502e-06, 4.834029823541641e-06, 4.734843969345093e-06, 5.356967449188232e-06, 4.841946065425873e-06, 4.665926098823547e-06, 4.8209913074970245e-06, 4.6943314373493195e-06, 5.466863512992859e-06, 5.261972546577454e-06, 4.820059984922409e-06, 4.978850483894348e-06, 4.979316145181656e-06, 5.020759999752045e-06, 4.770234227180481e-06, 5.522742867469788e-06, 4.908069968223572e-06, 4.954170435667038e-06, 4.766043275594711e-06, 4.855915904045105e-06, 4.833098500967026e-06, 5.173962563276291e-06, 4.784669727087021e-06, 4.76837158203125e-06, 5.171634256839752e-06, 4.742294549942017e-06, 4.764646291732788e-06, 5.325302481651306e-06, 5.010049790143967e-06, 4.816800355911255e-06, 5.085952579975128e-06, 4.760921001434326e-06, 4.792120307683945e-06, 4.746951162815094e-06, 4.573259502649307e-06, 4.742760211229324e-06, 4.7050416469573975e-06, 4.731118679046631e-06, 4.7888606786727905e-06, 5.606096237897873e-06, 4.773959517478943e-06, 4.867091774940491e-06, 4.786066710948944e-06, 4.847068339586258e-06, 4.770699888467789e-06, 4.718080163002014e-06, 4.54997643828392e-06, 5.324836820363998e-06, 4.736240953207016e-06, 5.16185536980629e-06, 4.763249307870865e-06, 4.8796646296978e-06, 4.763249307870865e-06, 5.33275306224823e-06, 4.69619408249855e-06, 5.96093013882637e-06, 4.879198968410492e-06, 4.775822162628174e-06, 4.766043275594711e-06, 4.849862307310104e-06, 4.704110324382782e-06, 5.125999450683594e-06, 4.8228539526462555e-06, 4.7050416469573975e-06, 4.791188985109329e-06, 4.89410012960434e-06, 4.682689905166626e-06, 5.294103175401688e-06, 4.621222615242004e-06, 4.685018211603165e-06, 4.731584340333939e-06, 5.952082574367523e-06, 4.974193871021271e-06, 5.051959306001663e-06, 4.82192263007164e-06, 4.730187356472015e-06, 5.279667675495148e-06, 4.868023097515106e-06, 6.31110742688179e-06, 4.92483377456665e-06, 4.907138645648956e-06, 4.909932613372803e-06, 5.297362804412842e-06, 5.0798989832401276e-06, 4.874076694250107e-06, 5.146954208612442e-06, 4.579778760671616e-06, 4.71901148557663e-06, 4.861969500780106e-06, 4.69014048576355e-06, 4.6137720346450806e-06, 5.869194865226746e-06, 5.98980113863945e-06, 5.1031820476055145e-06, 4.766974598169327e-06, 4.7292560338974e-06, 5.4836273193359375e-06, 5.3211115300655365e-06, 5.323905497789383e-06, 4.949048161506653e-06, 4.647299647331238e-06, 4.692003130912781e-06, 4.988629370927811e-06, 4.670117050409317e-06, 4.644040018320084e-06, 4.676170647144318e-06, 5.526002496480942e-06, 5.0906091928482056e-06, 4.717148840427399e-06, 4.720874130725861e-06, 5.823094397783279e-06, 6.55418261885643e-06, 5.087815225124359e-06, 4.750210791826248e-06, 4.708766937255859e-06, 5.014240741729736e-06, 5.044974386692047e-06, 4.661735147237778e-06, 4.502013325691223e-06, 5.7462602853775024e-06, 4.993751645088196e-06, 4.86522912979126e-06, 4.651956260204315e-06, 4.71901148557663e-06, 4.809815436601639e-06, 5.281995981931686e-06, 4.9551017582416534e-06, 4.827976226806641e-06, 4.756264388561249e-06, 4.706904292106628e-06, 4.753004759550095e-06, 4.830770194530487e-06, 4.710163921117783e-06, 4.807952791452408e-06, 4.694797098636627e-06, 5.72623685002327e-06, 5.094800144433975e-06, 5.085952579975128e-06, 4.647299647331238e-06, 4.631932824850082e-06, 4.730187356472015e-06, 4.725996404886246e-06, 4.667788743972778e-06, 5.154870450496674e-06, 4.746951162815094e-06, 4.7292560338974e-06, 4.705972969532013e-06, 5.620066076517105e-06, 4.794914275407791e-06, 4.835892468690872e-06, 4.780944436788559e-06, 4.775356501340866e-06, 5.734618753194809e-06, 5.031004548072815e-06, 4.7050416469573975e-06, 5.388166755437851e-06, 4.951842129230499e-06, 4.773959517478943e-06, 4.790257662534714e-06, 4.835892468690872e-06, 4.684086889028549e-06, 4.762783646583557e-06, 4.698988050222397e-06, 6.009358912706375e-06, 5.211681127548218e-06, 4.805158823728561e-06, 4.792120307683945e-06, 4.7227367758750916e-06, 5.927868187427521e-06, 5.021225661039352e-06, 4.848930984735489e-06, 4.768837243318558e-06, 4.782341420650482e-06, 4.807021468877792e-06, 4.804693162441254e-06, 5.738344043493271e-06, 4.828907549381256e-06, 4.7390349209308624e-06, 4.660803824663162e-06, 4.893168807029724e-06, 4.704110324382782e-06, 4.814937710762024e-06, 5.58607280254364e-06, 4.910863935947418e-06, 4.75393608212471e-06, 4.605855792760849e-06, 4.670117050409317e-06, 4.848930984735489e-06, 4.827976226806641e-06, 5.16790896654129e-06, 4.676170647144318e-06, 4.670117050409317e-06, 5.552079528570175e-06, 4.732050001621246e-06, 4.963018000125885e-06, 5.982816219329834e-06, 5.078036338090897e-06, 4.8996880650520325e-06, 4.766043275594711e-06, 5.227979272603989e-06, 5.059409886598587e-06, 4.664994776248932e-06, 4.770699888467789e-06, 4.631001502275467e-06, 4.979316145181656e-06, 4.900619387626648e-06, 5.100388079881668e-06, 4.976987838745117e-06, 4.834961146116257e-06, 4.678033292293549e-06, 4.625879228115082e-06, 4.693865776062012e-06, 4.975125193595886e-06, 4.6798959374427795e-06, 4.71482053399086e-06, 4.765111953020096e-06, 5.231238901615143e-06, 6.3837505877017975e-06], tpot=0.0, prompt_len=256, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 10.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     761       
Benchmark duration (s):                  108.93    
Total input tokens:                      194816    
Total generated tokens:                  129505    
Request throughput (req/s):              6.99      
Output token throughput (tok/s):         1188.86   
Total Token throughput (tok/s):          2977.28   
---------------Time to First Token----------------
Mean TTFT (ms):                          18608.86  
Median TTFT (ms):                        22000.67  
P99 TTFT (ms):                           25719.99  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
