INFO 07-08 00:13:13 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=100, logprobs=None, request_rate=5.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-5-input-len-512-tp-1.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=512, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I\'ll try to break it down and provide some insights.\n\n**Observations:**\n\n1. **Mixed programming languages**: The text contains code snippets and keywords from various programming languages, including Java, Python, C++, and JavaScript.\n2. **Domain-specific terminology**: There are terms and phrases related to different domains, such as:\n\t* Finance (e.g., "UMAN_PAYMENT", "stock", "portfolio")\n\t* Computer science (e.g., "algorithm", "data structure", "machine learning")\n\t* Web development (e.g., "HTML", "CSS", "JavaScript")\n\t* Mobile app development (e.g., "Android", "iOS")\n\t* Networking (e.g., "WiFi", "SENSOR_BUSY")\n3. **Code snippets and fragments**: The text includes short code snippets, function names, and variable names, but they are often incomplete or out of context.\n4. **Non-English words and phrases**: There are words and phrases in languages other than English, such as German ("wei√ü"), French ("minifolders"), and Portuguese ("produto").\n\n**Possible explanations', success=True, latency=7.729357019066811, output_tokens=256, ttft=7.7280120039358735, itl=[4.46089543402195e-05, 1.5940051525831223e-05, 9.925104677677155e-06, 6.715301424264908e-06, 5.646608769893646e-06, 5.996320396661758e-06, 5.356967449188232e-06, 5.016103386878967e-06, 4.774890840053558e-06, 4.766974598169327e-06, 4.815869033336639e-06, 4.798173904418945e-06, 5.257781594991684e-06, 4.9211084842681885e-06, 4.866160452365875e-06, 4.603993147611618e-06, 4.793982952833176e-06, 5.052890628576279e-06, 4.989095032215118e-06, 5.421694368124008e-06, 5.166046321392059e-06, 4.732981324195862e-06, 5.461275577545166e-06, 5.039852112531662e-06, 5.059875547885895e-06, 5.258247256278992e-06, 4.937872290611267e-06, 5.30807301402092e-06, 4.988163709640503e-06, 4.8228539526462555e-06, 5.889683961868286e-06, 5.2014365792274475e-06, 4.775822162628174e-06, 5.342066287994385e-06, 4.755798727273941e-06, 4.625879228115082e-06, 4.7283247113227844e-06, 4.775822162628174e-06, 4.614237695932388e-06, 4.6510249376297e-06, 4.6729110181331635e-06, 5.322042852640152e-06, 4.735775291919708e-06, 4.655215889215469e-06, 4.79305163025856e-06, 4.851724952459335e-06, 6.0442835092544556e-06, 4.991888999938965e-06, 4.823785275220871e-06, 4.705972969532013e-06, 4.6943314373493195e-06, 5.211681127548218e-06, 4.623085260391235e-06, 5.639158189296722e-06, 4.835892468690872e-06, 4.7869980335235596e-06, 5.182810127735138e-06, 5.020294338464737e-06, 4.631932824850082e-06, 5.06080687046051e-06, 4.800036549568176e-06, 5.219131708145142e-06, 4.6622008085250854e-06, 4.829838871955872e-06, 4.618894308805466e-06, 5.146954208612442e-06, 4.689209163188934e-06, 4.686880856752396e-06, 4.755798727273941e-06, 4.8032961785793304e-06, 4.683155566453934e-06, 4.936009645462036e-06, 4.763714969158173e-06, 4.766974598169327e-06, 4.683155566453934e-06, 4.664994776248932e-06, 5.209818482398987e-06, 5.775131285190582e-06, 4.750210791826248e-06, 5.2996911108493805e-06, 4.815869033336639e-06, 4.707369953393936e-06, 4.8908405005931854e-06, 4.906207323074341e-06, 4.81167808175087e-06, 5.5301934480667114e-06, 5.348119884729385e-06, 4.6389177441596985e-06, 4.655681550502777e-06, 4.830304533243179e-06, 4.662666469812393e-06, 4.624016582965851e-06, 5.270354449748993e-06, 6.326008588075638e-06, 5.3676776587963104e-06, 5.008187144994736e-06, 5.058944225311279e-06, 5.055218935012817e-06, 4.835892468690872e-06, 4.814937710762024e-06, 5.078036338090897e-06, 5.092937499284744e-06, 4.9658119678497314e-06, 4.786066710948944e-06, 4.681292921304703e-06, 5.051027983427048e-06, 4.956964403390884e-06, 4.532746970653534e-06, 4.884321242570877e-06, 6.5569765865802765e-06, 4.912726581096649e-06, 5.111098289489746e-06, 4.820059984922409e-06, 5.241017788648605e-06, 4.843808710575104e-06, 4.896894097328186e-06, 4.877336323261261e-06, 5.241017788648605e-06, 4.861969500780106e-06, 4.708766937255859e-06, 4.830304533243179e-06, 5.130656063556671e-06, 4.83216717839241e-06, 5.307141691446304e-06, 4.591885954141617e-06, 4.695728421211243e-06, 4.79724258184433e-06, 4.956033080816269e-06, 5.465932190418243e-06, 5.92181459069252e-06, 5.134381353855133e-06, 4.699919372797012e-06, 5.173962563276291e-06, 4.820059984922409e-06, 4.634726792573929e-06, 4.688277840614319e-06, 5.434732884168625e-06, 4.907138645648956e-06, 4.6300701797008514e-06, 4.759989678859711e-06, 4.707835614681244e-06, 4.859175533056259e-06, 4.769768565893173e-06, 4.9942173063755035e-06, 4.569999873638153e-06, 4.801899194717407e-06, 4.616100341081619e-06, 4.807021468877792e-06, 4.769768565893173e-06, 6.170943379402161e-06, 5.281064659357071e-06, 4.89410012960434e-06, 4.612840712070465e-06, 5.173031240701675e-06, 4.9639493227005005e-06, 4.799105226993561e-06, 4.76418063044548e-06, 4.699919372797012e-06, 5.051027983427048e-06, 4.941131919622421e-06, 4.977919161319733e-06, 4.661735147237778e-06, 6.481073796749115e-06, 4.823319613933563e-06, 4.671979695558548e-06, 4.8140063881874084e-06, 4.601664841175079e-06, 5.403999239206314e-06, 5.166977643966675e-06, 4.9173831939697266e-06, 4.686880856752396e-06, 5.3229741752147675e-06, 4.83216717839241e-06, 6.16488978266716e-06, 4.664994776248932e-06, 4.779081791639328e-06, 4.624947905540466e-06, 4.7497451305389404e-06, 4.905276000499725e-06, 5.403067916631699e-06, 5.1497481763362885e-06, 4.7478824853897095e-06, 4.848930984735489e-06, 4.779081791639328e-06, 4.6510249376297e-06, 4.677101969718933e-06, 4.639849066734314e-06, 5.187932401895523e-06, 4.644040018320084e-06, 4.804227501153946e-06, 4.642177373170853e-06, 4.634726792573929e-06, 4.569068551063538e-06, 5.359761416912079e-06, 4.698056727647781e-06, 4.734378308057785e-06, 6.105750799179077e-06, 4.658009856939316e-06, 5.070120096206665e-06, 4.734843969345093e-06, 4.58909198641777e-06, 6.362795829772949e-06, 5.61913475394249e-06, 4.808884114027023e-06, 4.569068551063538e-06, 5.459878593683243e-06, 4.858244210481644e-06, 4.656147211790085e-06, 5.032867193222046e-06, 4.888046532869339e-06, 4.692934453487396e-06, 4.588160663843155e-06, 4.602596163749695e-06, 4.602130502462387e-06, 4.875939339399338e-06, 5.166977643966675e-06, 4.762317985296249e-06, 4.633795469999313e-06, 4.7390349209308624e-06, 4.5620836317539215e-06, 4.841946065425873e-06, 4.915054887533188e-06, 4.6798959374427795e-06, 4.746951162815094e-06, 4.537869244813919e-06, 4.641246050596237e-06, 4.631932824850082e-06, 5.485955625772476e-06, 4.716217517852783e-06, 5.249865353107452e-06, 4.69619408249855e-06, 4.585832357406616e-06, 4.976987838745117e-06, 6.323214620351791e-06, 6.084796041250229e-06, 4.79305163025856e-06, 4.881992936134338e-06, 4.691071808338165e-06, 5.119014531373978e-06, 5.203764885663986e-06, 6.767921149730682e-06, 8.93929973244667e-06, 5.616806447505951e-06, 5.136243999004364e-06, 4.895031452178955e-06, 4.600733518600464e-06, 4.756264388561249e-06, 4.731584340333939e-06, 5.5693089962005615e-06, 4.712957888841629e-06, 5.200039595365524e-06, 4.993751645088196e-06, 4.678033292293549e-06, 5.9800222516059875e-06, 4.7050416469573975e-06, 6.765127182006836e-06], tpot=0.0, prompt_len=512, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 5.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     100       
Benchmark duration (s):                  33.64     
Total input tokens:                      51200     
Total generated tokens:                  21910     
Request throughput (req/s):              2.97      
Output token throughput (tok/s):         651.23    
Total Token throughput (tok/s):          2173.05   
---------------Time to First Token----------------
Mean TTFT (ms):                          20204.79  
Median TTFT (ms):                        20542.97  
P99 TTFT (ms):                           33547.00  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.00      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
