INFO 07-08 07:50:04 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=20.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='chunked_prefill-qps-20-input-len-2048-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=2048, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large amount of text that seems to be a mix of programming code, technical terms, and random words. I\'ll do my best to help you make sense of it.\n\n**Code Analysis**\n\nThe text appears to contain snippets of code in various programming languages, including:\n\n1. Java: I see Java-like syntax and keywords, such as `public class`, `extends`, `implements`, and `@Override`.\n2. Python: There are Python-like syntax and keywords, such as `def`, `class`, and `import`.\n3. C++: I see C++-like syntax and keywords, such as `#include`, `class`, and `template`.\n4. JavaScript: There are JavaScript-like syntax and keywords, such as `function`, `var`, and `console.log`.\n\n**Technical Terms**\n\nThe text contains various technical terms, including:\n\n1. Programming concepts: I see terms like "inheritance", "polymorphism", "encapsulation", and "abstraction".\n2. Data structures: There are mentions of data structures like "arrays", "lists", "stacks", and "queues".\n3. Algorithms: I see references to algorithms like "sorting", "searching", and "graph traversal".\n4.', success=True, latency=4.139089058153331, output_tokens=256, ttft=0.2982793622650206, itl=[0.0031754551455378532, 0.014717912767082453, 0.014914617873728275, 0.015001762192696333, 0.015032084193080664, 0.014868233818560839, 0.014982605818659067, 0.014949899166822433, 0.01498830784112215, 0.014911637175828218, 0.014931391924619675, 0.014980516862124205, 0.014970059972256422, 0.014928205404430628, 0.014965752605348825, 0.015100688207894564, 0.014881353825330734, 0.014932782389223576, 0.014936405699700117, 0.014931092970073223, 0.01502245431765914, 0.015075455885380507, 0.014916344080120325, 0.01506111677736044, 0.014971769880503416, 0.014950929209589958, 0.014918806962668896, 0.015043328981846571, 0.014933018013834953, 0.014922162983566523, 0.015021747909486294, 0.015036200173199177, 0.014961450826376677, 0.015054042916744947, 0.015180530026555061, 0.015007736161351204, 0.015032423194497824, 0.015016385819762945, 0.014970541931688786, 0.01509519899263978, 0.015075539238750935, 0.015031087677925825, 0.014958658255636692, 0.014944370836019516, 0.015008795075118542, 0.014997735153883696, 0.015036491677165031, 0.015019981190562248, 0.01532158674672246, 0.014943423215299845, 0.014970830176025629, 0.014898347668349743, 0.015082580037415028, 0.01486741891130805, 0.014967028051614761, 0.01507507637143135, 0.01509429095312953, 0.01500664884224534, 0.015088142827153206, 0.015015357173979282, 0.01498345984145999, 0.015029928181320429, 0.015069312881678343, 0.01507585495710373, 0.015127742197364569, 0.015091385692358017, 0.015006562229245901, 0.015066848136484623, 0.015131434891372919, 0.015081039164215326, 0.01501560676842928, 0.015050300862640142, 0.015041856095194817, 0.0149836759082973, 0.015122195240110159, 0.015032957773655653, 0.015024529304355383, 0.015030757058411837, 0.015045200940221548, 0.014949542004615068, 0.014997357968240976, 0.015035831835120916, 0.015069423243403435, 0.01498740166425705, 0.015016037970781326, 0.015023084357380867, 0.015057958662509918, 0.014988384209573269, 0.015339612029492855, 0.015080115757882595, 0.014966219197958708, 0.015029261820018291, 0.015014063101261854, 0.015011936891824007, 0.01506928214803338, 0.015082280151546001, 0.014981556683778763, 0.015078198164701462, 0.01497871009632945, 0.015108752064406872, 0.014998931903392076, 0.015033493749797344, 0.015071748290210962, 0.014993012882769108, 0.015031373128294945, 0.015043301973491907, 0.014995035715401173, 0.015054860152304173, 0.015320095233619213, 0.014969616662710905, 0.014995313249528408, 0.015025526750832796, 0.015053370967507362, 0.015066892374306917, 0.015034898649901152, 0.015122902113944292, 0.01505038607865572, 0.015025526750832796, 0.01503809541463852, 0.01509146997705102, 0.01499104080721736, 0.015091456938534975, 0.015048432163894176, 0.015043403021991253, 0.014990110881626606, 0.015017931815236807, 0.015101201366633177, 0.015047745779156685, 0.015270192176103592, 0.015019896905869246, 0.015121404081583023, 0.015015339013189077, 0.015069891698658466, 0.015052284114062786, 0.014979309868067503, 0.015110861044377089, 0.015061077196151018, 0.015083706006407738, 0.015020650811493397, 0.01502197002992034, 0.015002379193902016, 0.015136499889194965, 0.014983226079493761, 0.015112422872334719, 0.014996279962360859, 0.015046010259538889, 0.015043454710394144, 0.01514139212667942, 0.01514594117179513, 0.014974392019212246, 0.015040897764265537, 0.01501212315633893, 0.015085520688444376, 0.015064024366438389, 0.015041142702102661, 0.015087079256772995, 0.015158324968069792, 0.015027012676000595, 0.014967295341193676, 0.015166704077273607, 0.014988120645284653, 0.015048899222165346, 0.015016352757811546, 0.01508161099627614, 0.015112382359802723, 0.015027652960270643, 0.014959248714148998, 0.01504871528595686, 0.01510718371719122, 0.014953147154301405, 0.015032645780593157, 0.014999032020568848, 0.015033670235425234, 0.01505954284220934, 0.01503463415428996, 0.015128205064684153, 0.01504606893286109, 0.0150812859646976, 0.015054157935082912, 0.015060984995216131, 0.015043850988149643, 0.015120754949748516, 0.015122798271477222, 0.015044545754790306, 0.015044593252241611, 0.015047568827867508, 0.01567237125709653, 0.015401128679513931, 0.014846349135041237, 0.014988798182457685, 0.015065583866089582, 0.015046012122184038, 0.015076177660375834, 0.015050312038511038, 0.015075602103024721, 0.015075957868248224, 0.015005345921963453, 0.015060512349009514, 0.015068580862134695, 0.015078325755894184, 0.015104163438081741, 0.01513091055676341, 0.015099117066711187, 0.015051964204758406, 0.015089808031916618, 0.01509924279525876, 0.015033332165330648, 0.015198173001408577, 0.014942418783903122, 0.015060058329254389, 0.015104736667126417, 0.015094795264303684, 0.015076507814228535, 0.015046040993183851, 0.015093894209712744, 0.015019440092146397, 0.015071287751197815, 0.015024717897176743, 0.014985475223511457, 0.015077265910804272, 0.015022323001176119, 0.015166275203227997, 0.015087058767676353, 0.015098687261343002, 0.015048011671751738, 0.01508150203153491, 0.015055268071591854, 0.015009765978902578, 0.015119906049221754, 0.015031887218356133, 0.015108842868357897, 0.015057672746479511, 0.01503986120223999, 0.015074708964675665, 0.015102106146514416, 0.015074614901095629, 0.01511372672393918, 0.015080714132636786, 0.015115392860025167, 0.015146987047046423, 0.015160747338086367, 0.015095183625817299, 0.015092319343239069, 0.015103746671229601, 0.015082477126270533, 0.015078658238053322, 0.015048753004521132, 0.015090945642441511, 0.015050392132252455, 0.015073679853230715, 0.015128148254007101, 0.015094698872417212, 0.015010566916316748, 0.015104005113244057, 0.01507957000285387, 0.01567868096753955], tpot=0.0, prompt_len=2048, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 20.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  159.08    
Total input tokens:                      2097152   
Total generated tokens:                  232414    
Request throughput (req/s):              6.44      
Output token throughput (tok/s):         1460.98   
Total Token throughput (tok/s):          14643.95  
---------------Time to First Token----------------
Mean TTFT (ms):                          46263.55  
Median TTFT (ms):                        46164.49  
P99 TTFT (ms):                           93841.27  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          215.82    
Median TPOT (ms):                        253.11    
P99 TPOT (ms):                           269.36    
---------------Inter-token Latency----------------
Mean ITL (ms):                           211.53    
Median ITL (ms):                         245.21    
P99 ITL (ms):                            293.36    
==================================================
