INFO 07-08 06:05:07 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=5.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='chunked_prefill-qps-5-input-len-256-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=256, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I'll try to break it down and provide some insights:\n\n**Programming languages and frameworks:**\n\n* Java (e.g., `@NoArgsConstructor`, `Parcelable`)\n* Python (e.g., `pd`, `testProfit`)\n* JavaScript (e.g., `OnClickListener`, `Component`)\n* C# (e.g., `Cleanup.structure`)\n* Kotlin (e.g., `lateinit`)\n\n**Domains and topics:**\n\n* Android development (e.g., `OnClickListener`, `Parcelable`)\n* Data science and machine learning (e.g., `testProfit`, `estimator`)\n* Web development (e.g., `Component`, `Cleanup.structure`)\n* IoT and sensor-related topics (e.g., `SENSOR_BUSY`, `wifi`)\n* Finance and economics (e.g., `NYSE`, `profit`)\n* Geography and location-based services (e.g., `Latitude`, `Prague`)\n\n**Other observations:**\n\n* There are many typos and non-English words/phrases, which might indicate that the text is a result of a machine translation or a text generation algorithm.\n* Some parts of the", success=True, latency=3.906209443695843, output_tokens=256, ttft=0.0928195109590888, itl=[3.545684739947319e-05, 0.015420139767229557, 0.014666866045445204, 0.015354373026639223, 0.014463169034570456, 0.01485413033515215, 0.014727646950632334, 0.014798199757933617, 0.014824105892330408, 0.014792129397392273, 0.01475929981097579, 0.014748853165656328, 0.014653767924755812, 0.014858965761959553, 0.015007463283836842, 0.01447265362367034, 0.015488218981772661, 0.014721921179443598, 0.014821199234575033, 0.014788615982979536, 0.014765003696084023, 0.014757019933313131, 0.015151656232774258, 0.014441648963838816, 0.015158506110310555, 0.015106731094419956, 0.014910831581801176, 0.01499752327799797, 0.015324193052947521, 0.015398889780044556, 0.014336884021759033, 0.014746461063623428, 0.015217273030430079, 0.014859030023217201, 0.014862542040646076, 0.014917338732630014, 0.015232361387461424, 0.014412967022508383, 0.014923622831702232, 0.014721767976880074, 0.014821195974946022, 0.014911769889295101, 0.015076379291713238, 0.01461746683344245, 0.014842926058918238, 0.015172646846622229, 0.01545680919662118, 0.01513163698837161, 0.014771551825106144, 0.015591322910040617, 0.014553272165358067, 0.015890156850218773, 0.015241734217852354, 0.015015771146863699, 0.014711222611367702, 0.015014871954917908, 0.014917608350515366, 0.014670596923679113, 0.01543479599058628, 0.015366011764854193, 0.015001470223069191, 0.014747256878763437, 0.014953159261494875, 0.015433878637850285, 0.014412186108529568, 0.015035325195640326, 0.01471382100135088, 0.015126318670809269, 0.014501712284982204, 0.014908184763044119, 0.015140673145651817, 0.014748964924365282, 0.015019997023046017, 0.014786242973059416, 0.014881093055009842, 0.014656510204076767, 0.014999455772340298, 0.014748067129403353, 0.015621427912265062, 0.01487175514921546, 0.01493125595152378, 0.014865702949464321, 0.014879964757710695, 0.01591854030266404, 0.014634451828897, 0.015169279184192419, 0.014835365116596222, 0.015477679669857025, 0.01505683409050107, 0.01492972020059824, 0.01490519568324089, 0.014820384327322245, 0.015570197720080614, 0.014970273245126009, 0.01502067781984806, 0.015286564826965332, 0.014871140010654926, 0.014773337170481682, 0.015394046902656555, 0.015019362326711416, 0.014738054014742374, 0.014889942947775126, 0.014972698874771595, 0.014959068968892097, 0.01487045083194971, 0.015066658146679401, 0.014667355921119452, 0.014865953009575605, 0.015215739142149687, 0.014587253797799349, 0.01507643423974514, 0.01473961491137743, 0.0155573058873415, 0.01473170891404152, 0.015357761178165674, 0.015027071814984083, 0.014799601398408413, 0.014783281832933426, 0.014895978849381208, 0.014743770938366652, 0.014848594088107347, 0.014792460948228836, 0.014804854989051819, 0.01488260505720973, 0.014758952893316746, 0.015093005262315273, 0.015272173099219799, 0.014527346007525921, 0.0151741998270154, 0.015343314968049526, 0.01448092982172966, 0.014867373276501894, 0.014799127820879221, 0.014876180328428745, 0.014743625652045012, 0.015156496316194534, 0.014752022922039032, 0.014775579795241356, 0.014951473101973534, 0.014904018957167864, 0.014774876181036234, 0.014837422873824835, 0.014780545141547918, 0.014816071838140488, 0.014780867844820023, 0.015390384010970592, 0.014730025082826614, 0.01487991213798523, 0.014824943151324987, 0.015552186872810125, 0.017125273123383522, 0.015018948819488287, 0.014830811880528927, 0.01567899901419878, 0.01554019283503294, 0.01482702000066638, 0.01484028110280633, 0.01613314589485526, 0.01545564504340291, 0.01480120001360774, 0.014891667291522026, 0.014760017860680819, 0.015191672835499048, 0.015103572979569435, 0.014430811163038015, 0.014761943835765123, 0.014759508427232504, 0.014878949616104364, 0.014802784193307161, 0.015577707905322313, 0.015068009961396456, 0.014741652179509401, 0.014875824097543955, 0.015030848793685436, 0.014942926820367575, 0.01468574907630682, 0.014895108062773943, 0.015373569913208485, 0.014476370997726917, 0.014805030077695847, 0.015269209165126085, 0.014933556783944368, 0.014562792144715786, 0.014864138793200254, 0.014852356165647507, 0.014784324914216995, 0.015493580140173435, 0.014715566765516996, 0.015352757181972265, 0.014578228816390038, 0.0148918810300529, 0.014784735161811113, 0.014831095933914185, 0.015465571079403162, 0.015018045902252197, 0.01459098095074296, 0.014907259028404951, 0.01523455698043108, 0.014571276027709246, 0.0150492531247437, 0.014662777073681355, 0.015304776839911938, 0.01472164411097765, 0.015183416195213795, 0.015001522842794657, 0.015326568856835365, 0.015195916872471571, 0.014827646315097809, 0.014804279897361994, 0.014746508095413446, 0.014819185715168715, 0.014740156009793282, 0.01485536526888609, 0.014707301743328571, 0.015458333306014538, 0.014427219051867723, 0.01512415986508131, 0.014964987058192492, 0.014852205757051706, 0.014989577233791351, 0.015197178814560175, 0.014608791097998619, 0.014712152071297169, 0.015250165946781635, 0.015327997971326113, 0.014719256199896336, 0.015346322674304247, 0.014388513285666704, 0.014860854018479586, 0.01486333180218935, 0.0154856420122087, 0.014523066114634275, 0.014846691861748695, 0.015320404898375273, 0.014896795153617859, 0.014739127829670906, 0.015113865956664085, 0.014434907119721174, 0.014774000272154808, 0.015434331726282835, 0.014616223983466625, 0.01485397294163704, 0.014793345239013433, 0.014783938881009817, 0.014830346219241619, 0.01532310200855136, 0.014681149739772081, 0.01512634614482522, 0.014507611747831106, 0.014839656185358763, 0.014778772834688425, 0.014816940296441317, 0.015162355732172728, 0.01504526101052761, 0.014523088000714779, 0.015016566962003708], tpot=0.0, prompt_len=256, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 5.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  221.41    
Total input tokens:                      262144    
Total generated tokens:                  240908    
Request throughput (req/s):              4.62      
Output token throughput (tok/s):         1088.07   
Total Token throughput (tok/s):          2272.06   
---------------Time to First Token----------------
Mean TTFT (ms):                          98.62     
Median TTFT (ms):                        94.29     
P99 TTFT (ms):                           169.53    
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          20.90     
Median TPOT (ms):                        20.91     
P99 TPOT (ms):                           23.36     
---------------Inter-token Latency----------------
Mean ITL (ms):                           20.82     
Median ITL (ms):                         18.37     
P99 ITL (ms):                            86.61     
==================================================
