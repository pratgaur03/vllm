INFO 07-10 22:49:36 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=40.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-40-input-len-256-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=256, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I\'ll try to break it down and provide some insights:\n\n**Programming languages and frameworks:**\n\n* Java (e.g., `@NoArgsConstructor`, `Parcelable`)\n* Python (e.g., `pd`, `numpy`)\n* JavaScript (e.g., `OnClickListener`, `Component`)\n* C++ (e.g., `GPIO`)\n* Kotlin (e.g., `data class`)\n\n**Domains and topics:**\n\n* Machine learning (e.g., `DataLoader`, `estimator`)\n* Android development (e.g., `OnClickListener`, `Parcelable`)\n* Web development (e.g., `Component`, `React`)\n* IoT (e.g., `GPIO`)\n* Finance (e.g., `NYSE`, `profit`)\n* Geography (e.g., `Latitude`, `Longitude`)\n* Politics (e.g., `Cuomo`, `Judicial`)\n\n**Other observations:**\n\n* There are many typos and grammatical errors throughout the text.\n* Some words and phrases appear to be randomly inserted or concatenated (e.g., `cheng Milit"&finding`, `flotation.sensorBrazil`).\n* There', success=True, latency=4.7187648680992424, output_tokens=256, ttft=4.717407533433288, itl=[4.4860877096652985e-05, 1.6761012375354767e-05, 1.0268762707710266e-05, 7.0980750024318695e-06, 5.559064447879791e-06, 6.325077265501022e-06, 5.837064236402512e-06, 5.245674401521683e-06, 5.009118467569351e-06, 5.129259079694748e-06, 4.995614290237427e-06, 4.8140063881874084e-06, 5.142297595739365e-06, 4.9620866775512695e-06, 4.789792001247406e-06, 4.827976226806641e-06, 4.977919161319733e-06, 5.197245627641678e-06, 5.109701305627823e-06, 5.1390379667282104e-06, 4.872214049100876e-06, 5.020759999752045e-06, 5.504116415977478e-06, 5.163252353668213e-06, 4.881992936134338e-06, 5.248934030532837e-06, 5.119014531373978e-06, 4.956033080816269e-06, 4.956964403390884e-06, 5.085952579975128e-06, 5.668029189109802e-06, 5.269888788461685e-06, 4.814937710762024e-06, 5.30807301402092e-06, 4.859175533056259e-06, 4.875008016824722e-06, 4.859641194343567e-06, 4.860106855630875e-06, 4.934147000312805e-06, 4.8638321459293365e-06, 4.982110112905502e-06, 5.391892045736313e-06, 4.7781504690647125e-06, 4.803761839866638e-06, 4.990026354789734e-06, 4.872214049100876e-06, 5.7299621403217316e-06, 5.126930773258209e-06, 4.7818757593631744e-06, 4.835892468690872e-06, 4.913192242383957e-06, 5.059875547885895e-06, 4.924368113279343e-06, 5.789566785097122e-06, 5.000270903110504e-06, 4.954170435667038e-06, 4.883855581283569e-06, 4.9727968871593475e-06, 5.033332854509354e-06, 8.299946784973145e-06, 5.101785063743591e-06, 5.119945853948593e-06, 5.306210368871689e-06, 4.733912646770477e-06, 4.886183887720108e-06, 5.502719432115555e-06, 5.035195499658585e-06, 4.847999662160873e-06, 5.337875336408615e-06, 4.807952791452408e-06, 4.881992936134338e-06, 4.767905920743942e-06, 4.754401743412018e-06, 4.671979695558548e-06, 4.7977082431316376e-06, 4.786066710948944e-06, 4.792120307683945e-06, 5.431007593870163e-06, 5.032867193222046e-06, 4.967208951711655e-06, 4.84660267829895e-06, 4.903413355350494e-06, 4.843808710575104e-06, 4.7371722757816315e-06, 4.902016371488571e-06, 5.309935659170151e-06, 4.721805453300476e-06, 5.266163498163223e-06, 4.937872290611267e-06, 4.922039806842804e-06, 4.872214049100876e-06, 5.294568836688995e-06, 4.99701127409935e-06, 5.772337317466736e-06, 5.044043064117432e-06, 4.902947694063187e-06, 4.794914275407791e-06, 5.125999450683594e-06, 4.7120265662670135e-06, 5.2656978368759155e-06, 4.884321242570877e-06, 4.9318186938762665e-06, 4.811212420463562e-06, 4.852656275033951e-06, 4.683155566453934e-06, 5.463138222694397e-06, 4.909932613372803e-06, 4.956964403390884e-06, 4.899222403764725e-06, 6.6338106989860535e-06, 5.1138922572135925e-06, 4.96814027428627e-06, 4.772096872329712e-06, 4.834961146116257e-06, 5.242880433797836e-06, 4.934147000312805e-06, 5.058944225311279e-06, 5.626119673252106e-06, 4.892703145742416e-06, 4.903879016637802e-06, 5.084089934825897e-06, 5.017034709453583e-06, 4.892237484455109e-06, 5.1907263696193695e-06, 4.743225872516632e-06, 4.847999662160873e-06, 4.971865564584732e-06, 5.024019628763199e-06, 4.644040018320084e-06, 6.516929715871811e-06, 5.122274160385132e-06, 4.9727968871593475e-06, 5.03193587064743e-06, 4.9122609198093414e-06, 4.853587597608566e-06, 5.197245627641678e-06, 4.9578957259655e-06, 4.940200597047806e-06, 4.665926098823547e-06, 4.951842129230499e-06, 4.787929356098175e-06, 4.79305163025856e-06, 5.241017788648605e-06, 4.827976226806641e-06, 4.699919372797012e-06, 5.149282515048981e-06, 4.860106855630875e-06, 4.92902472615242e-06, 4.963018000125885e-06, 7.456634193658829e-06, 4.973262548446655e-06, 4.875939339399338e-06, 4.807952791452408e-06, 4.915986210107803e-06, 4.8228539526462555e-06, 4.8442743718624115e-06, 4.7977082431316376e-06, 5.5371783673763275e-06, 5.05475327372551e-06, 4.890374839305878e-06, 4.789792001247406e-06, 4.795845597982407e-06, 4.7460198402404785e-06, 5.488283932209015e-06, 4.916917532682419e-06, 4.859175533056259e-06, 4.805624485015869e-06, 4.97838482260704e-06, 4.9066729843616486e-06, 4.828907549381256e-06, 4.709232598543167e-06, 4.834029823541641e-06, 4.780944436788559e-06, 6.109010428190231e-06, 4.8871152102947235e-06, 5.6819990277290344e-06, 5.125999450683594e-06, 4.792120307683945e-06, 4.894565790891647e-06, 4.804227501153946e-06, 4.859175533056259e-06, 5.602836608886719e-06, 4.9318186938762665e-06, 4.841946065425873e-06, 5.097128450870514e-06, 5.801208317279816e-06, 4.8908405005931854e-06, 4.8209913074970245e-06, 4.7888606786727905e-06, 4.754401743412018e-06, 5.703885108232498e-06, 5.311798304319382e-06, 4.838220775127411e-06, 5.325768142938614e-06, 4.902016371488571e-06, 4.7869980335235596e-06, 4.780944436788559e-06, 4.752073436975479e-06, 4.932284355163574e-06, 4.919711500406265e-06, 4.732981324195862e-06, 5.9730373322963715e-06, 5.058012902736664e-06, 4.839152097702026e-06, 4.759989678859711e-06, 5.043111741542816e-06, 5.0836242735385895e-06, 4.9443915486335754e-06, 4.842877388000488e-06, 4.800967872142792e-06, 4.834029823541641e-06, 4.9066729843616486e-06, 4.6691857278347015e-06, 5.3942203521728516e-06, 4.835892468690872e-06, 4.775822162628174e-06, 4.724133759737015e-06, 4.815869033336639e-06, 4.69014048576355e-06, 4.99282032251358e-06, 5.597248673439026e-06, 4.803761839866638e-06, 5.524139851331711e-06, 4.864763468503952e-06, 4.868023097515106e-06, 4.822388291358948e-06, 4.988629370927811e-06, 4.730187356472015e-06, 4.8121437430381775e-06, 4.849862307310104e-06, 4.823785275220871e-06, 4.827044904232025e-06, 5.164183676242828e-06, 6.283167749643326e-06, 4.913657903671265e-06, 4.956033080816269e-06, 4.914123564958572e-06, 5.45009970664978e-06, 4.875939339399338e-06, 4.870817065238953e-06, 4.9551017582416534e-06, 4.835892468690872e-06, 4.9602240324020386e-06, 4.765111953020096e-06, 4.870817065238953e-06, 5.045905709266663e-06, 4.989095032215118e-06, 4.940200597047806e-06, 4.849862307310104e-06, 4.731118679046631e-06, 5.024019628763199e-06, 4.8568472266197205e-06, 4.810746759176254e-06, 4.874076694250107e-06, 5.657318979501724e-06, 6.5267086029052734e-06], tpot=0.0, prompt_len=256, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 40.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  63.36     
Total input tokens:                      262144    
Total generated tokens:                  122094    
Request throughput (req/s):              16.16     
Output token throughput (tok/s):         1926.84   
Total Token throughput (tok/s):          6063.89   
---------------Time to First Token----------------
Mean TTFT (ms):                          23728.86  
Median TTFT (ms):                        24113.80  
P99 TTFT (ms):                           49548.32  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
