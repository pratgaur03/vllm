INFO 07-10 19:14:15 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=40.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-40-input-len-4096-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=4096, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you have provided a large amount of text that seems to be a mix of programming code, technical terms, and random words. I'll do my best to help you make sense of it.\n\nThe text appears to be a collection of snippets from various programming languages, including Java, Python, and C++. There are also references to technical terms like machine learning, data structures, and algorithms.\n\nHowever, the text is not a coherent piece of code or a well-structured document. It seems to be a jumbled collection of words and phrases that may have been generated randomly or copied from different sources.\n\nIf you could provide more context or information about what you're trying to accomplish or what you're looking for, I'd be happy to help you make sense of this text or provide guidance on how to use it.\n\nSome possible questions to consider:\n\n* What is the purpose of this text?\n* Is it a code snippet or a document?\n* What programming language or technology is it related to?\n* Are there any specific terms or concepts that you're trying to understand?\n\nPlease feel free to provide more information or clarify your question, and I'll do my best to assist you.", success=True, latency=4.916852337773889, output_tokens=239, ttft=4.91556919971481, itl=[4.448229447007179e-05, 1.8205959349870682e-05, 9.25874337553978e-06, 6.734393537044525e-06, 5.212612450122833e-06, 5.914364010095596e-06, 5.03193587064743e-06, 4.985835403203964e-06, 4.86522912979126e-06, 5.160924047231674e-06, 5.098059773445129e-06, 4.952773451805115e-06, 4.995148628950119e-06, 4.942994564771652e-06, 4.732981324195862e-06, 5.034729838371277e-06, 4.788395017385483e-06, 5.3727999329566956e-06, 5.30807301402092e-06, 4.932750016450882e-06, 4.922039806842804e-06, 5.709938704967499e-06, 5.4282136261463165e-06, 4.873145371675491e-06, 4.8889778554439545e-06, 5.356967449188232e-06, 4.9979425966739655e-06, 4.796776920557022e-06, 5.012378096580505e-06, 5.042646080255508e-06, 5.558133125305176e-06, 5.003064870834351e-06, 4.949048161506653e-06, 5.466863512992859e-06, 5.1478855311870575e-06, 4.956964403390884e-06, 4.856381565332413e-06, 4.903879016637802e-06, 4.656147211790085e-06, 4.678033292293549e-06, 4.61796298623085e-06, 6.039626896381378e-06, 4.6351924538612366e-06, 4.632864147424698e-06, 4.786066710948944e-06, 4.780944436788559e-06, 4.793982952833176e-06, 4.9122609198093414e-06, 4.851724952459335e-06, 4.967208951711655e-06, 5.158130079507828e-06, 4.923902451992035e-06, 5.119945853948593e-06, 5.499925464391708e-06, 4.950910806655884e-06, 4.956033080816269e-06, 4.745088517665863e-06, 5.296897143125534e-06, 4.835892468690872e-06, 5.188398063182831e-06, 4.768837243318558e-06, 4.742760211229324e-06, 4.983041435480118e-06, 4.752073436975479e-06, 4.825182259082794e-06, 5.30388206243515e-06, 5.037989467382431e-06, 4.966277629137039e-06, 5.385838449001312e-06, 4.830770194530487e-06, 4.834961146116257e-06, 4.723202437162399e-06, 4.718080163002014e-06, 5.1157549023628235e-06, 4.675239324569702e-06, 4.8209913074970245e-06, 5.441717803478241e-06, 5.877111107110977e-06, 4.798173904418945e-06, 5.302950739860535e-06, 4.91878017783165e-06, 5.162321031093597e-06, 4.648696631193161e-06, 4.686415195465088e-06, 4.671979695558548e-06, 5.176756531000137e-06, 5.191192030906677e-06, 4.820059984922409e-06, 4.798639565706253e-06, 5.125999450683594e-06, 4.881992936134338e-06, 4.709232598543167e-06, 4.762783646583557e-06, 5.707144737243652e-06, 5.0817616283893585e-06, 4.89410012960434e-06, 5.504116415977478e-06, 6.785150617361069e-06, 4.952773451805115e-06, 4.83216717839241e-06, 5.894806236028671e-06, 5.574896931648254e-06, 5.69736585021019e-06, 5.50365075469017e-06, 5.334150046110153e-06, 5.367211997509003e-06, 5.6978315114974976e-06, 4.834029823541641e-06, 4.793982952833176e-06, 6.692949682474136e-06, 5.383044481277466e-06, 5.48921525478363e-06, 4.920642822980881e-06, 4.948116838932037e-06, 4.872214049100876e-06, 5.241949111223221e-06, 5.801673978567123e-06, 4.861969500780106e-06, 5.003996193408966e-06, 5.174428224563599e-06, 5.241017788648605e-06, 5.638692528009415e-06, 5.249865353107452e-06, 5.1283277571201324e-06, 4.5979395508766174e-06, 8.5439532995224e-06, 5.033798515796661e-06, 4.83635812997818e-06, 5.0710514187812805e-06, 6.29667192697525e-06, 5.7872384786605835e-06, 5.153007805347443e-06, 4.745088517665863e-06, 4.7138892114162445e-06, 4.674773663282394e-06, 4.712957888841629e-06, 5.467329174280167e-06, 5.0389207899570465e-06, 4.614703357219696e-06, 5.4943375289440155e-06, 4.621688276529312e-06, 4.754401743412018e-06, 5.141831934452057e-06, 4.90015372633934e-06, 5.135778337717056e-06, 4.9299560487270355e-06, 4.926230758428574e-06, 4.6389177441596985e-06, 5.562789738178253e-06, 6.222166121006012e-06, 4.951842129230499e-06, 5.157198756933212e-06, 4.970934242010117e-06, 4.773959517478943e-06, 4.610046744346619e-06, 4.5620836317539215e-06, 4.888046532869339e-06, 4.666857421398163e-06, 5.359761416912079e-06, 5.000270903110504e-06, 4.7800131142139435e-06, 4.6817585825920105e-06, 4.6622008085250854e-06, 4.733912646770477e-06, 5.008187144994736e-06, 5.024019628763199e-06, 4.5406632125377655e-06, 4.964414983987808e-06, 5.471985787153244e-06, 4.728790372610092e-06, 5.3727999329566956e-06, 5.296431481838226e-06, 4.8656947910785675e-06, 6.067100912332535e-06, 5.7299621403217316e-06, 4.72506508231163e-06, 4.776753485202789e-06, 4.9853697419166565e-06, 5.088746547698975e-06, 4.940200597047806e-06, 4.71482053399086e-06, 4.798173904418945e-06, 4.721805453300476e-06, 4.7711655497550964e-06, 4.663132131099701e-06, 4.768837243318558e-06, 5.363021045923233e-06, 5.230773240327835e-06, 4.79724258184433e-06, 5.109701305627823e-06, 4.745088517665863e-06, 4.782341420650482e-06, 4.830770194530487e-06, 5.629844963550568e-06, 4.788395017385483e-06, 4.909001290798187e-06, 4.723668098449707e-06, 4.722271114587784e-06, 4.834961146116257e-06, 4.969071596860886e-06, 4.666857421398163e-06, 6.382819265127182e-06, 4.932284355163574e-06, 6.003770977258682e-06, 8.88388603925705e-06, 4.989095032215118e-06, 5.538109689950943e-06, 4.9578957259655e-06, 4.723202437162399e-06, 5.736015737056732e-06, 4.862900823354721e-06, 4.948116838932037e-06, 4.977919161319733e-06, 4.71901148557663e-06, 4.64683398604393e-06, 5.191192030906677e-06, 4.877801984548569e-06, 5.334150046110153e-06, 4.678964614868164e-06, 4.6300701797008514e-06, 4.926696419715881e-06, 5.440320819616318e-06, 4.912726581096649e-06, 6.254296749830246e-06, 4.908069968223572e-06, 6.0587190091609955e-06, 4.7869980335235596e-06, 4.963018000125885e-06, 4.706904292106628e-06, 4.6370550990104675e-06, 4.6351924538612366e-06, 4.631001502275467e-06, 4.7800131142139435e-06, 7.153023034334183e-06, 4.843808710575104e-06, 4.639849066734314e-06, 4.708301275968552e-06, 4.9979425966739655e-06, 5.442183464765549e-06], tpot=0.0, prompt_len=4096, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 40.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  133.01    
Total input tokens:                      4194304   
Total generated tokens:                  0         
Request throughput (req/s):              7.70      
Output token throughput (tok/s):         0.00      
Total Token throughput (tok/s):          31534.40  
---------------Time to First Token----------------
Mean TTFT (ms):                          23532.50  
Median TTFT (ms):                        0.00      
P99 TTFT (ms):                           132649.73 
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.00      
Median TPOT (ms):                        0.00      
P99 TPOT (ms):                           0.00      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.01      
P99 ITL (ms):                            0.02      
==================================================
