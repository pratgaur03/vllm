INFO 07-08 08:03:19 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=3.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='chunked_prefill-qps-3-input-len-2048-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=2048, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large amount of text that seems to be a mix of programming code, technical terms, and random words. I\'ll do my best to help you make sense of it.\n\n**Code Analysis**\n\nThe text appears to contain snippets of code in various programming languages, including:\n\n1. Java: I see Java-like syntax and keywords, such as `public class`, `extends`, `implements`, and `@Override`.\n2. Python: There are Python-like syntax and keywords, such as `def`, `class`, and `import`.\n3. C++: I see C++-like syntax and keywords, such as `#include`, `class`, and `template`.\n4. JavaScript: There are JavaScript-like syntax and keywords, such as `function`, `var`, and `console.log`.\n\n**Technical Terms**\n\nThe text contains various technical terms, including:\n\n1. Programming concepts: I see terms like "inheritance", "polymorphism", "encapsulation", and "abstraction".\n2. Data structures: There are mentions of data structures like "arrays", "lists", "stacks", and "queues".\n3. Algorithms: I see references to algorithms like "sorting", "searching", and "graph traversal".\n4.', success=True, latency=4.025035853963345, output_tokens=256, ttft=0.3003772492520511, itl=[0.0028076046146452427, 0.014353478327393532, 0.014466875698417425, 0.014528060331940651, 0.014465768821537495, 0.014444903004914522, 0.014475640840828419, 0.014468101318925619, 0.014533473644405603, 0.01446317508816719, 0.014538513030856848, 0.0144471968524158, 0.014461991377174854, 0.014517758972942829, 0.01447210181504488, 0.014513031113892794, 0.014499568846076727, 0.014604751020669937, 0.014552528038620949, 0.014477948192507029, 0.014503365848213434, 0.01454829704016447, 0.014570476952940226, 0.014507486019283533, 0.014603631105273962, 0.01445158664137125, 0.014528556261211634, 0.014502022881060839, 0.014483707025647163, 0.014538479968905449, 0.01455003721639514, 0.014537062030285597, 0.014522762037813663, 0.014535225927829742, 0.014484306797385216, 0.014522288925945759, 0.01455534528940916, 0.014822622761130333, 0.01430584816262126, 0.014510721899569035, 0.014472621958702803, 0.01447995100170374, 0.014563043136149645, 0.01456502778455615, 0.014598966110497713, 0.01457370724529028, 0.01454635290428996, 0.014501756057143211, 0.014590577688068151, 0.0145555529743433, 0.014573066029697657, 0.014715238008648157, 0.014513425063341856, 0.014587763231247663, 0.014557329006493092, 0.014550849795341492, 0.014501398894935846, 0.014595716260373592, 0.014701413922011852, 0.01454262575134635, 0.014541581273078918, 0.0145709621720016, 0.014705769717693329, 0.014554672874510288, 0.014503741171211004, 0.014677308034151793, 0.01461532898247242, 0.014579664915800095, 0.014593300875276327, 0.014533624053001404, 0.0147612732835114, 0.014555396046489477, 0.014649041928350925, 0.01452499907463789, 0.014556285925209522, 0.014568843878805637, 0.014616221189498901, 0.014710098039358854, 0.014595132786780596, 0.014630627818405628, 0.014486299362033606, 0.014576571993529797, 0.014616375789046288, 0.01461083721369505, 0.014596160035580397, 0.01460633473470807, 0.014635534025728703, 0.014539663214236498, 0.014598052948713303, 0.014585301745682955, 0.014578437898308039, 0.014655351173132658, 0.014898621011525393, 0.014259965158998966, 0.014701243955641985, 0.01459280913695693, 0.014545449987053871, 0.01459492091089487, 0.014601937029510736, 0.014641685876995325, 0.01453453116118908, 0.01458143163472414, 0.014611986000090837, 0.014613814186304808, 0.014597026165574789, 0.014595780055969954, 0.014632980804890394, 0.014566624071449041, 0.014610904734581709, 0.014546872116625309, 0.014598098117858171, 0.014644362963736057, 0.01458940701559186, 0.014708993025124073, 0.014591342769563198, 0.014590115286409855, 0.014522004872560501, 0.014576467219740152, 0.01461078180000186, 0.01459505595266819, 0.014733640011399984, 0.014556973241269588, 0.014619775582104921, 0.014653169084340334, 0.014568205922842026, 0.014613096136599779, 0.014579854905605316, 0.014634164981544018, 0.014531495980918407, 0.014522340148687363, 0.01460728095844388, 0.014654736965894699, 0.01463255425915122, 0.014631782658398151, 0.014618517365306616, 0.014550460036844015, 0.014535365626215935, 0.014583290088921785, 0.014608912169933319, 0.01464746193960309, 0.014576445799320936, 0.014658899046480656, 0.014597122091799974, 0.014607572928071022, 0.01458479231223464, 0.014635360799729824, 0.014642802067101002, 0.014768512919545174, 0.014420086052268744, 0.014558788854628801, 0.014598251320421696, 0.014713818673044443, 0.014544505160301924, 0.014649010729044676, 0.014654550235718489, 0.014553518034517765, 0.014580071903765202, 0.01459107780829072, 0.014586929231882095, 0.01471696188673377, 0.014644871931523085, 0.014665985014289618, 0.014566242229193449, 0.014592264778912067, 0.014607292134314775, 0.014557044953107834, 0.01460130512714386, 0.014633003156632185, 0.014756339602172375, 0.014582127332687378, 0.014548586681485176, 0.014590273145586252, 0.014548684004694223, 0.01472568605095148, 0.014578810892999172, 0.014726330991834402, 0.014555755071341991, 0.014591306913644075, 0.014563150238245726, 0.01464885100722313, 0.01459359098225832, 0.01464146887883544, 0.0146818901412189, 0.014582556672394276, 0.014524565078318119, 0.014605543110519648, 0.01464146887883544, 0.014682401902973652, 0.014652901329100132, 0.014654026832431555, 0.014579026028513908, 0.014670252799987793, 0.014549707062542439, 0.014608806930482388, 0.01459047431126237, 0.014954573009163141, 0.014260082971304655, 0.014590958133339882, 0.01457452867180109, 0.014602107927203178, 0.014603506308048964, 0.014628107659518719, 0.014647376257926226, 0.01463662413880229, 0.014561912976205349, 0.014586412813514471, 0.014540434814989567, 0.014631853438913822, 0.014601080678403378, 0.014679858926683664, 0.014614519197493792, 0.014564626850187778, 0.014607205986976624, 0.014643663074821234, 0.014645252842456102, 0.014619565103203058, 0.01470476109534502, 0.014539474155753851, 0.014556523878127337, 0.014613805804401636, 0.014577096328139305, 0.014934300910681486, 0.0146094411611557, 0.014687909744679928, 0.014573709107935429, 0.014641507994383574, 0.014624843839555979, 0.014658245258033276, 0.01463161176070571, 0.01463367696851492, 0.014673273079097271, 0.014631615951657295, 0.014650357887148857, 0.014638764318078756, 0.014653472695499659, 0.01462009223178029, 0.01459820894524455, 0.014744682237505913, 0.014633618760854006, 0.014595996122807264, 0.014644342940300703, 0.014650573953986168, 0.014615902211517096, 0.014922333881258965, 0.014334731735289097, 0.014601293951272964, 0.014653243124485016, 0.014634822960942984, 0.014671418350189924, 0.014673993922770023, 0.014692109078168869, 0.014579823706299067, 0.014580382965505123, 0.014622187241911888, 0.014586436096578836, 0.015252912882715464], tpot=0.0, prompt_len=2048, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 3.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  366.02    
Total input tokens:                      2097152   
Total generated tokens:                  229520    
Request throughput (req/s):              2.80      
Output token throughput (tok/s):         627.07    
Total Token throughput (tok/s):          6356.72   
---------------Time to First Token----------------
Mean TTFT (ms):                          370.95    
Median TTFT (ms):                        315.29    
P99 TTFT (ms):                           782.36    
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          29.01     
Median TPOT (ms):                        28.58     
P99 TPOT (ms):                           42.56     
---------------Inter-token Latency----------------
Mean ITL (ms):                           28.88     
Median ITL (ms):                         19.00     
P99 ITL (ms):                            219.91    
==================================================
