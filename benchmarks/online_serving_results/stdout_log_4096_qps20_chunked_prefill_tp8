INFO 07-09 18:42:36 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=20.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='chunked_prefill-qps-20-input-len-4096-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=4096, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you have provided a large amount of text that seems to be a mix of programming code, technical terms, and random words. I'll do my best to help you make sense of it.\n\nThe text appears to be a combination of different programming languages, including Java, Python, and C++. There are also references to various technical concepts, such as data structures, algorithms, and software development frameworks.\n\nHowever, the text is not a coherent piece of code or a well-structured document. It seems to be a collection of random snippets and phrases that are not necessarily related to each other.\n\nIf you could provide more context or information about what you are trying to accomplish or what you would like to know, I'll do my best to help you.\n\nHere are a few observations and suggestions:\n\n1. The text contains a lot of technical terms and concepts. If you are not familiar with these terms, it may be helpful to look them up or seek additional resources to learn more about them.\n2. The text appears to be a mix of different programming languages. If you are trying to learn a specific language, it may be helpful to focus on a single language and seek out resources that are specific to that language.\n3. The text does not appear to be a coherent", success=True, latency=4.236933609936386, output_tokens=256, ttft=0.433128688018769, itl=[0.11706653330475092, 0.014349839650094509, 0.014225819148123264, 0.01419496489688754, 0.014235774986445904, 0.014207527972757816, 0.014309002086520195, 0.014253368135541677, 0.014456721022725105, 0.014359364751726389, 0.014264458324760199, 0.014265038073062897, 0.014179782941937447, 0.01441082963719964, 0.014225350227206945, 0.014351693913340569, 0.014324190095067024, 0.014323925133794546, 0.014317916706204414, 0.014522575307637453, 0.014297049026936293, 0.014365913812071085, 0.014274953864514828, 0.014266801998019218, 0.014302843250334263, 0.01438347389921546, 0.014230807777494192, 0.014290035236626863, 0.014345979783684015, 0.014305036049336195, 0.014256577007472515, 0.014363342896103859, 0.014277823269367218, 0.01429992401972413, 0.014369049109518528, 0.014341479633003473, 0.014298008289188147, 0.014394795056432486, 0.014381465036422014, 0.01439284486696124, 0.014612330123782158, 0.014386219903826714, 0.014544663950800896, 0.01429258706048131, 0.014332612045109272, 0.014416808728128672, 0.01426256401464343, 0.0142314531840384, 0.014316027984023094, 0.014266795013099909, 0.014310938771814108, 0.014320806134492159, 0.014357931911945343, 0.014429959002882242, 0.014290344901382923, 0.014369619078934193, 0.014368528965860605, 0.014409141149371862, 0.01445287698879838, 0.014303025789558887, 0.014337577391415834, 0.014312219806015491, 0.014412567019462585, 0.014423401094973087, 0.014469331130385399, 0.014358968939632177, 0.01441641291603446, 0.014352164696902037, 0.014402302447706461, 0.014612781815230846, 0.01436177408322692, 0.014378876890987158, 0.014409408904612064, 0.014455914031714201, 0.01450550090521574, 0.014325047377496958, 0.014369606971740723, 0.014404806774109602, 0.014404689893126488, 0.014407911337912083, 0.014395719859749079, 0.014386362861841917, 0.014410002157092094, 0.014399857725948095, 0.014671478420495987, 0.014313924591988325, 0.014428703114390373, 0.01434047520160675, 0.014315153006464243, 0.014351621735841036, 0.01437962893396616, 0.014329767320305109, 0.014404793735593557, 0.014364384114742279, 0.014397467952221632, 0.014346014242619276, 0.01435742387548089, 0.014368998818099499, 0.014420357067137957, 0.014324788935482502, 0.014394795056432486, 0.014599827118217945, 0.014387360773980618, 0.01441144896671176, 0.014377077110111713, 0.014408564195036888, 0.014453239738941193, 0.014359567314386368, 0.01440361887216568, 0.014361240901052952, 0.014376004226505756, 0.014384206850081682, 0.014377889223396778, 0.014331148006021976, 0.014405879657715559, 0.014387837145477533, 0.014461632817983627, 0.014355285093188286, 0.014390491880476475, 0.014555975329130888, 0.014553894754499197, 0.014465888030827045, 0.014521322213113308, 0.014449670910835266, 0.014460219070315361, 0.01452575484290719, 0.014710342977195978, 0.014481714926660061, 0.014523887075483799, 0.01438541105017066, 0.014413563068956137, 0.014774465002119541, 0.01442854106426239, 0.01463682297617197, 0.014511038083583117, 0.014771085698157549, 0.01450826833024621, 0.014441104605793953, 0.0144265191629529, 0.014525110833346844, 0.014471440110355616, 0.014524044934660196, 0.014623415190726519, 0.014333636965602636, 0.014471488073468208, 0.014471632894128561, 0.014522116165608168, 0.014403935987502337, 0.014538583811372519, 0.014492136891931295, 0.014360004104673862, 0.014399564824998379, 0.01441045617684722, 0.01480325823649764, 0.014604352880269289, 0.014609729871153831, 0.014472398906946182, 0.01464715413749218, 0.01445720111951232, 0.014452443923801184, 0.014509464148432016, 0.01458510896191001, 0.01455360185354948, 0.014518976211547852, 0.014439531601965427, 0.014432492200285196, 0.014574970118701458, 0.014400932937860489, 0.01469196891412139, 0.014375117141753435, 0.01449155481532216, 0.01470439089462161, 0.014412346296012402, 0.014390182681381702, 0.014393655117601156, 0.014758859295397997, 0.014731069561094046, 0.014483113307505846, 0.014483882114291191, 0.014389272779226303, 0.01441599614918232, 0.014463666826486588, 0.014478703960776329, 0.014569951221346855, 0.01447196863591671, 0.014352639205753803, 0.015030255075544119, 0.014437731821089983, 0.01439537014812231, 0.014476943761110306, 0.014560026116669178, 0.014548506122082472, 0.014383256901055574, 0.01456225709989667, 0.014637568034231663, 0.014532589819282293, 0.014729056973010302, 0.01446217019110918, 0.014624088071286678, 0.014447364956140518, 0.014667554758489132, 0.014914856292307377, 0.014593913685530424, 0.014517491217702627, 0.014368962030857801, 0.014445326756685972, 0.014629372395575047, 0.014349676668643951, 0.014639256987720728, 0.01473937090486288, 0.014472510199993849, 0.014438114129006863, 0.014587523881345987, 0.014822250232100487, 0.014491925947368145, 0.014507822692394257, 0.014677322003990412, 0.014521067962050438, 0.014352184254676104, 0.014674408826977015, 0.014418689999729395, 0.014426743146032095, 0.014463518746197224, 0.014412397984415293, 0.014721846207976341, 0.01440484682098031, 0.0144308190792799, 0.014476686250418425, 0.014414451085031033, 0.014462700579315424, 0.01466072304174304, 0.014571529347449541, 0.014735451899468899, 0.014791933819651604, 0.014812428038567305, 0.014512929134070873, 0.01442148769274354, 0.014653111342340708, 0.014493395108729601, 0.01463634753599763, 0.01451071910560131, 0.014496962074190378, 0.014826727099716663, 0.014763995073735714, 0.014491631649434566, 0.014465988148003817, 0.014497841242700815, 0.014465515036135912, 0.014512395020574331, 0.014427902642637491, 0.014752908144146204, 0.014622977934777737, 0.014653768856078386, 0.014315101318061352, 0.014651271048933268, 0.014951094053685665], tpot=0.0, prompt_len=4096, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 20.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  305.93    
Total input tokens:                      4194304   
Total generated tokens:                  238123    
Request throughput (req/s):              3.35      
Output token throughput (tok/s):         778.36    
Total Token throughput (tok/s):          14488.44  
---------------Time to First Token----------------
Mean TTFT (ms):                          121074.98 
Median TTFT (ms):                        121366.74 
P99 TTFT (ms):                           240936.28 
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          244.32    
Median TPOT (ms):                        266.30    
P99 TPOT (ms):                           296.40    
---------------Inter-token Latency----------------
Mean ITL (ms):                           240.39    
Median ITL (ms):                         241.47    
P99 ITL (ms):                            344.76    
==================================================
