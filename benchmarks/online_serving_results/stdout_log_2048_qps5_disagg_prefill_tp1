INFO 07-08 00:15:37 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=100, logprobs=None, request_rate=5.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-5-input-len-2048-tp-1.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=2048, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large amount of text that seems to be a mix of code snippets, error messages, and random text. I\'ll do my best to help you make sense of it.\n\n**Code Snippets:**\n\nThe text contains snippets of code in various programming languages, including:\n\n1. Java: There are several Java code snippets, including Android-related code, Java Servlet code, and JavaFX code.\n2. Python: There are a few Python code snippets, including some related to machine learning and data science.\n3. C++: There is a small C++ code snippet.\n4. JavaScript: There are some JavaScript code snippets, including some related to web development.\n\n**Error Messages:**\n\nThe text also contains several error messages, including:\n\n1. Java errors: There are several Java error messages, including "java.lang.NullPointerException" and "java.lang.ClassNotFoundException".\n2. Python errors: There is a Python error message "TypeError: \'NoneType\' object is not iterable".\n3. C++ errors: There is a C++ error message "undefined reference to `std::cout\'".\n\n**Random Text:**\n\nThe text also contains a large amount of random text, including:\n\n1. Names: There are several names mentioned, including "', success=True, latency=8.18501628190279, output_tokens=256, ttft=8.183651621919125, itl=[4.607904702425003e-05, 1.625390723347664e-05, 9.100884199142456e-06, 6.498303264379501e-06, 5.234964191913605e-06, 5.6871213018894196e-06, 5.028676241636276e-06, 5.304347723722458e-06, 4.936940968036652e-06, 5.378853529691696e-06, 5.160924047231674e-06, 4.867091774940491e-06, 5.118083208799362e-06, 4.82611358165741e-06, 4.837755113840103e-06, 5.0389207899570465e-06, 4.927162081003189e-06, 5.275942385196686e-06, 4.910863935947418e-06, 4.902947694063187e-06, 5.100388079881668e-06, 5.544628947973251e-06, 5.371402949094772e-06, 5.159992724657059e-06, 4.9639493227005005e-06, 5.431007593870163e-06, 5.20097091794014e-06, 4.783738404512405e-06, 5.1353126764297485e-06, 4.785601049661636e-06, 5.532056093215942e-06, 5.136243999004364e-06, 4.9727968871593475e-06, 5.508307367563248e-06, 4.801899194717407e-06, 5.011912435293198e-06, 4.979781806468964e-06, 4.698056727647781e-06, 4.901085048913956e-06, 4.983041435480118e-06, 4.691071808338165e-06, 5.887821316719055e-06, 4.805158823728561e-06, 4.6137720346450806e-06, 5.6442804634571075e-06, 4.861969500780106e-06, 5.067791789770126e-06, 5.264300853013992e-06, 4.936009645462036e-06, 4.845671355724335e-06, 4.89410012960434e-06, 4.920177161693573e-06, 4.829838871955872e-06, 5.424022674560547e-06, 5.063135176897049e-06, 5.288049578666687e-06, 5.05475327372551e-06, 5.1083043217659e-06, 5.019828677177429e-06, 4.966743290424347e-06, 5.022156983613968e-06, 4.814937710762024e-06, 4.8442743718624115e-06, 5.044974386692047e-06, 4.750676453113556e-06, 5.042180418968201e-06, 4.954170435667038e-06, 5.127862095832825e-06, 4.786066710948944e-06, 5.20702451467514e-06, 4.796776920557022e-06, 4.72506508231163e-06, 5.317851901054382e-06, 5.2424147725105286e-06, 4.926696419715881e-06, 4.896894097328186e-06, 4.761386662721634e-06, 5.730893462896347e-06, 4.7888606786727905e-06, 4.746951162815094e-06, 4.867091774940491e-06, 5.47897070646286e-06, 4.766974598169327e-06, 4.76418063044548e-06, 4.7818757593631744e-06, 5.219131708145142e-06, 4.908069968223572e-06, 4.843808710575104e-06, 4.845205694437027e-06, 4.829838871955872e-06, 5.234032869338989e-06, 4.762783646583557e-06, 5.0729140639305115e-06, 5.919020622968674e-06, 5.62937930226326e-06, 4.730653017759323e-06, 4.941131919622421e-06, 5.560927093029022e-06, 4.86522912979126e-06, 4.845671355724335e-06, 4.748348146677017e-06, 4.796776920557022e-06, 4.9578957259655e-06, 5.950219929218292e-06, 4.828907549381256e-06, 4.7888606786727905e-06, 5.672220140695572e-06, 4.974193871021271e-06, 5.036592483520508e-06, 6.042420864105225e-06, 5.073845386505127e-06, 4.724133759737015e-06, 4.812609404325485e-06, 4.967208951711655e-06, 4.7371722757816315e-06, 4.970934242010117e-06, 4.871748387813568e-06, 5.558133125305176e-06, 4.942994564771652e-06, 4.725996404886246e-06, 5.0407834351062775e-06, 5.2121467888355255e-06, 4.784204065799713e-06, 5.526933819055557e-06, 4.8857182264328e-06, 4.761386662721634e-06, 5.725771188735962e-06, 5.017966032028198e-06, 5.021225661039352e-06, 6.2016770243644714e-06, 5.109235644340515e-06, 5.2978284657001495e-06, 5.074311047792435e-06, 6.1639584600925446e-06, 4.978850483894348e-06, 4.868954420089722e-06, 5.138106644153595e-06, 5.2638351917266846e-06, 5.7299621403217316e-06, 5.0961971282958984e-06, 4.745088517665863e-06, 4.987698048353195e-06, 5.146954208612442e-06, 4.949048161506653e-06, 5.051959306001663e-06, 4.96814027428627e-06, 4.738103598356247e-06, 4.711095243692398e-06, 5.142763257026672e-06, 5.817972123622894e-06, 4.855915904045105e-06, 5.1711685955524445e-06, 4.813075065612793e-06, 5.621928721666336e-06, 5.009118467569351e-06, 4.847999662160873e-06, 4.752073436975479e-06, 4.800036549568176e-06, 5.234964191913605e-06, 4.902947694063187e-06, 4.8531219363212585e-06, 4.712957888841629e-06, 5.375593900680542e-06, 4.906207323074341e-06, 4.730187356472015e-06, 4.598870873451233e-06, 4.820059984922409e-06, 5.4729171097278595e-06, 4.999805241823196e-06, 4.695262759923935e-06, 4.8140063881874084e-06, 4.990026354789734e-06, 5.627982318401337e-06, 6.387941539287567e-06, 5.1120296120643616e-06, 4.943925887346268e-06, 4.733912646770477e-06, 4.682224243879318e-06, 4.701782017946243e-06, 5.468260496854782e-06, 5.22984191775322e-06, 5.552079528570175e-06, 4.888046532869339e-06, 4.763714969158173e-06, 4.9942173063755035e-06, 5.043111741542816e-06, 4.805624485015869e-06, 4.7390349209308624e-06, 4.820059984922409e-06, 5.300156772136688e-06, 4.785135388374329e-06, 5.187001079320908e-06, 5.02169132232666e-06, 4.774890840053558e-06, 4.967208951711655e-06, 4.738103598356247e-06, 4.755798727273941e-06, 4.7138892114162445e-06, 5.077105015516281e-06, 4.97233122587204e-06, 5.772802978754044e-06, 6.54999166727066e-06, 5.09386882185936e-06, 5.95487654209137e-06, 4.819128662347794e-06, 4.824250936508179e-06, 4.847068339586258e-06, 4.791654646396637e-06, 4.947185516357422e-06, 4.793982952833176e-06, 4.9578957259655e-06, 4.898291081190109e-06, 5.162786692380905e-06, 4.847999662160873e-06, 4.916917532682419e-06, 4.849862307310104e-06, 4.774425178766251e-06, 5.120877176523209e-06, 6.038695573806763e-06, 5.403999239206314e-06, 5.4943375289440155e-06, 4.886649549007416e-06, 4.8014335334300995e-06, 4.6798959374427795e-06, 4.8871152102947235e-06, 5.033798515796661e-06, 5.316920578479767e-06, 4.6510249376297e-06, 4.969071596860886e-06, 5.277805030345917e-06, 4.966277629137039e-06, 4.8978254199028015e-06, 4.7441571950912476e-06, 5.709938704967499e-06, 6.3711777329444885e-06, 4.883855581283569e-06, 4.773028194904327e-06, 5.743000656366348e-06, 4.808884114027023e-06, 4.7371722757816315e-06, 5.620997399091721e-06, 4.807952791452408e-06, 4.884786903858185e-06, 5.967915058135986e-06, 5.125068128108978e-06, 4.779081791639328e-06, 4.882924258708954e-06, 4.934147000312805e-06, 4.935078322887421e-06, 4.707835614681244e-06, 4.970934242010117e-06, 5.741138011217117e-06, 5.051027983427048e-06, 6.006099283695221e-06, 5.0389207899570465e-06, 5.599111318588257e-06], tpot=0.0, prompt_len=2048, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 5.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     43        
Benchmark duration (s):                  21.76     
Total input tokens:                      88064     
Total generated tokens:                  0         
Request throughput (req/s):              1.98      
Output token throughput (tok/s):         0.00      
Total Token throughput (tok/s):          4047.97   
---------------Time to First Token----------------
Mean TTFT (ms):                          2754.17   
Median TTFT (ms):                        0.00      
P99 TTFT (ms):                           11499.25  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.00      
Median TPOT (ms):                        0.00      
P99 TPOT (ms):                           0.00      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.01      
P99 ITL (ms):                            0.02      
==================================================
