INFO 07-08 00:12:15 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=100, logprobs=None, request_rate=5.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-5-input-len-256-tp-1.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=256, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I'll try to break it down and provide some insights:\n\n**Programming languages and frameworks:**\n\n* Java (e.g., `@NoArgsConstructor`, `Parcelable`)\n* Python (e.g., `pd`, `numpy`)\n* JavaScript (e.g., `OnClickListener`, `Component`)\n* C# (e.g., `Cs`, `Cleanup`)\n* Kotlin (e.g., `lateinit`, `Coroutine`)\n* Android development (e.g., `DataLoader`, `GPIO`, `SENSOR_BUSY`)\n\n**Domains and topics:**\n\n* Artificial intelligence and machine learning (e.g., ` Scientist`, `Filtered`, `estimator`)\n* Data analysis and visualization (e.g., `testData`, `WK`, `Component`)\n* Web development (e.g., `Web`, `Controller`, ` Prague`)\n* Mobile app development (e.g., `Android`, `iOS`, `Parcelable`)\n* Finance and economics (e.g., `NYSE`, `Lack`, ` pellet`)\n* Geography and location-based services (e.g., `Latitude`, `Longitude`, `Brazil`)\n* Automotive and transportation (e", success=True, latency=7.558575326111168, output_tokens=256, ttft=7.557229318190366, itl=[4.276493564248085e-05, 1.8307939171791077e-05, 9.751878678798676e-06, 6.888061761856079e-06, 6.200280040502548e-06, 5.961861461400986e-06, 5.491077899932861e-06, 5.306676030158997e-06, 4.9513764679431915e-06, 5.143694579601288e-06, 5.2051618695259094e-06, 4.979781806468964e-06, 5.336012691259384e-06, 4.755333065986633e-06, 4.807952791452408e-06, 4.8959627747535706e-06, 5.017966032028198e-06, 5.281995981931686e-06, 5.162786692380905e-06, 5.883164703845978e-06, 4.898756742477417e-06, 4.8140063881874084e-06, 5.706213414669037e-06, 5.391892045736313e-06, 4.954170435667038e-06, 5.239155143499374e-06, 4.902016371488571e-06, 5.048699676990509e-06, 5.1478855311870575e-06, 5.13298436999321e-06, 5.843117833137512e-06, 4.995148628950119e-06, 4.912726581096649e-06, 5.324371159076691e-06, 5.061738193035126e-06, 4.773959517478943e-06, 4.731118679046631e-06, 4.886183887720108e-06, 4.777684807777405e-06, 4.757195711135864e-06, 4.654750227928162e-06, 5.340203642845154e-06, 4.8461370170116425e-06, 4.719942808151245e-06, 4.948116838932037e-06, 4.864763468503952e-06, 5.775131285190582e-06, 5.268026143312454e-06, 4.8656947910785675e-06, 4.840083420276642e-06, 4.785135388374329e-06, 4.9578957259655e-06, 4.977919161319733e-06, 6.002373993396759e-06, 4.911795258522034e-06, 5.119945853948593e-06, 4.752073436975479e-06, 4.982110112905502e-06, 4.666857421398163e-06, 5.076173692941666e-06, 4.739966243505478e-06, 4.834961146116257e-06, 5.2656978368759155e-06, 4.757195711135864e-06, 4.775822162628174e-06, 5.501322448253632e-06, 4.875939339399338e-06, 4.7818757593631744e-06, 5.2638351917266846e-06, 4.816334694623947e-06, 4.883855581283569e-06, 4.738103598356247e-06, 4.687812179327011e-06, 4.780944436788559e-06, 4.800036549568176e-06, 4.7869980335235596e-06, 4.739966243505478e-06, 5.587004125118256e-06, 4.8461370170116425e-06, 4.985835403203964e-06, 4.822388291358948e-06, 4.767905920743942e-06, 4.800967872142792e-06, 4.830770194530487e-06, 4.712957888841629e-06, 5.633104592561722e-06, 4.916917532682419e-06, 5.216337740421295e-06, 4.7138892114162445e-06, 4.767905920743942e-06, 4.93321567773819e-06, 5.1888637244701385e-06, 4.707835614681244e-06, 6.200280040502548e-06, 4.834029823541641e-06, 4.741828888654709e-06, 4.728790372610092e-06, 4.893168807029724e-06, 4.659872502088547e-06, 5.110166966915131e-06, 5.125999450683594e-06, 4.836823791265488e-06, 4.897359758615494e-06, 4.767905920743942e-06, 4.772096872329712e-06, 5.251727998256683e-06, 4.773959517478943e-06, 4.772096872329712e-06, 4.704110324382782e-06, 6.454996764659882e-06, 4.745088517665863e-06, 4.868023097515106e-06, 4.809815436601639e-06, 4.7781504690647125e-06, 4.7138892114162445e-06, 5.016103386878967e-06, 5.108769983053207e-06, 4.961155354976654e-06, 5.037989467382431e-06, 5.203764885663986e-06, 5.102250725030899e-06, 4.909001290798187e-06, 4.6137720346450806e-06, 4.773959517478943e-06, 4.773028194904327e-06, 4.7781504690647125e-06, 1.0423827916383743e-05, 5.3783878684043884e-06, 4.815869033336639e-06, 5.695037543773651e-06, 4.9229711294174194e-06, 4.841014742851257e-06, 5.386769771575928e-06, 4.798173904418945e-06, 4.909932613372803e-06, 4.787929356098175e-06, 5.1069073379039764e-06, 4.748348146677017e-06, 4.801899194717407e-06, 5.444977432489395e-06, 5.422160029411316e-06, 4.932750016450882e-06, 4.83216717839241e-06, 4.881992936134338e-06, 5.227979272603989e-06, 4.960689693689346e-06, 4.804227501153946e-06, 4.854053258895874e-06, 4.659872502088547e-06, 6.075017154216766e-06, 4.93926927447319e-06, 4.7655776143074036e-06, 5.340203642845154e-06, 4.899222403764725e-06, 4.6407803893089294e-06, 4.6300701797008514e-06, 4.766043275594711e-06, 4.736706614494324e-06, 4.89410012960434e-06, 4.783272743225098e-06, 5.119945853948593e-06, 4.814937710762024e-06, 5.208887159824371e-06, 4.86103817820549e-06, 4.958827048540115e-06, 4.664063453674316e-06, 5.125999450683594e-06, 5.110166966915131e-06, 4.7888606786727905e-06, 4.719942808151245e-06, 4.811212420463562e-06, 5.244743078947067e-06, 4.66126948595047e-06, 5.6801363825798035e-06, 4.898756742477417e-06, 4.61190938949585e-06, 4.796311259269714e-06, 5.470588803291321e-06, 4.881992936134338e-06, 4.828441888093948e-06, 4.721805453300476e-06, 4.7478824853897095e-06, 5.397014319896698e-06, 4.780944436788559e-06, 5.1050446927547455e-06, 4.942063242197037e-06, 4.643108695745468e-06, 4.67570498585701e-06, 4.7120265662670135e-06, 4.738103598356247e-06, 4.62215393781662e-06, 4.746951162815094e-06, 4.698056727647781e-06, 4.789792001247406e-06, 4.726927727460861e-06, 5.213078111410141e-06, 5.023088306188583e-06, 4.880130290985107e-06, 4.837755113840103e-06, 4.685018211603165e-06, 4.82192263007164e-06, 6.124377250671387e-06, 4.855915904045105e-06, 4.654750227928162e-06, 4.717148840427399e-06, 4.7441571950912476e-06, 4.75393608212471e-06, 5.99399209022522e-06, 4.621688276529312e-06, 4.743225872516632e-06, 4.841946065425873e-06, 4.8102810978889465e-06, 5.3015537559986115e-06, 4.995148628950119e-06, 4.69619408249855e-06, 5.719717592000961e-06, 4.777219146490097e-06, 4.7781504690647125e-06, 5.024950951337814e-06, 4.768837243318558e-06, 4.974193871021271e-06, 4.717614501714706e-06, 4.644971340894699e-06, 4.69014048576355e-06, 4.722271114587784e-06, 4.7497451305389404e-06, 5.424022674560547e-06, 4.741828888654709e-06, 4.634261131286621e-06, 4.721805453300476e-06, 4.736240953207016e-06, 5.330890417098999e-06, 4.869885742664337e-06, 5.639158189296722e-06, 5.051959306001663e-06, 4.8461370170116425e-06, 4.696659743785858e-06, 5.21540641784668e-06, 4.667788743972778e-06, 4.801899194717407e-06, 4.658941179513931e-06, 4.620291292667389e-06, 5.2587129175662994e-06, 4.692003130912781e-06, 4.8889778554439545e-06, 4.653353244066238e-06, 4.874076694250107e-06, 4.725996404886246e-06, 4.666857421398163e-06, 4.787929356098175e-06, 4.958827048540115e-06, 4.732981324195862e-06, 4.847068339586258e-06, 5.665235221385956e-06, 7.682014256715775e-06, 5.337875336408615e-06], tpot=0.0, prompt_len=256, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 5.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     100       
Benchmark duration (s):                  31.68     
Total input tokens:                      25600     
Total generated tokens:                  23392     
Request throughput (req/s):              3.16      
Output token throughput (tok/s):         738.46    
Total Token throughput (tok/s):          1546.63   
---------------Time to First Token----------------
Mean TTFT (ms):                          16823.55  
Median TTFT (ms):                        16964.42  
P99 TTFT (ms):                           27657.63  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.00      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
