INFO 07-10 23:23:54 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=5.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-5-input-len-256-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=256, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I\'ll try to break it down and provide some insights:\n\n**Programming languages and frameworks:**\n\n* Java (e.g., `@NoArgsConstructor`, `Parcelable`)\n* Python (e.g., `pd`, `numpy`)\n* JavaScript (e.g., `OnClickListener`, `Component`)\n* C++ (e.g., `GPIO`)\n* Kotlin (e.g., `data class`)\n\n**Domains and topics:**\n\n* Machine learning (e.g., `DataLoader`, `estimator`)\n* Android development (e.g., `OnClickListener`, `Parcelable`)\n* Web development (e.g., `Component`, `React`)\n* IoT (e.g., `GPIO`)\n* Finance (e.g., `NYSE`, `profit`)\n* Geography (e.g., `Latitude`, `Longitude`)\n* Politics (e.g., `Cuomo`, `Judicial`)\n\n**Other observations:**\n\n* There are many typos and grammatical errors throughout the text.\n* Some words and phrases appear to be randomly inserted or concatenated (e.g., `cheng Milit"&finding`, `flotation.sensorBrazil`).\n* There', success=True, latency=4.742842648178339, output_tokens=256, ttft=4.741489187814295, itl=[4.651816561818123e-05, 1.6994774341583252e-05, 9.078066796064377e-06, 6.588175892829895e-06, 5.68293035030365e-06, 5.89713454246521e-06, 5.423091351985931e-06, 5.1138922572135925e-06, 4.9318186938762665e-06, 4.899222403764725e-06, 5.214940756559372e-06, 4.823785275220871e-06, 5.424953997135162e-06, 4.813075065612793e-06, 4.893168807029724e-06, 4.848930984735489e-06, 4.798173904418945e-06, 5.184672772884369e-06, 5.295034497976303e-06, 5.383044481277466e-06, 4.880130290985107e-06, 4.947185516357422e-06, 5.804002285003662e-06, 5.086883902549744e-06, 4.910863935947418e-06, 5.350913852453232e-06, 4.909932613372803e-06, 4.925299435853958e-06, 5.023088306188583e-06, 5.069654434919357e-06, 6.2319450080394745e-06, 5.17629086971283e-06, 4.773959517478943e-06, 5.248934030532837e-06, 4.903879016637802e-06, 4.8102810978889465e-06, 4.877801984548569e-06, 4.892237484455109e-06, 4.827976226806641e-06, 4.835892468690872e-06, 4.792120307683945e-06, 5.453824996948242e-06, 4.910863935947418e-06, 4.857312887907028e-06, 4.949979484081268e-06, 4.729721695184708e-06, 5.639158189296722e-06, 5.159061402082443e-06, 4.993751645088196e-06, 5.0263479351997375e-06, 4.927627742290497e-06, 4.873145371675491e-06, 4.949979484081268e-06, 5.695037543773651e-06, 4.910863935947418e-06, 5.179084837436676e-06, 4.910863935947418e-06, 5.015172064304352e-06, 4.854053258895874e-06, 5.026813596487045e-06, 4.790257662534714e-06, 4.848930984735489e-06, 5.283858627080917e-06, 4.798173904418945e-06, 4.905741661787033e-06, 5.328096449375153e-06, 5.031004548072815e-06, 4.89410012960434e-06, 5.100853741168976e-06, 4.732050001621246e-06, 4.786066710948944e-06, 4.866160452365875e-06, 4.698056727647781e-06, 4.7907233238220215e-06, 4.910863935947418e-06, 4.783272743225098e-06, 4.864763468503952e-06, 5.559064447879791e-06, 4.948116838932037e-06, 4.842877388000488e-06, 4.819128662347794e-06, 4.8638321459293365e-06, 4.89410012960434e-06, 4.738103598356247e-06, 4.661735147237778e-06, 5.455221980810165e-06, 4.815869033336639e-06, 5.27501106262207e-06, 4.745088517665863e-06, 4.751142114400864e-06, 4.874076694250107e-06, 5.642883479595184e-06, 4.767905920743942e-06, 6.24312087893486e-06, 5.120877176523209e-06, 4.802830517292023e-06, 4.783272743225098e-06, 4.901085048913956e-06, 4.7800131142139435e-06, 5.220063030719757e-06, 4.804693162441254e-06, 4.786066710948944e-06, 4.735775291919708e-06, 4.888046532869339e-06, 4.69014048576355e-06, 5.255918949842453e-06, 4.75393608212471e-06, 4.781410098075867e-06, 4.7818757593631744e-06, 5.7998113334178925e-06, 5.166046321392059e-06, 4.93926927447319e-06, 4.727859050035477e-06, 4.775822162628174e-06, 5.248934030532837e-06, 4.732981324195862e-06, 5.105976015329361e-06, 5.609355866909027e-06, 4.77861613035202e-06, 4.866160452365875e-06, 4.967208951711655e-06, 5.069654434919357e-06, 4.905276000499725e-06, 4.875939339399338e-06, 4.847068339586258e-06, 4.6049244701862335e-06, 4.834029823541641e-06, 5.077105015516281e-06, 4.682689905166626e-06, 5.782116204500198e-06, 5.083158612251282e-06, 4.842877388000488e-06, 4.911795258522034e-06, 4.792120307683945e-06, 4.875939339399338e-06, 5.363021045923233e-06, 4.850327968597412e-06, 5.0747767090797424e-06, 4.760921001434326e-06, 4.949048161506653e-06, 4.883855581283569e-06, 4.984438419342041e-06, 4.967674612998962e-06, 4.800036549568176e-06, 4.868954420089722e-06, 4.986301064491272e-06, 4.656612873077393e-06, 4.779081791639328e-06, 4.76418063044548e-06, 6.857793778181076e-06, 4.9513764679431915e-06, 4.752539098262787e-06, 4.6943314373493195e-06, 4.82192263007164e-06, 5.027744919061661e-06, 4.925299435853958e-06, 4.823785275220871e-06, 4.785135388374329e-06, 6.211921572685242e-06, 4.883855581283569e-06, 4.864297807216644e-06, 4.7818757593631744e-06, 4.860106855630875e-06, 4.820059984922409e-06, 5.000736564397812e-06, 4.650093615055084e-06, 4.872214049100876e-06, 4.871748387813568e-06, 4.675239324569702e-06, 4.845671355724335e-06, 4.9211084842681885e-06, 4.723202437162399e-06, 4.726927727460861e-06, 6.082933396100998e-06, 4.983972758054733e-06, 4.870817065238953e-06, 5.229376256465912e-06, 4.801899194717407e-06, 4.903879016637802e-06, 4.818197339773178e-06, 4.795845597982407e-06, 4.888046532869339e-06, 5.268026143312454e-06, 4.7157518565654755e-06, 5.841255187988281e-06, 7.434748113155365e-06, 5.1083043217659e-06, 4.9299560487270355e-06, 4.78280708193779e-06, 4.745088517665863e-06, 5.002133548259735e-06, 5.23589551448822e-06, 4.888046532869339e-06, 4.898756742477417e-06, 5.241017788648605e-06, 4.79305163025856e-06, 4.872214049100876e-06, 4.717148840427399e-06, 4.628673195838928e-06, 4.7869980335235596e-06, 4.850327968597412e-06, 6.269663572311401e-06, 5.3942203521728516e-06, 4.736706614494324e-06, 4.893168807029724e-06, 4.8978254199028015e-06, 5.7513825595378876e-06, 4.796776920557022e-06, 4.870817065238953e-06, 4.957430064678192e-06, 4.819594323635101e-06, 5.017966032028198e-06, 4.911329597234726e-06, 5.787704139947891e-06, 4.851259291172028e-06, 4.7157518565654755e-06, 4.766974598169327e-06, 4.895031452178955e-06, 4.711095243692398e-06, 4.742294549942017e-06, 5.71785494685173e-06, 5.283858627080917e-06, 4.93926927447319e-06, 4.842877388000488e-06, 4.823785275220871e-06, 4.899222403764725e-06, 4.8247165977954865e-06, 5.2801333367824554e-06, 5.086883902549744e-06, 4.779081791639328e-06, 4.7762878239154816e-06, 4.950910806655884e-06, 5.85801899433136e-06, 6.06197863817215e-06, 5.135778337717056e-06, 5.343928933143616e-06, 5.04637137055397e-06, 5.311798304319382e-06, 4.908069968223572e-06, 4.875939339399338e-06, 4.9942173063755035e-06, 4.78280708193779e-06, 4.855915904045105e-06, 4.691071808338165e-06, 4.8228539526462555e-06, 5.0533562898635864e-06, 5.22565096616745e-06, 4.983972758054733e-06, 4.7693029046058655e-06, 4.659872502088547e-06, 4.9388036131858826e-06, 5.756039172410965e-06, 4.891306161880493e-06, 4.7907233238220215e-06, 5.7462602853775024e-06, 6.477814167737961e-06], tpot=0.0, prompt_len=256, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 5.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     766       
Benchmark duration (s):                  217.18    
Total input tokens:                      196096    
Total generated tokens:                  169458    
Request throughput (req/s):              3.53      
Output token throughput (tok/s):         780.28    
Total Token throughput (tok/s):          1683.22   
---------------Time to First Token----------------
Mean TTFT (ms):                          7007.28   
Median TTFT (ms):                        7597.05   
P99 TTFT (ms):                           9423.60   
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
