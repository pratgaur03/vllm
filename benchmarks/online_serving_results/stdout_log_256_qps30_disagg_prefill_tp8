INFO 07-10 22:54:12 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=30.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-30-input-len-256-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=256, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text='It appears that you\'ve provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I\'ll try to break it down and provide some insights:\n\n**Programming languages and frameworks:**\n\n* Java (e.g., `@NoArgsConstructor`, `Parcelable`)\n* Python (e.g., `pd`, `numpy`)\n* JavaScript (e.g., `OnClickListener`, `Component`)\n* C++ (e.g., `GPIO`)\n* Kotlin (e.g., `data class`)\n\n**Domains and topics:**\n\n* Machine learning (e.g., `DataLoader`, `estimator`)\n* Android development (e.g., `OnClickListener`, `Parcelable`)\n* Web development (e.g., `Component`, `React`)\n* IoT (e.g., `GPIO`)\n* Finance (e.g., `NYSE`, `profit`)\n* Geography (e.g., `Latitude`, `Longitude`)\n* Politics (e.g., `Cuomo`, `Judicial`)\n\n**Other observations:**\n\n* There are many typos and grammatical errors throughout the text.\n* Some words and phrases appear to be randomly inserted or concatenated (e.g., `cheng Milit"&finding`, `flotation.sensorBrazil`).\n* There', success=True, latency=4.635348901152611, output_tokens=256, ttft=4.632764912210405, itl=[6.373180076479912e-05, 3.111874684691429e-05, 1.5266239643096924e-05, 1.1357944458723068e-05, 1.0089017450809479e-05, 1.051509752869606e-05, 1.019984483718872e-05, 8.10716301202774e-06, 9.493902325630188e-06, 9.6089206635952e-06, 9.810086339712143e-06, 9.485986083745956e-06, 9.78587195277214e-06, 9.496230632066727e-06, 9.457115083932877e-06, 9.460840374231339e-06, 9.396113455295563e-06, 1.0009855031967163e-05, 9.885989129543304e-06, 9.987037628889084e-06, 9.419862180948257e-06, 9.599141776561737e-06, 1.0340940207242966e-05, 9.820796549320221e-06, 9.762123227119446e-06, 9.877141565084457e-06, 9.546056389808655e-06, 9.657815098762512e-06, 9.830109775066376e-06, 9.684823453426361e-06, 1.0957010090351105e-05, 9.836163371801376e-06, 9.635929018259048e-06, 1.0043848305940628e-05, 9.463168680667877e-06, 9.417999535799026e-06, 9.579118341207504e-06, 1.7837155610322952e-05, 9.366776794195175e-06, 9.636860340833664e-06, 9.485986083745956e-06, 1.003313809633255e-05, 9.835232049226761e-06, 9.393785148859024e-06, 9.592156857252121e-06, 9.577721357345581e-06, 1.2709293514490128e-05, 9.881798177957535e-06, 9.797979146242142e-06, 9.594950824975967e-06, 9.533949196338654e-06, 9.395182132720947e-06, 9.5427967607975e-06, 1.0860152542591095e-05, 9.573996067047119e-06, 9.985174983739853e-06, 9.512994438409805e-06, 9.547919034957886e-06, 9.594019502401352e-06, 9.70577821135521e-06, 9.413342922925949e-06, 9.6149742603302e-06, 9.992625564336777e-06, 9.543262422084808e-06, 9.47713851928711e-06, 1.0130926966667175e-05, 9.691808372735977e-06, 9.492039680480957e-06, 1.0018236935138702e-05, 9.473878890275955e-06, 9.516719728708267e-06, 9.523238986730576e-06, 9.498093277215958e-06, 9.405892342329025e-06, 9.61311161518097e-06, 9.283889085054398e-06, 9.375158697366714e-06, 1.0321848094463348e-05, 9.697861969470978e-06, 9.524170309305191e-06, 9.64384526014328e-06, 9.221956133842468e-06, 9.431969374418259e-06, 9.496230632066727e-06, 9.417068213224411e-06, 1.0087620466947556e-05, 9.701121598482132e-06, 9.994953870773315e-06, 9.418930858373642e-06, 9.352341294288635e-06, 9.642913937568665e-06, 9.658746421337128e-06, 9.508337825536728e-06, 1.0703690350055695e-05, 9.680166840553284e-06, 9.469222277402878e-06, 9.482726454734802e-06, 9.48924571275711e-06, 9.327661246061325e-06, 9.931158274412155e-06, 9.541865438222885e-06, 9.282026439905167e-06, 9.397976100444794e-06, 9.391922503709793e-06, 9.49343666434288e-06, 1.011975109577179e-05, 9.417068213224411e-06, 9.40077006816864e-06, 9.46037471294403e-06, 1.7069745808839798e-05, 9.85385850071907e-06, 9.572133421897888e-06, 9.498093277215958e-06, 9.175855666399002e-06, 9.821262210607529e-06, 9.413808584213257e-06, 1.0981224477291107e-05, 9.697861969470978e-06, 9.40077006816864e-06, 9.478069841861725e-06, 1.0190065950155258e-05, 9.64384526014328e-06, 9.41520556807518e-06, 9.528826922178268e-06, 9.323004633188248e-06, 9.481329470872879e-06, 9.5367431640625e-06, 9.238254278898239e-06, 9.6149742603302e-06, 1.0695774108171463e-05, 1.0677147656679153e-05, 9.616836905479431e-06, 9.37189906835556e-06, 9.563285857439041e-06, 1.0132789611816406e-05, 9.923242032527924e-06, 1.0374002158641815e-05, 9.445007890462875e-06, 9.426847100257874e-06, 9.470153599977493e-06, 9.33278352022171e-06, 9.546056389808655e-06, 9.179115295410156e-06, 9.506940841674805e-06, 1.006387174129486e-05, 9.940937161445618e-06, 9.478069841861725e-06, 9.54093411564827e-06, 1.130811870098114e-05, 1.1181924492120743e-05, 9.573064744472504e-06, 9.37609001994133e-06, 9.27317887544632e-06, 1.0338611900806427e-05, 9.795185178518295e-06, 9.342096745967865e-06, 9.37189906835556e-06, 9.854789823293686e-06, 9.609386324882507e-06, 9.397976100444794e-06, 9.237788617610931e-06, 9.451992809772491e-06, 9.548850357532501e-06, 1.0017305612564087e-05, 9.600073099136353e-06, 9.415671229362488e-06, 9.334180504083633e-06, 9.40077006816864e-06, 9.469222277402878e-06, 9.663868695497513e-06, 9.366311132907867e-06, 9.483657777309418e-06, 9.45432111620903e-06, 1.101987436413765e-05, 9.481795132160187e-06, 9.606126695871353e-06, 9.683892130851746e-06, 9.300187230110168e-06, 9.322073310613632e-06, 9.310897439718246e-06, 9.422190487384796e-06, 1.0177027434110641e-05, 9.389594197273254e-06, 9.280163794755936e-06, 9.419862180948257e-06, 1.0472256690263748e-05, 9.539071470499039e-06, 9.241979569196701e-06, 9.273644536733627e-06, 9.549316018819809e-06, 1.0127667337656021e-05, 9.362120181322098e-06, 9.452924132347107e-06, 1.0167248547077179e-05, 9.589828550815582e-06, 9.45013016462326e-06, 9.465962648391724e-06, 9.426847100257874e-06, 9.245239198207855e-06, 9.346753358840942e-06, 9.212177246809006e-06, 1.006806269288063e-05, 9.79611650109291e-06, 9.43569466471672e-06, 9.414274245500565e-06, 9.29972156882286e-06, 1.0331161320209503e-05, 9.292736649513245e-06, 9.478069841861725e-06, 9.302981197834015e-06, 9.3863345682621e-06, 9.6149742603302e-06, 9.331852197647095e-06, 1.0040123015642166e-05, 9.515788406133652e-06, 9.221024811267853e-06, 9.430106729269028e-06, 9.519048035144806e-06, 9.417068213224411e-06, 9.228009730577469e-06, 1.016492024064064e-05, 9.651761502027512e-06, 9.526032954454422e-06, 9.289011359214783e-06, 9.286217391490936e-06, 9.495764970779419e-06, 9.384006261825562e-06, 1.0170973837375641e-05, 9.519048035144806e-06, 9.404029697179794e-06, 9.43802297115326e-06, 9.462237358093262e-06, 9.78587195277214e-06, 1.0363757610321045e-05, 9.607058018445969e-06, 9.966082870960236e-06, 9.593088179826736e-06, 9.603798389434814e-06, 9.196344763040543e-06, 9.455718100070953e-06, 9.328126907348633e-06, 9.307172149419785e-06, 9.452924132347107e-06, 9.408686310052872e-06, 9.320210665464401e-06, 9.707175195217133e-06, 9.682029485702515e-06, 9.331852197647095e-06, 9.373761713504791e-06, 9.309966117143631e-06, 9.594019502401352e-06, 9.888317435979843e-06, 9.58004966378212e-06, 9.454786777496338e-06, 1.078704372048378e-05, 1.1787749826908112e-05], tpot=0.0, prompt_len=256, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 30.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  63.44     
Total input tokens:                      262144    
Total generated tokens:                  118569    
Request throughput (req/s):              16.14     
Output token throughput (tok/s):         1868.96   
Total Token throughput (tok/s):          6001.03   
---------------Time to First Token----------------
Mean TTFT (ms):                          21708.32  
Median TTFT (ms):                        24131.76  
P99 TTFT (ms):                           45425.65  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.01      
P99 ITL (ms):                            0.01      
==================================================
