INFO 07-10 01:18:40 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=20.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-20-input-len-512-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=512, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and contexts. I'll try to break it down and provide some insights.\n\n**Observations:**\n\n1. **Mixed languages**: The text contains code snippets and keywords from multiple programming languages, including Java, Python, C++, and JavaScript.\n2. **Technical terms**: There are many technical terms and concepts mentioned, such as machine learning, data loading, GPIO, sensors, and more.\n3. **Company and product names**: Some company and product names are mentioned, like Volvo, Xiaomi, and macOS.\n4. **Geographic locations**: Several geographic locations are mentioned, including Brazil, Omaha, and Prague.\n5. **Random words and phrases**: The text also contains random words and phrases that don't seem to be related to any specific topic or context.\n\n**Possible explanations:**\n\n1. **Code dump**: It's possible that someone has dumped a large amount of code and text into a single block, without any organization or context.\n2. **Automated text generation**: The text might have been generated automatically using a tool or algorithm that combines different sources of text and code.\n3. **Error or glitch**:", success=True, latency=4.715488481801003, output_tokens=256, ttft=4.714136189781129, itl=[4.668207839131355e-05, 1.654820516705513e-05, 9.967945516109467e-06, 7.169786840677261e-06, 5.559995770454407e-06, 5.589332431554794e-06, 5.535781383514404e-06, 5.194917321205139e-06, 4.8102810978889465e-06, 4.808884114027023e-06, 4.85079362988472e-06, 4.970002919435501e-06, 5.230307579040527e-06, 4.8140063881874084e-06, 4.837755113840103e-06, 4.770234227180481e-06, 4.8317015171051025e-06, 5.187932401895523e-06, 5.17629086971283e-06, 5.1478855311870575e-06, 5.0282105803489685e-06, 4.802830517292023e-06, 5.455221980810165e-06, 5.366746336221695e-06, 4.825182259082794e-06, 5.205627530813217e-06, 4.9280934035778046e-06, 4.936009645462036e-06, 4.872214049100876e-06, 4.909932613372803e-06, 5.661044269800186e-06, 5.173031240701675e-06, 4.810746759176254e-06, 5.224253982305527e-06, 4.902947694063187e-06, 4.8531219363212585e-06, 4.703644663095474e-06, 4.732050001621246e-06, 4.7693029046058655e-06, 4.716683179140091e-06, 4.854053258895874e-06, 5.153007805347443e-06, 4.7478824853897095e-06, 4.6263448894023895e-06, 4.7460198402404785e-06, 4.7497451305389404e-06, 5.908310413360596e-06, 4.7227367758750916e-06, 4.69014048576355e-06, 4.8209913074970245e-06, 4.990026354789734e-06, 5.116686224937439e-06, 4.79724258184433e-06, 5.2801333367824554e-06, 4.7120265662670135e-06, 4.709698259830475e-06, 4.989095032215118e-06, 4.61796298623085e-06, 4.7292560338974e-06, 5.244743078947067e-06, 4.923902451992035e-06, 5.218200385570526e-06, 4.686880856752396e-06, 4.6798959374427795e-06, 5.294103175401688e-06, 5.2158720791339874e-06, 5.570240318775177e-06, 4.971865564584732e-06, 4.940200597047806e-06, 4.9578957259655e-06, 4.794914275407791e-06, 4.804227501153946e-06, 4.648696631193161e-06, 5.109235644340515e-06, 4.64683398604393e-06, 4.770234227180481e-06, 4.786066710948944e-06, 5.977693945169449e-06, 5.21121546626091e-06, 4.951842129230499e-06, 4.759058356285095e-06, 4.759058356285095e-06, 4.637986421585083e-06, 5.114823579788208e-06, 4.710163921117783e-06, 5.1138922572135925e-06, 4.685018211603165e-06, 4.683155566453934e-06, 5.177687853574753e-06, 4.709232598543167e-06, 4.827976226806641e-06, 4.760921001434326e-06, 4.854053258895874e-06, 7.019843906164169e-06, 5.4389238357543945e-06, 5.117151886224747e-06, 4.814937710762024e-06, 5.014240741729736e-06, 4.98676672577858e-06, 4.773959517478943e-06, 4.709232598543167e-06, 4.751142114400864e-06, 5.164649337530136e-06, 4.732981324195862e-06, 4.823319613933563e-06, 4.728790372610092e-06, 4.815869033336639e-06, 4.656147211790085e-06, 4.806090146303177e-06, 6.502028554677963e-06, 5.168840289115906e-06, 4.946254193782806e-06, 4.966743290424347e-06, 4.841014742851257e-06, 4.9299560487270355e-06, 4.993285983800888e-06, 4.8656947910785675e-06, 5.031004548072815e-06, 4.6729110181331635e-06, 4.702247679233551e-06, 5.239155143499374e-06, 4.71482053399086e-06, 4.786066710948944e-06, 5.02169132232666e-06, 4.7762878239154816e-06, 4.739966243505478e-06, 4.673842340707779e-06, 4.69619408249855e-06, 4.7548674046993256e-06, 6.299000233411789e-06, 9.48924571275711e-06, 4.9388036131858826e-06, 4.76418063044548e-06, 4.866626113653183e-06, 4.9602240324020386e-06, 4.680827260017395e-06, 4.824250936508179e-06, 4.614703357219696e-06, 4.847999662160873e-06, 5.008187144994736e-06, 4.725996404886246e-06, 4.879198968410492e-06, 5.381647497415543e-06, 5.0943344831466675e-06, 4.687812179327011e-06, 4.660803824663162e-06, 5.006324499845505e-06, 4.909932613372803e-06, 4.728790372610092e-06, 6.0820020735263824e-06, 4.9532391130924225e-06, 4.98676672577858e-06, 4.6943314373493195e-06, 4.727859050035477e-06, 4.825182259082794e-06, 4.7907233238220215e-06, 4.750210791826248e-06, 4.720874130725861e-06, 4.624947905540466e-06, 5.408190190792084e-06, 4.759989678859711e-06, 4.746951162815094e-06, 4.639849066734314e-06, 5.091074854135513e-06, 4.7390349209308624e-06, 4.582107067108154e-06, 5.3658150136470795e-06, 4.671979695558548e-06, 6.154179573059082e-06, 4.840083420276642e-06, 4.699919372797012e-06, 5.441717803478241e-06, 4.9979425966739655e-06, 5.966052412986755e-06, 4.71901148557663e-06, 4.7353096306324005e-06, 4.5979395508766174e-06, 4.759058356285095e-06, 5.092937499284744e-06, 4.695728421211243e-06, 4.8102810978889465e-06, 5.251727998256683e-06, 4.800036549568176e-06, 4.6510249376297e-06, 6.007961928844452e-06, 4.915054887533188e-06, 4.736240953207016e-06, 4.881061613559723e-06, 4.685018211603165e-06, 4.780944436788559e-06, 4.652887582778931e-06, 4.694797098636627e-06, 5.878042429685593e-06, 4.647299647331238e-06, 4.689674824476242e-06, 4.813075065612793e-06, 5.418900400400162e-06, 4.9192458391189575e-06, 4.755798727273941e-06, 4.818197339773178e-06, 4.878733307123184e-06, 6.501097232103348e-06, 6.119254976511002e-06, 4.883855581283569e-06, 4.791188985109329e-06, 6.042886525392532e-06, 4.830770194530487e-06, 4.580244421958923e-06, 4.699919372797012e-06, 5.065929144620895e-06, 4.743225872516632e-06, 4.622619599103928e-06, 5.00725582242012e-06, 5.447771400213242e-06, 4.658009856939316e-06, 5.539972335100174e-06, 4.825182259082794e-06, 5.634967237710953e-06, 4.69014048576355e-06, 4.723668098449707e-06, 5.142297595739365e-06, 5.668960511684418e-06, 4.7371722757816315e-06, 4.877801984548569e-06, 4.721805453300476e-06, 4.663132131099701e-06, 5.471985787153244e-06, 4.834029823541641e-06, 5.665235221385956e-06, 4.967674612998962e-06, 4.631001502275467e-06, 4.886183887720108e-06, 5.080830305814743e-06, 6.6892243921756744e-06, 6.6016800701618195e-06, 5.5711716413497925e-06, 4.9658119678497314e-06, 4.681292921304703e-06, 4.71482053399086e-06, 5.095265805721283e-06, 4.902947694063187e-06, 5.756039172410965e-06, 4.8996880650520325e-06, 6.074085831642151e-06, 4.949979484081268e-06, 4.671979695558548e-06, 5.920883268117905e-06, 4.886183887720108e-06, 4.676170647144318e-06, 4.706904292106628e-06, 4.915986210107803e-06, 4.75393608212471e-06, 4.792120307683945e-06, 4.616100341081619e-06, 4.769768565893173e-06, 6.605871021747589e-06], tpot=0.0, prompt_len=512, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 20.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  97.17     
Total input tokens:                      524288    
Total generated tokens:                  147340    
Request throughput (req/s):              10.54     
Output token throughput (tok/s):         1516.31   
Total Token throughput (tok/s):          6911.86   
---------------Time to First Token----------------
Mean TTFT (ms):                          37577.66  
Median TTFT (ms):                        41785.16  
P99 TTFT (ms):                           63236.44  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
