INFO 07-08 01:17:18 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=100, logprobs=None, request_rate=50.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-50-input-len-256-tp-1.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=256, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I'll try to break it down and provide some insights:\n\n**Programming languages and frameworks:**\n\n* Java (e.g., `@NoArgsConstructor`, `Parcelable`)\n* Python (e.g., `pd`, `testProfit`)\n* JavaScript (e.g., `OnClickListener`, `nextProps`)\n* C# (e.g., `Cleanup.structure`)\n* Kotlin (e.g., `lateinit`, `CoroutineScope`)\n\n**Domains and topics:**\n\n* Android development (e.g., `OnClickListener`, `Parcelable`)\n* Data science and machine learning (e.g., `testProfit`, `estimator`)\n* Web development (e.g., `nextProps`, `Cleanup.structure`)\n* IoT and embedded systems (e.g., `GPIO`, `SENSOR_BUSY`)\n* Finance and economics (e.g., `NYSE`, `Lack`)\n* Geography and mapping (e.g., `Latitude`, `Longitude`)\n\n**Other observations:**\n\n* There are many typos and grammatical errors throughout the text.\n* Some words and phrases appear to be in different languages, such as German (`wei√ü`, `bit", success=True, latency=8.798070773947984, output_tokens=256, ttft=8.796709202229977, itl=[4.791701212525368e-05, 1.7026904970407486e-05, 1.0348856449127197e-05, 7.45430588722229e-06, 5.846843123435974e-06, 6.437767297029495e-06, 5.715992301702499e-06, 5.367211997509003e-06, 5.059875547885895e-06, 5.083158612251282e-06, 5.317851901054382e-06, 5.17209991812706e-06, 5.342066287994385e-06, 4.847999662160873e-06, 5.094800144433975e-06, 4.967208951711655e-06, 4.787929356098175e-06, 5.2051618695259094e-06, 5.058944225311279e-06, 5.4407864809036255e-06, 4.93321567773819e-06, 5.0300732254981995e-06, 5.702953785657883e-06, 5.319714546203613e-06, 4.90434467792511e-06, 5.20097091794014e-06, 5.12879341840744e-06, 5.052890628576279e-06, 5.370005965232849e-06, 5.1460228860378265e-06, 5.946028977632523e-06, 5.2158720791339874e-06, 4.901085048913956e-06, 5.501322448253632e-06, 4.7977082431316376e-06, 4.89410012960434e-06, 5.110166966915131e-06, 5.005858838558197e-06, 5.002133548259735e-06, 4.922039806842804e-06, 4.961621016263962e-06, 5.196314305067062e-06, 4.776753485202789e-06, 5.017034709453583e-06, 4.891306161880493e-06, 4.943925887346268e-06, 5.567912012338638e-06, 5.073845386505127e-06, 4.766974598169327e-06, 5.029141902923584e-06, 4.8209913074970245e-06, 4.9280934035778046e-06, 5.085952579975128e-06, 5.7639554142951965e-06, 5.0691887736320496e-06, 5.125999450683594e-06, 4.768837243318558e-06, 5.02588227391243e-06, 4.881061613559723e-06, 5.042180418968201e-06, 4.787929356098175e-06, 4.912726581096649e-06, 5.3513795137405396e-06, 4.676636308431625e-06, 4.9853697419166565e-06, 5.504582077264786e-06, 4.952307790517807e-06, 4.813075065612793e-06, 5.19677996635437e-06, 4.804227501153946e-06, 4.798639565706253e-06, 4.823319613933563e-06, 4.701782017946243e-06, 4.6729110181331635e-06, 4.7711655497550964e-06, 4.724133759737015e-06, 4.870817065238953e-06, 5.37605956196785e-06, 4.805158823728561e-06, 4.936009645462036e-06, 4.855915904045105e-06, 4.802830517292023e-06, 4.610978066921234e-06, 4.875939339399338e-06, 5.477108061313629e-06, 4.691071808338165e-06, 4.795845597982407e-06, 5.234964191913605e-06, 4.761386662721634e-06, 4.809815436601639e-06, 4.848930984735489e-06, 5.193054676055908e-06, 4.914123564958572e-06, 5.99399209022522e-06, 5.0370581448078156e-06, 4.71901148557663e-06, 4.955567419528961e-06, 4.631001502275467e-06, 4.652421921491623e-06, 4.71062958240509e-06, 5.379319190979004e-06, 4.809815436601639e-06, 5.395151674747467e-06, 4.803761839866638e-06, 4.892237484455109e-06, 4.738103598356247e-06, 4.783738404512405e-06, 4.854053258895874e-06, 4.794914275407791e-06, 5.817972123622894e-06, 4.907138645648956e-06, 4.796776920557022e-06, 4.715286195278168e-06, 5.211681127548218e-06, 4.869420081377029e-06, 5.642883479595184e-06, 4.880130290985107e-06, 4.904810339212418e-06, 4.903879016637802e-06, 5.003996193408966e-06, 1.4222227036952972e-05, 5.143694579601288e-06, 4.7460198402404785e-06, 4.829373210668564e-06, 4.8317015171051025e-06, 4.902016371488571e-06, 4.817266017198563e-06, 5.232635885477066e-06, 4.693400114774704e-06, 5.7229772210121155e-06, 4.807952791452408e-06, 4.805624485015869e-06, 4.679430276155472e-06, 5.326699465513229e-06, 5.011912435293198e-06, 4.636123776435852e-06, 4.858244210481644e-06, 4.7888606786727905e-06, 4.808884114027023e-06, 4.656147211790085e-06, 5.275942385196686e-06, 5.049165338277817e-06, 4.7800131142139435e-06, 5.939975380897522e-06, 4.99282032251358e-06, 4.740897566080093e-06, 4.756264388561249e-06, 4.566740244626999e-06, 4.842877388000488e-06, 6.549060344696045e-06, 5.1800161600112915e-06, 4.606321454048157e-06, 4.557892680168152e-06, 5.756039172410965e-06, 5.041714757680893e-06, 4.786066710948944e-06, 4.69014048576355e-06, 4.673842340707779e-06, 4.9979425966739655e-06, 4.762317985296249e-06, 4.74369153380394e-06, 4.607252776622772e-06, 4.671979695558548e-06, 4.651956260204315e-06, 5.13298436999321e-06, 4.58909198641777e-06, 4.708766937255859e-06, 5.09992241859436e-06, 5.024019628763199e-06, 5.0943344831466675e-06, 4.911795258522034e-06, 4.978850483894348e-06, 4.713423550128937e-06, 5.597714334726334e-06, 5.788169801235199e-06, 5.023088306188583e-06, 5.346722900867462e-06, 4.763249307870865e-06, 4.726927727460861e-06, 4.7977082431316376e-06, 4.837289452552795e-06, 4.5709311962127686e-06, 4.612840712070465e-06, 4.663132131099701e-06, 5.441252142190933e-06, 5.164649337530136e-06, 4.5942142605781555e-06, 4.740897566080093e-06, 4.610046744346619e-06, 4.761852324008942e-06, 5.121342837810516e-06, 4.770699888467789e-06, 4.969071596860886e-06, 4.568137228488922e-06, 4.5979395508766174e-06, 4.748813807964325e-06, 4.637986421585083e-06, 4.582107067108154e-06, 4.590954631567001e-06, 4.697125405073166e-06, 4.785135388374329e-06, 6.302725523710251e-06, 4.936940968036652e-06, 5.085952579975128e-06, 4.817266017198563e-06, 4.627741873264313e-06, 4.879198968410492e-06, 4.769768565893173e-06, 4.710163921117783e-06, 4.71482053399086e-06, 4.656147211790085e-06, 4.7711655497550964e-06, 4.871748387813568e-06, 4.634261131286621e-06, 5.957670509815216e-06, 4.748348146677017e-06, 5.011912435293198e-06, 4.693865776062012e-06, 4.742294549942017e-06, 5.141831934452057e-06, 5.243811756372452e-06, 4.864297807216644e-06, 4.864763468503952e-06, 5.436129868030548e-06, 4.6030618250370026e-06, 4.776753485202789e-06, 5.4640695452690125e-06, 4.902947694063187e-06, 4.779081791639328e-06, 4.678964614868164e-06, 4.518311470746994e-06, 4.616566002368927e-06, 5.013309419155121e-06, 5.698762834072113e-06, 5.042180418968201e-06, 5.478039383888245e-06, 4.807952791452408e-06, 4.511792212724686e-06, 4.5960769057273865e-06, 4.6943314373493195e-06, 4.7585926949977875e-06, 4.7371722757816315e-06, 4.816800355911255e-06, 4.627276211977005e-06, 4.742760211229324e-06, 5.401205271482468e-06, 4.786066710948944e-06, 4.752073436975479e-06, 7.242895662784576e-06, 5.0389207899570465e-06, 5.016103386878967e-06, 5.02169132232666e-06, 6.390269845724106e-06, 8.488073945045471e-06, 5.22565096616745e-06, 5.724374204874039e-06], tpot=0.0, prompt_len=256, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 50.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     100       
Benchmark duration (s):                  41.92     
Total input tokens:                      25600     
Total generated tokens:                  23625     
Request throughput (req/s):              2.39      
Output token throughput (tok/s):         563.64    
Total Token throughput (tok/s):          1174.40   
---------------Time to First Token----------------
Mean TTFT (ms):                          33013.97  
Median TTFT (ms):                        32298.32  
P99 TTFT (ms):                           40088.33  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.00      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.00      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
