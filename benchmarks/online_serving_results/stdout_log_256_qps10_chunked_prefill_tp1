INFO 07-08 06:02:49 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=10.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='chunked_prefill-qps-10-input-len-256-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=256, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I'll try to break it down and provide some insights:\n\n**Programming languages and frameworks:**\n\n* Java (e.g., `@NoArgsConstructor`, `Parcelable`)\n* Python (e.g., `pd`, `testProfit`)\n* JavaScript (e.g., `OnClickListener`, `Component`)\n* C# (e.g., `Cleanup.structure`)\n* Kotlin (e.g., `lateinit`)\n\n**Domains and topics:**\n\n* Android development (e.g., `OnClickListener`, `Parcelable`)\n* Data science and machine learning (e.g., `testProfit`, `estimator`)\n* Web development (e.g., `Component`, `Cleanup.structure`)\n* IoT and sensor-related topics (e.g., `SENSOR_BUSY`, `wifi`)\n* Finance and economics (e.g., `NYSE`, `profit`)\n* Geography and location-based services (e.g., `Latitude`, `Prague`)\n\n**Other observations:**\n\n* There are many typos and non-English words/phrases, which might indicate that the text is a result of a machine translation or a text generation algorithm.\n* Some parts of the", success=True, latency=3.8234204980544746, output_tokens=256, ttft=0.08335583796724677, itl=[3.931298851966858e-05, 0.014881950803101063, 0.014245210215449333, 0.014530620072036982, 0.01450912095606327, 0.014541344717144966, 0.014598933048546314, 0.014551600906997919, 0.014668264426290989, 0.014572014566510916, 0.014525268226861954, 0.014521157834678888, 0.014773769304156303, 0.014572835993021727, 0.014593601692467928, 0.014654004015028477, 0.014574621338397264, 0.014543327037245035, 0.014591410756111145, 0.014648700132966042, 0.014624776784330606, 0.01458533899858594, 0.014707088004797697, 0.01455066492781043, 0.014572053216397762, 0.014643535017967224, 0.014646708033978939, 0.014628191944211721, 0.014591190963983536, 0.014673382975161076, 0.01454754313454032, 0.014628862962126732, 0.014632727019488811, 0.014664368703961372, 0.014541959390044212, 0.01462816959246993, 0.014635364059358835, 0.014636906329542398, 0.014630672056227922, 0.014555053785443306, 0.014616713859140873, 0.014638795983046293, 0.01459078909829259, 0.014745239168405533, 0.014549362938851118, 0.014634689781814814, 0.01466559898108244, 0.014638862106949091, 0.014618886169046164, 0.014865732751786709, 0.014462673105299473, 0.014658416155725718, 0.01473906310275197, 0.014721176587045193, 0.014727314002811909, 0.014665008056908846, 0.014756446238607168, 0.014601110946387053, 0.014615173917263746, 0.014653881080448627, 0.014682075940072536, 0.014598866924643517, 0.01470531104132533, 0.014718383084982634, 0.014617817010730505, 0.014660014770925045, 0.014708277303725481, 0.014706051908433437, 0.014584343880414963, 0.01465074997395277, 0.014693588949739933, 0.014627200085669756, 0.014657966326922178, 0.014658796600997448, 0.014743623323738575, 0.014623948838561773, 0.014643499162048101, 0.014749655034393072, 0.014689124654978514, 0.014640307053923607, 0.014675549231469631, 0.014647028874605894, 0.01469634985551238, 0.01459982804954052, 0.014708749949932098, 0.014675142243504524, 0.014600412920117378, 0.014597542118281126, 0.01473745284602046, 0.014605739153921604, 0.014596679713577032, 0.014666164293885231, 0.014663081616163254, 0.01462940825149417, 0.014650942757725716, 0.014702323358505964, 0.014600245747715235, 0.014766652137041092, 0.014603479765355587, 0.014656831044703722, 0.014656506013125181, 0.014695577323436737, 0.014675369020551443, 0.014578794594854116, 0.014807471074163914, 0.014536736998707056, 0.014692696277052164, 0.01470122765749693, 0.014630806166678667, 0.014676656108349562, 0.014625870157033205, 0.014727302826941013, 0.014574199914932251, 0.014682989101856947, 0.014705758076161146, 0.014683255925774574, 0.014607791788876057, 0.014626224990934134, 0.014704629313200712, 0.014663196634501219, 0.014621356036514044, 0.014643575996160507, 0.014849340077489614, 0.014531700871884823, 0.014682680368423462, 0.014681826811283827, 0.014577182941138744, 0.0146798612549901, 0.014616369735449553, 0.014641676098108292, 0.014666044153273106, 0.014610962942242622, 0.014682205859571695, 0.014611223246902227, 0.014719804748892784, 0.014645854942500591, 0.014727226924151182, 0.014714507386088371, 0.014718291815370321, 0.014660620130598545, 0.014687229879200459, 0.014600745867937803, 0.014845408033579588, 0.014622855931520462, 0.01469309302046895, 0.014705324079841375, 0.014596897177398205, 0.014607138931751251, 0.014714596793055534, 0.014648257289081812, 0.014659896958619356, 0.014684524852782488, 0.014683721121400595, 0.014562604948878288, 0.01463524205610156, 0.014659613836556673, 0.014697755221277475, 0.014664065092802048, 0.014683490619063377, 0.014710410963743925, 0.014605300035327673, 0.014637207146734, 0.01468878285959363, 0.014671870041638613, 0.01469016307964921, 0.014647610951215029, 0.014751803129911423, 0.014629655051976442, 0.014613085892051458, 0.014669939875602722, 0.014695857185870409, 0.014728870708495378, 0.014623100403696299, 0.014751682057976723, 0.014644738752394915, 0.014654944185167551, 0.014727852772921324, 0.014675626065582037, 0.014715807978063822, 0.014740370213985443, 0.0146707808598876, 0.01467711990699172, 0.014723055996000767, 0.014739979058504105, 0.014676629099994898, 0.014646616764366627, 0.014741209335625172, 0.014618941582739353, 0.01475812029093504, 0.014645014889538288, 0.014829455874860287, 0.014648132026195526, 0.014628555160015821, 0.014747492037713528, 0.014661881141364574, 0.014799852855503559, 0.014769442845135927, 0.014702813234180212, 0.014829960651695728, 0.014554828405380249, 0.014817987568676472, 0.014681028202176094, 0.01470486307516694, 0.014695629011839628, 0.0147675727494061, 0.01465067220851779, 0.01467710779979825, 0.014710721094161272, 0.01456447597593069, 0.014736061915755272, 0.014698263257741928, 0.014721766114234924, 0.014717801008373499, 0.014981523621827364, 0.01440033596009016, 0.014685860369354486, 0.014710323885083199, 0.014688382856547832, 0.014747129287570715, 0.014650757890194654, 0.014689477160573006, 0.014677545987069607, 0.01468241959810257, 0.014674710109829903, 0.01472008228302002, 0.01477297767996788, 0.014652714133262634, 0.014997478108853102, 0.01464398205280304, 0.014727608766406775, 0.014748475980013609, 0.01473433617502451, 0.014721646904945374, 0.014689270872622728, 0.014774196315556765, 0.014591258019208908, 0.014691338874399662, 0.0146377207711339, 0.014651640318334103, 0.014678082894533873, 0.01466897502541542, 0.014717983081936836, 0.014718604739755392, 0.014639863278716803, 0.01467181695625186, 0.014669717755168676, 0.014757018070667982, 0.014614195097237825, 0.014730921946465969, 0.014622197952121496, 0.01465912302955985, 0.01464508380740881, 0.014695444144308567, 0.014638543128967285, 0.015042578801512718, 0.014782682061195374], tpot=0.0, prompt_len=256, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 10.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  113.62    
Total input tokens:                      262144    
Total generated tokens:                  240171    
Request throughput (req/s):              9.01      
Output token throughput (tok/s):         2113.80   
Total Token throughput (tok/s):          4420.98   
---------------Time to First Token----------------
Mean TTFT (ms):                          120.31    
Median TTFT (ms):                        103.61    
P99 TTFT (ms):                           224.58    
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          26.97     
Median TPOT (ms):                        27.02     
P99 TPOT (ms):                           30.78     
---------------Inter-token Latency----------------
Mean ITL (ms):                           26.86     
Median ITL (ms):                         20.01     
P99 ITL (ms):                            92.82     
==================================================
