INFO 07-11 17:07:53 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=1.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-1-input-len-256-tp-2.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=256, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you've provided a large block of text that seems to be a jumbled collection of words, phrases, and code snippets from various programming languages and domains. I'll try to break it down and provide some insights:\n\n**Programming languages and frameworks:**\n\n* Java (e.g., `@NoArgsConstructor`, `Parcelable`)\n* Python (e.g., `pd`, `numpy`)\n* JavaScript (e.g., `OnClickListener`, `Component`)\n* C++ (e.g., `GPIO`)\n* C# (e.g., `Debugger`, `Web`)\n* Kotlin (e.g., `lateinit`)\n\n**Domains and topics:**\n\n* Artificial intelligence and machine learning (e.g., `DataLoader`, `estimator`)\n* Computer vision (e.g., `SENSOR_BUSY`, `flotation.sensor`)\n* Natural language processing (e.g., `Speak-ball`)\n* Web development (e.g., `Web`, `Component`)\n* Mobile app development (e.g., `Parcelable`, `OnClickListener`)\n* Embedded systems (e.g., `GPIO`)\n* Finance and economics (e.g., `testProfit`, `NYSE`)\n* Geography and mapping (e.g., `Latitude`, `Longitude`)\n\n**Other observations:**\n\n* There are many typos and gramm", success=True, latency=6.957492809742689, output_tokens=256, ttft=6.956142615992576, itl=[4.91817481815815e-05, 1.6902107745409012e-05, 9.362120181322098e-06, 6.813090294599533e-06, 5.801673978567123e-06, 6.2212347984313965e-06, 5.305744707584381e-06, 5.236361175775528e-06, 5.0300732254981995e-06, 4.919711500406265e-06, 4.974193871021271e-06, 4.925765097141266e-06, 5.065929144620895e-06, 4.90015372633934e-06, 4.861969500780106e-06, 4.7818757593631744e-06, 5.003996193408966e-06, 5.150213837623596e-06, 5.107838660478592e-06, 4.841946065425873e-06, 4.721339792013168e-06, 4.773959517478943e-06, 5.370937287807465e-06, 5.199108272790909e-06, 4.9388036131858826e-06, 5.148816853761673e-06, 4.9513764679431915e-06, 5.1227398216724396e-06, 4.9551017582416534e-06, 5.0640664994716644e-06, 5.715060979127884e-06, 5.220063030719757e-06, 4.9336813390254974e-06, 5.720183253288269e-06, 5.019828677177429e-06, 5.029141902923584e-06, 4.857778549194336e-06, 4.8140063881874084e-06, 4.675239324569702e-06, 4.615169018507004e-06, 4.707835614681244e-06, 5.274079740047455e-06, 4.558824002742767e-06, 4.766974598169327e-06, 4.848930984735489e-06, 5.152076482772827e-06, 5.849171429872513e-06, 5.121808499097824e-06, 4.868954420089722e-06, 4.820059984922409e-06, 4.896894097328186e-06, 4.868954420089722e-06, 5.152076482772827e-06, 5.673151463270187e-06, 4.925765097141266e-06, 5.232170224189758e-06, 4.64683398604393e-06, 4.901085048913956e-06, 4.82192263007164e-06, 5.016103386878967e-06, 4.658009856939316e-06, 4.86103817820549e-06, 5.100853741168976e-06, 4.864297807216644e-06, 4.556030035018921e-06, 5.572102963924408e-06, 4.871748387813568e-06, 5.044043064117432e-06, 5.056150257587433e-06, 4.721805453300476e-06, 4.770234227180481e-06, 4.837755113840103e-06, 4.631932824850082e-06, 4.6389177441596985e-06, 4.6691857278347015e-06, 4.727859050035477e-06, 4.7869980335235596e-06, 5.749054253101349e-06, 4.834029823541641e-06, 4.768837243318558e-06, 4.913192242383957e-06, 4.76418063044548e-06, 4.801899194717407e-06, 4.7781504690647125e-06, 4.693865776062012e-06, 5.718786269426346e-06, 4.825182259082794e-06, 5.03193587064743e-06, 4.773959517478943e-06, 4.693865776062012e-06, 4.750210791826248e-06, 5.273148417472839e-06, 4.744622856378555e-06, 5.45429065823555e-06, 5.250796675682068e-06, 4.760921001434326e-06, 4.680361598730087e-06, 4.576053470373154e-06, 4.7585926949977875e-06, 5.339272320270538e-06, 4.705972969532013e-06, 4.665926098823547e-06, 4.6351924538612366e-06, 4.868954420089722e-06, 4.872679710388184e-06, 4.757195711135864e-06, 4.68594953417778e-06, 4.634261131286621e-06, 5.088746547698975e-06, 6.428919732570648e-06, 4.932284355163574e-06, 4.925765097141266e-06, 4.779081791639328e-06, 4.660803824663162e-06, 4.62215393781662e-06, 4.766974598169327e-06, 4.7390349209308624e-06, 4.775822162628174e-06, 4.9513764679431915e-06, 4.8140063881874084e-06, 5.085021257400513e-06, 5.134847015142441e-06, 5.411915481090546e-06, 5.174893885850906e-06, 4.943925887346268e-06, 4.686415195465088e-06, 4.8796646296978e-06, 5.187001079320908e-06, 4.61796298623085e-06, 5.565118044614792e-06, 5.38211315870285e-06, 5.182810127735138e-06, 4.724133759737015e-06, 4.907138645648956e-06, 4.733912646770477e-06, 5.309004336595535e-06, 5.278736352920532e-06, 5.604233592748642e-06, 4.845205694437027e-06, 4.8209913074970245e-06, 4.648696631193161e-06, 4.773028194904327e-06, 4.676170647144318e-06, 4.658009856939316e-06, 4.728790372610092e-06, 4.736240953207016e-06, 4.536937922239304e-06, 4.7050416469573975e-06, 5.41098415851593e-06, 6.72508031129837e-06, 4.9229711294174194e-06, 6.463844329118729e-06, 4.904810339212418e-06, 4.7762878239154816e-06, 4.6570785343647e-06, 4.703644663095474e-06, 4.698988050222397e-06, 5.429144948720932e-06, 4.882924258708954e-06, 4.738103598356247e-06, 4.674773663282394e-06, 4.8032961785793304e-06, 4.990957677364349e-06, 4.731118679046631e-06, 4.7888606786727905e-06, 4.857778549194336e-06, 5.4622069001197815e-06, 5.0729140639305115e-06, 4.691071808338165e-06, 4.800967872142792e-06, 4.834961146116257e-06, 5.014240741729736e-06, 5.02169132232666e-06, 6.307382136583328e-06, 5.0086528062820435e-06, 4.756264388561249e-06, 5.685724318027496e-06, 4.824250936508179e-06, 4.81167808175087e-06, 5.4640695452690125e-06, 1.054396852850914e-05, 4.757195711135864e-06, 4.676170647144318e-06, 4.678964614868164e-06, 4.841946065425873e-06, 4.632864147424698e-06, 5.191192030906677e-06, 5.041714757680893e-06, 4.884321242570877e-06, 4.700850695371628e-06, 4.761852324008942e-06, 5.265232175588608e-06, 5.068723112344742e-06, 4.8531219363212585e-06, 4.698988050222397e-06, 4.727859050035477e-06, 4.72506508231163e-06, 4.819128662347794e-06, 4.893168807029724e-06, 4.866626113653183e-06, 4.935078322887421e-06, 5.715060979127884e-06, 5.136243999004364e-06, 4.892703145742416e-06, 4.867091774940491e-06, 4.842877388000488e-06, 5.73229044675827e-06, 4.829838871955872e-06, 4.786066710948944e-06, 4.837755113840103e-06, 4.7371722757816315e-06, 4.689209163188934e-06, 4.658941179513931e-06, 5.228910595178604e-06, 5.051027983427048e-06, 4.678964614868164e-06, 4.827976226806641e-06, 4.842877388000488e-06, 4.763249307870865e-06, 4.71062958240509e-06, 4.9122609198093414e-06, 4.684086889028549e-06, 5.1460228860378265e-06, 4.857778549194336e-06, 4.711095243692398e-06, 5.0691887736320496e-06, 4.748813807964325e-06, 5.505979061126709e-06, 4.942994564771652e-06, 4.769768565893173e-06, 5.666166543960571e-06, 5.010981112718582e-06, 4.656147211790085e-06, 5.626119673252106e-06, 5.011912435293198e-06, 4.752073436975479e-06, 4.837755113840103e-06, 4.760921001434326e-06, 4.789326339960098e-06, 5.4156407713890076e-06, 5.071982741355896e-06, 4.698988050222397e-06, 4.892237484455109e-06, 4.9727968871593475e-06, 5.234032869338989e-06, 4.773028194904327e-06, 5.0622038543224335e-06, 5.024950951337814e-06, 5.0049275159835815e-06, 4.786066710948944e-06, 5.152076482772827e-06, 4.660803824663162e-06, 4.654284566640854e-06, 4.610978066921234e-06, 4.665926098823547e-06, 7.519964128732681e-06], tpot=0.0, prompt_len=256, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 1.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
