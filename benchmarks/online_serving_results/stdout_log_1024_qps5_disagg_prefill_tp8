INFO 07-10 02:40:54 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=5.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-5-input-len-1024-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=1024, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you have provided a large amount of text that seems to be a mix of code snippets, error messages, and random text. It's difficult to make sense of this text without more context.\n\nHowever, I can try to help you identify some patterns or potential issues in the text. Here are a few observations:\n\n1. **Code snippets**: The text contains snippets of code in various programming languages, including Java, Python, and JavaScript. These snippets appear to be incomplete and may be related to different projects or applications.\n2. **Error messages**: There are several error messages and warnings scattered throughout the text. These messages may indicate issues with code compilation, runtime errors, or other problems.\n3. **Random text**: The text also contains random words, phrases, and characters that don't seem to be related to any specific topic or context.\n4. **Formatting issues**: The text has formatting issues, with inconsistent indentation, line breaks, and character encoding.\n\nTo better assist you, could you please provide more context about this text? For example:\n\n* What is the source of this text?\n* What programming languages or technologies are involved?\n* What is the purpose of this text (e.g., debugging, documentation, or something else)?\n* Are there any specific issues", success=True, latency=4.70677291136235, output_tokens=256, ttft=4.705382194370031, itl=[4.5758672058582306e-05, 1.6085337847471237e-05, 8.552800863981247e-06, 6.393063813447952e-06, 5.1497481763362885e-06, 5.83333894610405e-06, 5.501788109540939e-06, 5.186069756746292e-06, 5.12879341840744e-06, 4.9551017582416534e-06, 4.692003130912781e-06, 4.902016371488571e-06, 5.191192030906677e-06, 4.814937710762024e-06, 4.7441571950912476e-06, 5.1995739340782166e-06, 4.8140063881874084e-06, 5.121342837810516e-06, 4.71482053399086e-06, 4.819128662347794e-06, 4.768837243318558e-06, 5.553010851144791e-06, 5.1371753215789795e-06, 5.0747767090797424e-06, 4.976987838745117e-06, 5.197245627641678e-06, 4.820059984922409e-06, 4.990957677364349e-06, 5.473848432302475e-06, 4.75812703371048e-06, 5.236826837062836e-06, 5.356036126613617e-06, 5.0389207899570465e-06, 6.000977009534836e-06, 4.66126948595047e-06, 4.820059984922409e-06, 4.9299560487270355e-06, 5.1497481763362885e-06, 4.670117050409317e-06, 4.75393608212471e-06, 4.722271114587784e-06, 6.40377402305603e-06, 5.019828677177429e-06, 4.840083420276642e-06, 4.888046532869339e-06, 4.934147000312805e-06, 4.765111953020096e-06, 4.954636096954346e-06, 4.665926098823547e-06, 4.682224243879318e-06, 5.191192030906677e-06, 4.8140063881874084e-06, 5.06499782204628e-06, 5.738809704780579e-06, 4.816800355911255e-06, 4.790257662534714e-06, 4.671979695558548e-06, 4.88990917801857e-06, 4.949048161506653e-06, 5.00120222568512e-06, 4.720874130725861e-06, 4.717148840427399e-06, 4.598870873451233e-06, 5.7248398661613464e-06, 5.039852112531662e-06, 6.058253347873688e-06, 4.616100341081619e-06, 4.725996404886246e-06, 4.737637937068939e-06, 4.666391760110855e-06, 5.283858627080917e-06, 4.674773663282394e-06, 4.671979695558548e-06, 4.741363227367401e-06, 4.925765097141266e-06, 4.86522912979126e-06, 4.560686647891998e-06, 6.120186299085617e-06, 4.660803824663162e-06, 5.429144948720932e-06, 5.661975592374802e-06, 4.800967872142792e-06, 4.695262759923935e-06, 5.347654223442078e-06, 4.6300701797008514e-06, 4.784204065799713e-06, 5.302019417285919e-06, 4.8228539526462555e-06, 4.753004759550095e-06, 5.504116415977478e-06, 4.685018211603165e-06, 4.877801984548569e-06, 4.841946065425873e-06, 6.479211151599884e-06, 5.383044481277466e-06, 4.892703145742416e-06, 7.426366209983826e-06, 5.08967787027359e-06, 4.664063453674316e-06, 4.772096872329712e-06, 5.883164703845978e-06, 5.295034497976303e-06, 4.8675574362277985e-06, 4.790257662534714e-06, 4.766043275594711e-06, 5.726702511310577e-06, 5.737412720918655e-06, 5.033798515796661e-06, 4.829838871955872e-06, 6.945338100194931e-06, 5.086883902549744e-06, 5.336012691259384e-06, 5.193985998630524e-06, 4.842877388000488e-06, 4.7050416469573975e-06, 5.802139639854431e-06, 4.699919372797012e-06, 5.466863512992859e-06, 4.936940968036652e-06, 6.0442835092544556e-06, 5.57582825422287e-06, 5.3211115300655365e-06, 4.904810339212418e-06, 4.93321567773819e-06, 6.299000233411789e-06, 5.202833563089371e-06, 4.516914486885071e-06, 5.709007382392883e-06, 5.145091563463211e-06, 6.142072379589081e-06, 4.772096872329712e-06, 4.701782017946243e-06, 5.343928933143616e-06, 5.148351192474365e-06, 5.285721272230148e-06, 4.7441571950912476e-06, 4.7031790018081665e-06, 5.0086528062820435e-06, 5.9623271226882935e-06, 5.1227398216724396e-06, 4.829838871955872e-06, 4.782341420650482e-06, 5.934853106737137e-06, 5.38211315870285e-06, 4.698988050222397e-06, 4.648696631193161e-06, 5.423091351985931e-06, 4.969071596860886e-06, 4.607252776622772e-06, 6.7856162786483765e-06, 4.861969500780106e-06, 4.730187356472015e-06, 5.924142897129059e-06, 4.733912646770477e-06, 4.798173904418945e-06, 4.723668098449707e-06, 5.9301964938640594e-06, 4.980713129043579e-06, 5.354173481464386e-06, 4.732050001621246e-06, 4.831235855817795e-06, 4.697591066360474e-06, 6.47595152258873e-06, 4.8121437430381775e-06, 4.9280934035778046e-06, 4.9620866775512695e-06, 5.532987415790558e-06, 5.107838660478592e-06, 5.624257028102875e-06, 4.845671355724335e-06, 4.6710483729839325e-06, 4.796311259269714e-06, 5.759764462709427e-06, 7.646158337593079e-06, 4.99282032251358e-06, 4.841014742851257e-06, 4.658009856939316e-06, 4.801899194717407e-06, 4.6049244701862335e-06, 5.369074642658234e-06, 5.363021045923233e-06, 5.1069073379039764e-06, 4.674308001995087e-06, 4.689674824476242e-06, 4.603993147611618e-06, 6.5783970057964325e-06, 6.179790943861008e-06, 4.954170435667038e-06, 4.685018211603165e-06, 5.262903869152069e-06, 4.731118679046631e-06, 4.8889778554439545e-06, 6.109941750764847e-06, 4.803761839866638e-06, 4.731118679046631e-06, 6.117857992649078e-06, 4.83216717839241e-06, 4.804227501153946e-06, 5.95487654209137e-06, 4.7497451305389404e-06, 8.916016668081284e-06, 6.461981683969498e-06, 5.379319190979004e-06, 5.455687642097473e-06, 6.9821253418922424e-06, 4.873145371675491e-06, 4.794914275407791e-06, 6.518792361021042e-06, 4.806090146303177e-06, 4.770234227180481e-06, 4.7460198402404785e-06, 5.824025720357895e-06, 4.884786903858185e-06, 4.941131919622421e-06, 4.721805453300476e-06, 6.086193025112152e-06, 4.8140063881874084e-06, 4.72506508231163e-06, 6.143003702163696e-06, 4.77861613035202e-06, 5.015172064304352e-06, 4.816800355911255e-06, 4.766043275594711e-06, 5.2209943532943726e-06, 4.976056516170502e-06, 6.752088665962219e-06, 4.848930984735489e-06, 6.433110684156418e-06, 5.024950951337814e-06, 6.075948476791382e-06, 4.981178790330887e-06, 4.674773663282394e-06, 4.75812703371048e-06, 8.249189704656601e-06, 4.843808710575104e-06, 4.6622008085250854e-06, 4.807021468877792e-06, 6.231013685464859e-06, 4.726927727460861e-06, 4.705972969532013e-06, 5.098059773445129e-06, 4.825647920370102e-06, 5.617272108793259e-06, 4.982110112905502e-06, 4.75393608212471e-06, 6.573740392923355e-06, 4.786066710948944e-06, 4.576053470373154e-06, 5.458947271108627e-06, 4.8638321459293365e-06, 4.970002919435501e-06, 6.195157766342163e-06, 4.7818757593631744e-06, 4.698988050222397e-06, 4.671979695558548e-06, 7.076188921928406e-06], tpot=0.0, prompt_len=1024, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 5.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     440       
Benchmark duration (s):                  217.22    
Total input tokens:                      450560    
Total generated tokens:                  70245     
Request throughput (req/s):              2.03      
Output token throughput (tok/s):         323.38    
Total Token throughput (tok/s):          2397.55   
---------------Time to First Token----------------
Mean TTFT (ms):                          17290.43  
Median TTFT (ms):                        20013.91  
P99 TTFT (ms):                           27084.04  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.01      
Median TPOT (ms):                        0.01      
P99 TPOT (ms):                           0.01      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.00      
P99 ITL (ms):                            0.01      
==================================================
