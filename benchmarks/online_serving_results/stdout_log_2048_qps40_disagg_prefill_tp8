INFO 07-10 03:14:20 [__init__.py:239] Automatically detected platform rocm.
Namespace(backend='openai-chat', base_url=None, host='localhost', port=8080, endpoint='/v1/chat/completions', dataset_name='random', dataset_path=None, max_concurrency=None, model='/workspace/llama_3.1_70B', tokenizer=None, use_beam_search=False, num_prompts=1024, logprobs=None, request_rate=40.0, burstiness=1.0, seed=0, trust_remote_code=False, disable_tqdm=False, profile=False, save_result=True, save_detailed=False, metadata=None, result_dir='./results', result_filename='disagg_prefill-qps-40-input-len-2048-tp-8.json', ignore_eos=False, percentile_metrics='ttft,tpot,itl', metric_percentiles='99', goodput=None, sonnet_input_len=550, sonnet_output_len=150, sonnet_prefix_len=200, sharegpt_output_len=None, random_input_len=2048, random_output_len=256, random_range_ratio=1.0, random_prefix_len=0, hf_subset=None, hf_split=None, hf_output_len=None, tokenizer_mode='auto', served_model_name=None, lora_modules=None)
Starting initial single prompt test run...
=== DEBUG: Entering benchmark() ===
DEBUG: backend         = openai-chat
DEBUG: api_url         = 'http://localhost:8080/v1/chat/completions'
DEBUG: model_id        = '/workspace/llama_3.1_70B'
DEBUG: model_name      = None
DEBUG: request_func    = async_request_openai_chat_completions
Starting initial single prompt test run...
test_output RequestFuncOutput(generated_text="It appears that you have provided a large amount of text that seems to be a mix of code snippets, error messages, and random text. It's difficult to make sense of this text without more context.\n\nHowever, I can try to help you identify some patterns or potential issues in the text. Here are a few observations:\n\n1. **Code snippets**: The text contains snippets of code in various programming languages, including Java, Python, and JavaScript. These snippets appear to be incomplete and may be related to different projects or applications.\n2. **Error messages**: There are several error messages scattered throughout the text, including stack traces and error codes. These messages may indicate issues with the code or applications that generated them.\n3. **Random text**: The text also contains random words, phrases, and characters that don't seem to be related to any specific topic or context.\n4. **Non-ASCII characters**: The text includes non-ASCII characters, such as Chinese characters, which may indicate that the text was generated by a non-English speaking user or application.\n\nTo better understand the context and purpose of this text, I would need more information about where it came from and what it's supposed to represent. If you can provide more context or clarify what you're trying to achieve", success=True, latency=5.2139499369077384, output_tokens=256, ttft=5.21259671356529, itl=[4.059821367263794e-05, 1.654820516705513e-05, 9.589828550815582e-06, 6.946735084056854e-06, 5.456153303384781e-06, 5.972106009721756e-06, 5.594920367002487e-06, 5.342997610569e-06, 5.110166966915131e-06, 5.1497481763362885e-06, 4.755333065986633e-06, 5.310866981744766e-06, 5.0049275159835815e-06, 4.772096872329712e-06, 4.7138892114162445e-06, 4.9299560487270355e-06, 4.827976226806641e-06, 5.249865353107452e-06, 5.0533562898635864e-06, 4.81167808175087e-06, 4.873145371675491e-06, 5.227047950029373e-06, 4.9639493227005005e-06, 4.807021468877792e-06, 4.8959627747535706e-06, 5.773268640041351e-06, 4.826579242944717e-06, 4.895031452178955e-06, 5.225185304880142e-06, 4.711095243692398e-06, 5.606096237897873e-06, 5.080830305814743e-06, 4.907138645648956e-06, 5.312729626893997e-06, 4.709232598543167e-06, 4.4996850192546844e-06, 4.793982952833176e-06, 4.90434467792511e-06, 4.735775291919708e-06, 4.705972969532013e-06, 4.806090146303177e-06, 6.0070306062698364e-06, 4.789792001247406e-06, 4.779081791639328e-06, 4.714354872703552e-06, 4.719942808151245e-06, 4.6817585825920105e-06, 4.727859050035477e-06, 4.640314728021622e-06, 4.655681550502777e-06, 5.044043064117432e-06, 4.898291081190109e-06, 4.9066729843616486e-06, 5.446374416351318e-06, 4.776753485202789e-06, 4.780944436788559e-06, 4.6282075345516205e-06, 4.592817276716232e-06, 5.17209991812706e-06, 4.941131919622421e-06, 4.667788743972778e-06, 4.6622008085250854e-06, 4.702713340520859e-06, 5.17629086971283e-06, 5.075708031654358e-06, 5.795154720544815e-06, 4.712957888841629e-06, 4.8568472266197205e-06, 4.715286195278168e-06, 4.658009856939316e-06, 5.420763045549393e-06, 4.780944436788559e-06, 4.747416824102402e-06, 4.673842340707779e-06, 4.652887582778931e-06, 4.879198968410492e-06, 4.798639565706253e-06, 5.48316165804863e-06, 4.839152097702026e-06, 5.43985515832901e-06, 5.224253982305527e-06, 4.7567300498485565e-06, 4.715286195278168e-06, 5.168840289115906e-06, 4.806090146303177e-06, 4.748813807964325e-06, 5.154870450496674e-06, 4.6710483729839325e-06, 4.868954420089722e-06, 5.180947482585907e-06, 4.998408257961273e-06, 4.6906061470508575e-06, 4.895031452178955e-06, 5.660112947225571e-06, 5.3532421588897705e-06, 4.6510249376297e-06, 6.803777068853378e-06, 4.883855581283569e-06, 4.716217517852783e-06, 4.661735147237778e-06, 5.542300641536713e-06, 5.058012902736664e-06, 4.763714969158173e-06, 4.668254405260086e-06, 4.9318186938762665e-06, 5.6801363825798035e-06, 5.024019628763199e-06, 4.862900823354721e-06, 4.7138892114162445e-06, 6.335321813821793e-06, 4.851724952459335e-06, 5.110166966915131e-06, 5.000736564397812e-06, 4.730187356472015e-06, 4.777219146490097e-06, 5.227979272603989e-06, 4.903879016637802e-06, 5.559995770454407e-06, 5.166046321392059e-06, 5.96093013882637e-06, 5.071982741355896e-06, 5.223788321018219e-06, 4.7869980335235596e-06, 4.96814027428627e-06, 5.607958883047104e-06, 4.704110324382782e-06, 4.820059984922409e-06, 5.359761416912079e-06, 4.937406629323959e-06, 6.140675395727158e-06, 5.6121498346328735e-06, 4.7711655497550964e-06, 4.864763468503952e-06, 4.9620866775512695e-06, 4.834029823541641e-06, 5.3318217396736145e-06, 4.736240953207016e-06, 4.709698259830475e-06, 4.800036549568176e-06, 5.440320819616318e-06, 5.619600415229797e-06, 5.073379725217819e-06, 5.505979061126709e-06, 5.034729838371277e-06, 4.888046532869339e-06, 4.5979395508766174e-06, 4.668254405260086e-06, 4.685018211603165e-06, 4.682689905166626e-06, 6.290152668952942e-06, 4.869885742664337e-06, 4.667323082685471e-06, 5.6549906730651855e-06, 4.869885742664337e-06, 4.699919372797012e-06, 4.576053470373154e-06, 4.75812703371048e-06, 4.769768565893173e-06, 4.920177161693573e-06, 4.735775291919708e-06, 5.420297384262085e-06, 4.826579242944717e-06, 4.711095243692398e-06, 4.576984792947769e-06, 5.140900611877441e-06, 4.815403372049332e-06, 4.629604518413544e-06, 5.379319190979004e-06, 4.964880645275116e-06, 4.568137228488922e-06, 5.3998082876205444e-06, 5.13298436999321e-06, 4.6622008085250854e-06, 6.250105798244476e-06, 5.06499782204628e-06, 4.626810550689697e-06, 4.699919372797012e-06, 4.665926098823547e-06, 4.678033292293549e-06, 4.664063453674316e-06, 5.392823368310928e-06, 5.0300732254981995e-06, 4.658009856939316e-06, 4.618894308805466e-06, 4.658009856939316e-06, 5.653128027915955e-06, 4.862900823354721e-06, 4.678964614868164e-06, 4.819128662347794e-06, 4.6459026634693146e-06, 4.69619408249855e-06, 4.680827260017395e-06, 4.707369953393936e-06, 4.871748387813568e-06, 6.129033863544464e-06, 4.79305163025856e-06, 4.834029823541641e-06, 4.9299560487270355e-06, 5.747191607952118e-06, 4.764646291732788e-06, 4.806090146303177e-06, 6.628222763538361e-06, 4.760921001434326e-06, 5.20097091794014e-06, 5.179084837436676e-06, 4.7497451305389404e-06, 4.772096872329712e-06, 4.698988050222397e-06, 5.826819688081741e-06, 4.740431904792786e-06, 5.747657269239426e-06, 4.7711655497550964e-06, 5.466863512992859e-06, 4.9551017582416534e-06, 4.739966243505478e-06, 4.746951162815094e-06, 5.694106221199036e-06, 4.8461370170116425e-06, 5.7746656239032745e-06, 4.895031452178955e-06, 4.868954420089722e-06, 5.125999450683594e-06, 4.723202437162399e-06, 4.6729110181331635e-06, 4.799105226993561e-06, 4.678033292293549e-06, 5.956739187240601e-06, 4.739966243505478e-06, 4.76837158203125e-06, 5.948822945356369e-06, 6.00004568696022e-06, 4.82611358165741e-06, 4.847999662160873e-06, 5.893874913454056e-06, 5.2461400628089905e-06, 4.779081791639328e-06, 4.694797098636627e-06, 5.9497542679309845e-06, 4.818197339773178e-06, 4.858244210481644e-06, 4.71482053399086e-06, 6.20400533080101e-06, 4.8638321459293365e-06, 4.875939339399338e-06, 4.601199179887772e-06, 4.907138645648956e-06, 4.688743501901627e-06, 5.932990461587906e-06, 4.732050001621246e-06, 4.623085260391235e-06, 6.977003067731857e-06, 6.348825991153717e-06, 4.824250936508179e-06, 5.704816430807114e-06, 4.990026354789734e-06, 6.387941539287567e-06], tpot=0.0, prompt_len=2048, error='')
Initial test run completed. Starting main benchmark run...
Traffic request rate: 40.0
Burstiness factor: 1.0 (Poisson process)
Maximum request concurrency: None
============ Serving Benchmark Result ============
Successful requests:                     1024      
Benchmark duration (s):                  93.90     
Total input tokens:                      2097152   
Total generated tokens:                  0         
Request throughput (req/s):              10.91     
Output token throughput (tok/s):         0.00      
Total Token throughput (tok/s):          22333.51  
---------------Time to First Token----------------
Mean TTFT (ms):                          17511.77  
Median TTFT (ms):                        0.00      
P99 TTFT (ms):                           93504.96  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          0.00      
Median TPOT (ms):                        0.00      
P99 TPOT (ms):                           0.00      
---------------Inter-token Latency----------------
Mean ITL (ms):                           0.01      
Median ITL (ms):                         0.01      
P99 ITL (ms):                            0.02      
==================================================
